(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[888],{3454:function(a,b,c){"use strict";a.exports=c.g.process||c(7663)},1780:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return c(8510)}])},5819:function(a,b,c){"use strict";c.d(b,{Z:function(){return Isa},a:function(){return Hsa}});var d,e,f,g,h,i,j,k,l,m,n={};c.r(n),c.d(n,{FirebaseError:function(){return I},SDK_VERSION:function(){return vc},"_DEFAULT_ENTRY_NAME":function(){return ec},"_addComponent":function(){return ic},"_addOrOverwriteComponent":function(){return jc},"_apps":function(){return gc},"_clearComponents":function(){return nc},"_components":function(){return hc},"_getProvider":function(){return lc},"_registerComponent":function(){return kc},"_removeServiceInstance":function(){return mc},deleteApp:function(){return zc},getApp:function(){return xc},getApps:function(){return yc},initializeApp:function(){return wc},onLog:function(){return Bc},registerVersion:function(){return Ac},setLogLevel:function(){return Cc}});var o=c(5893),p=c(7294);const q=function(a){const b=[];let c=0;for(let d=0;d<a.length;d++){let e=a.charCodeAt(d);e<128?b[c++]=e:e<2048?(b[c++]=e>>6|192,b[c++]=63&e|128):(64512&e)==55296&&d+1<a.length&&(64512&a.charCodeAt(d+1))==56320?(e=65536+((1023&e)<<10)+(1023&a.charCodeAt(++d)),b[c++]=e>>18|240,b[c++]=e>>12&63|128,b[c++]=e>>6&63|128,b[c++]=63&e|128):(b[c++]=e>>12|224,b[c++]=e>>6&63|128,b[c++]=63&e|128)}return b},r=function(a){const b=[];let c=0,d=0;for(;c<a.length;){const e=a[c++];if(e<128)b[d++]=String.fromCharCode(e);else if(e>191&&e<224){const f=a[c++];b[d++]=String.fromCharCode((31&e)<<6|63&f)}else if(e>239&&e<365){const g=a[c++],h=a[c++],i=a[c++],j=((7&e)<<18|(63&g)<<12|(63&h)<<6|63&i)-65536;b[d++]=String.fromCharCode(55296+(j>>10)),b[d++]=String.fromCharCode(56320+(1023&j))}else{const k=a[c++],l=a[c++];b[d++]=String.fromCharCode((15&e)<<12|(63&k)<<6|63&l)}}return b.join("")},s={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(a,b){if(!Array.isArray(a))throw Error("encodeByteArray takes an array as a parameter");this.init_();const c=b?this.byteToCharMapWebSafe_:this.byteToCharMap_,d=[];for(let e=0;e<a.length;e+=3){const f=a[e],g=e+1<a.length,h=g?a[e+1]:0,i=e+2<a.length,j=i?a[e+2]:0,k=f>>2,l=(3&f)<<4|h>>4;let m=(15&h)<<2|j>>6,n=63&j;i||(n=64,g||(m=64)),d.push(c[k],c[l],c[m],c[n])}return d.join("")},encodeString(a,b){return this.HAS_NATIVE_SUPPORT&&!b?btoa(a):this.encodeByteArray(q(a),b)},decodeString(a,b){return this.HAS_NATIVE_SUPPORT&&!b?atob(a):r(this.decodeStringToByteArray(a,b))},decodeStringToByteArray(a,b){this.init_();const c=b?this.charToByteMapWebSafe_:this.charToByteMap_,d=[];for(let e=0;e<a.length;){const f=c[a.charAt(e++)],g=e<a.length,h=g?c[a.charAt(e)]:0;++e;const i=e<a.length,j=i?c[a.charAt(e)]:64;++e;const k=e<a.length,l=k?c[a.charAt(e)]:64;if(++e,null==f||null==h||null==j||null==l)throw Error();const m=f<<2|h>>4;if(d.push(m),64!==j){const n=h<<4&240|j>>2;if(d.push(n),64!==l){const o=j<<6&192|l;d.push(o)}}}return d},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let a=0;a<this.ENCODED_VALS.length;a++)this.byteToCharMap_[a]=this.ENCODED_VALS.charAt(a),this.charToByteMap_[this.byteToCharMap_[a]]=a,this.byteToCharMapWebSafe_[a]=this.ENCODED_VALS_WEBSAFE.charAt(a),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[a]]=a,a>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(a)]=a,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(a)]=a)}}},t=function(a){const b=q(a);return s.encodeByteArray(b,!0)},u=function(a){return t(a).replace(/\./g,"")},v=function(a){try{return s.decodeString(a,!0)}catch(b){console.error("base64Decode failed: ",b)}return null};function w(a,b){if(!(b instanceof Object))return b;switch(b.constructor){case Date:const c=b;return new Date(c.getTime());case Object:void 0===a&&(a={});break;case Array:a=[];break;default:return b}for(const d in b)b.hasOwnProperty(d)&&x(d)&&(a[d]=w(a[d],b[d]));return a}function x(a){return"__proto__"!==a}class y{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((a,b)=>{this.resolve=a,this.reject=b})}wrapCallback(z){return(a,b)=>{a?this.reject(a):this.resolve(b),"function"==typeof z&&(this.promise.catch(()=>{}),1===z.length?z(a):z(a,b))}}}function A(a,b){if(a.uid)throw new Error("The \"uid\" field is no longer supported by mockUserToken. Please use \"sub\" instead for Firebase Auth User ID.");const c=b||"demo-project",d=a.iat||0,e=a.sub||a.user_id;if(!e)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const f=Object.assign({iss:`https://securetoken.google.com/${c}`,aud:c,iat:d,exp:d+3600,auth_time:d,sub:e,user_id:e,firebase:{sign_in_provider:"custom",identities:{}}},a);return[u(JSON.stringify({alg:"none",type:"JWT"})),u(JSON.stringify(f)),""].join(".")}function B(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function C(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(B())}function D(){try{return"[object process]"===Object.prototype.toString.call(c.g.process)}catch(a){return!1}}function E(){const a="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof a&& void 0!==a.id}function F(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function G(){const a=B();return a.indexOf("MSIE ")>=0||a.indexOf("Trident/")>=0}function H(){return"object"==typeof indexedDB}class I extends Error{constructor(J,K,L){super(K),this.code=J,this.customData=L,this.name="FirebaseError",Object.setPrototypeOf(this,I.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,M.prototype.create)}}class M{constructor(N,O,P){this.service=N,this.serviceName=O,this.errors=P}create(Q,...R){const S=R[0]||{},T=`${this.service}/${Q}`,U=this.errors[Q],V=U?Y(U,S):"Error",W=`${this.serviceName}: ${V} (${T}).`,X=new I(T,W,S);return X}}function Y(a,b){return a.replace(Z,(a,c)=>{const d=b[c];return null!=d?String(d):`<${c}?>`})}const Z=/\{\$([^}]+)}/g;function $(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function _(a,b){if(a===b)return!0;const c=Object.keys(a),d=Object.keys(b);for(const e of c){if(!d.includes(e))return!1;const f=a[e],g=b[e];if(aa(f)&&aa(g)){if(!_(f,g))return!1}else if(f!==g)return!1}for(const h of d)if(!c.includes(h))return!1;return!0}function aa(a){return null!==a&&"object"==typeof a}function ba(a){const b=[];for(const[c,d]of Object.entries(a))Array.isArray(d)?d.forEach(a=>{b.push(encodeURIComponent(c)+"="+encodeURIComponent(a))}):b.push(encodeURIComponent(c)+"="+encodeURIComponent(d));return b.length?"&"+b.join("&"):""}function ca(a){const b={},c=a.replace(/^\?/,"").split("&");return c.forEach(a=>{if(a){const[c,d]=a.split("=");b[decodeURIComponent(c)]=decodeURIComponent(d)}}),b}function da(a){const b=a.indexOf("?");if(!b)return"";const c=a.indexOf("#",b);return a.substring(b,c>0?c:void 0)}function ea(a,b){const c=new fa(a,b);return c.subscribe.bind(c)}class fa{constructor(ga,ha){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=ha,this.task.then(()=>{ga(this)}).catch(a=>{this.error(a)})}next(ia){this.forEachObserver(a=>{a.next(ia)})}error(ja){this.forEachObserver(a=>{a.error(ja)}),this.close(ja)}complete(){this.forEachObserver(a=>{a.complete()}),this.close()}subscribe(ka,la,ma){let na;if(void 0===ka&& void 0===la&& void 0===ma)throw new Error("Missing Observer.");void 0===(na=va(ka,["next","error","complete"])?ka:{next:ka,error:la,complete:ma}).next&&(na.next=wa),void 0===na.error&&(na.error=wa),void 0===na.complete&&(na.complete=wa);const oa=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?na.error(this.finalError):na.complete()}catch(a){}}),this.observers.push(na),oa}unsubscribeOne(pa){void 0!==this.observers&& void 0!==this.observers[pa]&&(delete this.observers[pa],this.observerCount-=1,0===this.observerCount&& void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(qa){if(!this.finalized)for(let ra=0;ra<this.observers.length;ra++)this.sendOne(ra,qa)}sendOne(sa,ta){this.task.then(()=>{if(void 0!==this.observers&& void 0!==this.observers[sa])try{ta(this.observers[sa])}catch(a){"undefined"!=typeof console&&console.error&&console.error(a)}})}close(ua){this.finalized||(this.finalized=!0,void 0!==ua&&(this.finalError=ua),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function va(a,b){if("object"!=typeof a||null===a)return!1;for(const c of b)if(c in a&&"function"==typeof a[c])return!0;return!1}function wa(){}function xa(a){return a&&a._delegate?a._delegate:a}class ya{constructor(za,Aa,Ba){this.name=za,this.instanceFactory=Aa,this.type=Ba,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(Ca){return this.instantiationMode=Ca,this}setMultipleInstances(Da){return this.multipleInstances=Da,this}setServiceProps(Ea){return this.serviceProps=Ea,this}setInstanceCreatedCallback(Fa){return this.onInstanceCreated=Fa,this}}const Ga="[DEFAULT]";class Ha{constructor(Ia,Ja){this.name=Ia,this.container=Ja,this.component=null,this.instances=new Map(),this.instancesDeferred=new Map(),this.instancesOptions=new Map(),this.onInitCallbacks=new Map()}get(Ka){const La=this.normalizeInstanceIdentifier(Ka);if(!this.instancesDeferred.has(La)){const Ma=new y();if(this.instancesDeferred.set(La,Ma),this.isInitialized(La)||this.shouldAutoInitialize())try{const Na=this.getOrInitializeService({instanceIdentifier:La});Na&&Ma.resolve(Na)}catch(Oa){}}return this.instancesDeferred.get(La).promise}getImmediate(Pa){var Qa;const Ra=this.normalizeInstanceIdentifier(null==Pa?void 0:Pa.identifier),Sa=null!==(Qa=null==Pa?void 0:Pa.optional)&& void 0!==Qa&&Qa;if(this.isInitialized(Ra)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:Ra})}catch(Ta){if(Sa)return null;throw Ta}else{if(Sa)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(Ua){if(Ua.name!==this.name)throw Error(`Mismatching Component ${Ua.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=Ua,this.shouldAutoInitialize()){if(Bb(Ua))try{this.getOrInitializeService({instanceIdentifier:Ga})}catch(Va){}for(const[Wa,Xa]of this.instancesDeferred.entries()){const Ya=this.normalizeInstanceIdentifier(Wa);try{const Za=this.getOrInitializeService({instanceIdentifier:Ya});Xa.resolve(Za)}catch($a){}}}}clearInstance(_a=Ga){this.instancesDeferred.delete(_a),this.instancesOptions.delete(_a),this.instances.delete(_a)}async delete(){const ab=Array.from(this.instances.values());await Promise.all([...ab.filter(a=>"INTERNAL"in a).map(a=>a.INTERNAL.delete()),...ab.filter(a=>"_delete"in a).map(a=>a._delete())])}isComponentSet(){return null!=this.component}isInitialized(bb=Ga){return this.instances.has(bb)}getOptions(cb=Ga){return this.instancesOptions.get(cb)||{}}initialize(db={}){const{options:eb={}}=db,fb=this.normalizeInstanceIdentifier(db.instanceIdentifier);if(this.isInitialized(fb))throw Error(`${this.name}(${fb}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const gb=this.getOrInitializeService({instanceIdentifier:fb,options:eb});for(const[hb,ib]of this.instancesDeferred.entries()){const jb=this.normalizeInstanceIdentifier(hb);fb===jb&&ib.resolve(gb)}return gb}onInit(kb,lb){var mb;const nb=this.normalizeInstanceIdentifier(lb),ob=null!==(mb=this.onInitCallbacks.get(nb))&& void 0!==mb?mb:new Set();ob.add(kb),this.onInitCallbacks.set(nb,ob);const pb=this.instances.get(nb);return pb&&kb(pb,nb),()=>{ob.delete(kb)}}invokeOnInitCallbacks(qb,rb){const sb=this.onInitCallbacks.get(rb);if(sb)for(const tb of sb)try{tb(qb,rb)}catch(ub){}}getOrInitializeService({instanceIdentifier:vb,options:wb={}}){let xb=this.instances.get(vb);if(!xb&&this.component&&(xb=this.component.instanceFactory(this.container,{instanceIdentifier:Ab(vb),options:wb}),this.instances.set(vb,xb),this.instancesOptions.set(vb,wb),this.invokeOnInitCallbacks(xb,vb),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,vb,xb)}catch(yb){}return xb||null}normalizeInstanceIdentifier(zb=Ga){return this.component?this.component.multipleInstances?zb:Ga:zb}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}function Ab(a){return a===Ga?void 0:a}function Bb(a){return"EAGER"===a.instantiationMode}class Cb{constructor(Db){this.name=Db,this.providers=new Map()}addComponent(Eb){const Fb=this.getProvider(Eb.name);if(Fb.isComponentSet())throw new Error(`Component ${Eb.name} has already been registered with ${this.name}`);Fb.setComponent(Eb)}addOrOverwriteComponent(Gb){const Hb=this.getProvider(Gb.name);Hb.isComponentSet()&&this.providers.delete(Gb.name),this.addComponent(Gb)}getProvider(Ib){if(this.providers.has(Ib))return this.providers.get(Ib);const Jb=new Ha(Ib,this);return this.providers.set(Ib,Jb),Jb}getProviders(){return Array.from(this.providers.values())}}const Kb=[];(lw=ow||(ow={}))[lw.DEBUG=0]="DEBUG",lw[lw.VERBOSE=1]="VERBOSE",lw[lw.INFO=2]="INFO",lw[lw.WARN=3]="WARN",lw[lw.ERROR=4]="ERROR",lw[lw.SILENT=5]="SILENT";const Lb={debug:ow.DEBUG,verbose:ow.VERBOSE,info:ow.INFO,warn:ow.WARN,error:ow.ERROR,silent:ow.SILENT},Mb=ow.INFO,Nb={[ow.DEBUG]:"log",[ow.VERBOSE]:"log",[ow.INFO]:"info",[ow.WARN]:"warn",[ow.ERROR]:"error"};class Ob{constructor(Pb){this.name=Pb,this._logLevel=Mb,this._logHandler=(a,b,...c)=>{if(!(b<a.logLevel)){const d=new Date().toISOString(),e=Nb[b];if(e)console[e](`[${d}]  ${a.name}:`,...c);else throw new Error(`Attempted to log a message with an invalid logType (value: ${b})`)}},this._userLogHandler=null,Kb.push(this)}get logLevel(){return this._logLevel}set logLevel(Qb){if(!(Qb in ow))throw new TypeError(`Invalid value "${Qb}" assigned to \`logLevel\``);this._logLevel=Qb}setLogLevel(Rb){this._logLevel="string"==typeof Rb?Lb[Rb]:Rb}get logHandler(){return this._logHandler}set logHandler(Sb){if("function"!=typeof Sb)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=Sb}get userLogHandler(){return this._userLogHandler}set userLogHandler(Tb){this._userLogHandler=Tb}debug(...Ub){this._userLogHandler&&this._userLogHandler(this,ow.DEBUG,...Ub),this._logHandler(this,ow.DEBUG,...Ub)}log(...Vb){this._userLogHandler&&this._userLogHandler(this,ow.VERBOSE,...Vb),this._logHandler(this,ow.VERBOSE,...Vb)}info(...Wb){this._userLogHandler&&this._userLogHandler(this,ow.INFO,...Wb),this._logHandler(this,ow.INFO,...Wb)}warn(...Xb){this._userLogHandler&&this._userLogHandler(this,ow.WARN,...Xb),this._logHandler(this,ow.WARN,...Xb)}error(...Yb){this._userLogHandler&&this._userLogHandler(this,ow.ERROR,...Yb),this._logHandler(this,ow.ERROR,...Yb)}}class Zb{constructor($b){this.container=$b}getPlatformInfoString(){const _b=this.container.getProviders();return _b.map(a=>{if(!ac(a))return null;{const b=a.getImmediate();return`${b.library}/${b.version}`}}).filter(a=>a).join(" ")}}function ac(a){const b=a.getComponent();return(null==b?void 0:b.type)==="VERSION"}const bc="@firebase/app",cc="0.7.14",dc=new Ob("@firebase/app"),ec="[DEFAULT]",fc={[bc]:"fire-core",["@firebase/app-compat"]:"fire-core-compat",["@firebase/analytics"]:"fire-analytics",["@firebase/analytics-compat"]:"fire-analytics-compat",["@firebase/app-check"]:"fire-app-check",["@firebase/app-check-compat"]:"fire-app-check-compat",["@firebase/auth"]:"fire-auth",["@firebase/auth-compat"]:"fire-auth-compat",["@firebase/database"]:"fire-rtdb",["@firebase/database-compat"]:"fire-rtdb-compat",["@firebase/functions"]:"fire-fn",["@firebase/functions-compat"]:"fire-fn-compat",["@firebase/installations"]:"fire-iid",["@firebase/installations-compat"]:"fire-iid-compat",["@firebase/messaging"]:"fire-fcm",["@firebase/messaging-compat"]:"fire-fcm-compat",["@firebase/performance"]:"fire-perf",["@firebase/performance-compat"]:"fire-perf-compat",["@firebase/remote-config"]:"fire-rc",["@firebase/remote-config-compat"]:"fire-rc-compat",["@firebase/storage"]:"fire-gcs",["@firebase/storage-compat"]:"fire-gcs-compat",["@firebase/firestore"]:"fire-fst",["@firebase/firestore-compat"]:"fire-fst-compat","fire-js":"fire-js",["firebase"]:"fire-js-all"},gc=new Map(),hc=new Map();function ic(a,b){try{a.container.addComponent(b)}catch(c){dc.debug(`Component ${b.name} failed to register with FirebaseApp ${a.name}`,c)}}function jc(a,b){a.container.addOrOverwriteComponent(b)}function kc(a){const b=a.name;if(hc.has(b))return dc.debug(`There were multiple attempts to register component ${b}.`),!1;for(const c of(hc.set(b,a),gc.values()))ic(c,a);return!0}function lc(a,b){return a.container.getProvider(b)}function mc(a,b,c=ec){lc(a,b).clearInstance(c)}function nc(){hc.clear()}const oc=new M("app","Firebase",{["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function."});class pc{constructor(qc,rc,sc){this._isDeleted=!1,this._options=Object.assign({},qc),this._config=Object.assign({},rc),this._name=rc.name,this._automaticDataCollectionEnabled=rc.automaticDataCollectionEnabled,this._container=sc,this.container.addComponent(new ya("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(tc){this.checkDestroyed(),this._automaticDataCollectionEnabled=tc}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(uc){this._isDeleted=uc}checkDestroyed(){if(this.isDeleted)throw oc.create("app-deleted",{appName:this._name})}}const vc="9.6.4";function wc(a,b={}){if("object"!=typeof b){const c=b;b={name:c}}const d=Object.assign({name:ec,automaticDataCollectionEnabled:!1},b),e=d.name;if("string"!=typeof e||!e)throw oc.create("bad-app-name",{appName:String(e)});const f=gc.get(e);if(f){if(_(a,f.options)&&_(d,f.config))return f;throw oc.create("duplicate-app",{appName:e})}const g=new Cb(e);for(const h of hc.values())g.addComponent(h);const i=new pc(a,d,g);return gc.set(e,i),i}function xc(a=ec){const b=gc.get(a);if(!b)throw oc.create("no-app",{appName:a});return b}function yc(){return Array.from(gc.values())}async function zc(a){const b=a.name;gc.has(b)&&(gc.delete(b),await Promise.all(a.container.getProviders().map(a=>a.delete())),a.isDeleted=!0)}function Ac(a,b,c){var d;let e=null!==(d=fc[a])&& void 0!==d?d:a;c&&(e+=`-${c}`);const f=e.match(/\s|\//),g=b.match(/\s|\//);if(f||g){const h=[`Unable to register library "${e}" with version "${b}":`];f&&h.push(`library name "${e}" contains illegal characters (whitespace or "/")`),f&&g&&h.push("and"),g&&h.push(`version name "${b}" contains illegal characters (whitespace or "/")`),dc.warn(h.join(" "));return}kc(new ya(`${e}-version`,()=>({library:e,version:b}),"VERSION"))}function Bc(a,b){if(null!==a&&"function"!=typeof a)throw oc.create("invalid-log-argument");!function(a,b){for(const c of Kb){let d=null;b&&b.level&&(d=Lb[b.level]),null===a?c.userLogHandler=null:c.userLogHandler=(b,c,...e)=>{const f=e.map(a=>{if(null==a)return null;if("string"==typeof a)return a;if("number"==typeof a||"boolean"==typeof a)return a.toString();if(a instanceof Error)return a.message;try{return JSON.stringify(a)}catch(b){return null}}).filter(a=>a).join(" ");c>=(null!=d?d:b.logLevel)&&a({level:ow[c].toLowerCase(),message:f,args:e,type:b.name})}}}(a,b)}function Cc(a){var b;b=a,Kb.forEach(a=>{a.setLogLevel(b)})}kc(new ya("platform-logger",a=>new Zb(a),"PRIVATE")),Ac(bc,cc,""),Ac(bc,cc,"esm2017"),Ac("fire-js","");class Dc{constructor(Ec,Fc){this._delegate=Ec,this.firebase=Fc,ic(Ec,new ya("app-compat",()=>this,"PUBLIC")),this.container=Ec.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(Gc){this._delegate.automaticDataCollectionEnabled=Gc}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(a=>{this._delegate.checkDestroyed(),a()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),zc(this._delegate)))}_getService(Hc,Ic=ec){var Jc;this._delegate.checkDestroyed();const Kc=this._delegate.container.getProvider(Hc);return Kc.isInitialized()||(null===(Jc=Kc.getComponent())|| void 0===Jc?void 0:Jc.instantiationMode)!=="EXPLICIT"||Kc.initialize(),Kc.getImmediate({identifier:Ic})}_removeServiceInstance(Lc,Mc=ec){this._delegate.container.getProvider(Lc).clearInstance(Mc)}_addComponent(Nc){ic(this._delegate,Nc)}_addOrOverwriteComponent(Oc){jc(this._delegate,Oc)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const Pc=new M("app-compat","Firebase",{["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance."});function Qc(){const a=function(a){const b={},c={__esModule:!0,initializeApp:function(d,e={}){const f=wc(d,e);if($(b,f.name))return b[f.name];const g=new a(f,c);return b[f.name]=g,g},app:d,registerVersion:Ac,setLogLevel:Cc,onLog:Bc,apps:null,SDK_VERSION:vc,INTERNAL:{registerComponent:function(b){const e=b.name,f=e.replace("-compat","");if(kc(b)&&"PUBLIC"===b.type){const g=(a=d())=>{if("function"!=typeof a[f])throw Pc.create("invalid-app-argument",{appName:e});return a[f]()};void 0!==b.serviceProps&&w(g,b.serviceProps),c[f]=g,a.prototype[f]=function(...a){const c=this._getService.bind(this,e);return c.apply(this,b.multipleInstances?a:[])}}return"PUBLIC"===b.type?c[f]:null},removeApp:function(a){delete b[a]},useAsService:function(a,b){return"serverAuth"===b?null:b},modularAPIs:n}};function d(a){if(!$(b,a=a||ec))throw Pc.create("no-app",{appName:a});return b[a]}return c.default=c,Object.defineProperty(c,"apps",{get:function(){return Object.keys(b).map(a=>b[a])}}),d.App=a,c}(Dc);return a.INTERNAL=Object.assign(Object.assign({},a.INTERNAL),{createFirebaseNamespace:Qc,extendNamespace:function(b){w(a,b)},createSubscribe:ea,ErrorFactory:M,deepExtend:w}),a}const Rc=Qc(),Sc=new Ob("@firebase/app-compat");if("object"==typeof self&&self.self===self&& void 0!==self.firebase){Sc.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const Tc=self.firebase.SDK_VERSION;Tc&&Tc.indexOf("LITE")>=0&&Sc.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const Uc=Rc;Ac("@firebase/app-compat","0.1.15",void 0),Uc.registerVersion("firebase","9.6.4","app-compat");var Vc=function(a,b){return(Vc=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])})(a,b)},Wc=function(){return(Wc=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)};function Xc(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&0>b.indexOf(d)&&(c[d]=a[d]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)0>b.indexOf(d[e])&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c}function Yc(a){return this instanceof Yc?(this.v=a,this):new Yc(a)}function Zc(){return{["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const $c=Zc,_c=new M("auth","Firebase",Zc()),ad=new Ob("@firebase/auth");function bd(a,...b){ad.logLevel<=ow.ERROR&&ad.error(`Auth (${vc}): ${a}`,...b)}function cd(a,...b){throw gd(a,...b)}function dd(a,...b){return gd(a,...b)}function ed(a,b,c){const d=Object.assign(Object.assign({},$c()),{[b]:c}),e=new M("auth","Firebase",d);return e.create(b,{appName:a.name})}function fd(a,b,c){const d=c;if(!(b instanceof d))throw d.name!==b.constructor.name&&cd(a,"argument-error"),ed(a,"argument-error",`Type of ${b.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function gd(a,...b){if("string"!=typeof a){const c=b[0],d=[...b.slice(1)];return d[0]&&(d[0].appName=a.name),a._errorFactory.create(c,...d)}return _c.create(a,...b)}function hd(a,b,...c){if(!a)throw gd(b,...c)}function id(a){const b="INTERNAL ASSERTION FAILED: "+a;throw bd(b),new Error(b)}function jd(a,b){a||id(b)}const kd=new Map();function ld(a){jd(a instanceof Function,"Expected a class definition");let b=kd.get(a);return b?(jd(b instanceof a,"Instance stored in cache mismatched with class"),b):(b=new a(),kd.set(a,b),b)}function md(){var a;return"undefined"!=typeof self&&(null===(a=self.location)|| void 0===a?void 0:a.href)||""}function nd(){return"http:"===od()||"https:"===od()}function od(){var a;return"undefined"!=typeof self&&(null===(a=self.location)|| void 0===a?void 0:a.protocol)||null}class pd{constructor(qd,rd){this.shortDelay=qd,this.longDelay=rd,jd(rd>qd,"Short delay should be less than long delay!"),this.isMobile=C()||F()}get(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(nd()||E()||"connection"in navigator))||navigator.onLine?this.isMobile?this.longDelay:this.shortDelay:Math.min(5000,this.shortDelay)}}function sd(a,b){jd(a.emulator,"Emulator should always be set here");const{url:c}=a.emulator;return b?`${c}${b.startsWith("/")?b.slice(1):b}`:c}class td{static initialize(ud,vd,wd){this.fetchImpl=ud,vd&&(this.headersImpl=vd),wd&&(this.responseImpl=wd)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void id("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void id("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void id("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const xd={["CREDENTIAL_MISMATCH"]:"custom-token-mismatch",["MISSING_CUSTOM_TOKEN"]:"internal-error",["INVALID_IDENTIFIER"]:"invalid-email",["MISSING_CONTINUE_URI"]:"internal-error",["INVALID_PASSWORD"]:"wrong-password",["MISSING_PASSWORD"]:"internal-error",["EMAIL_EXISTS"]:"email-already-in-use",["PASSWORD_LOGIN_DISABLED"]:"operation-not-allowed",["INVALID_IDP_RESPONSE"]:"invalid-credential",["INVALID_PENDING_TOKEN"]:"invalid-credential",["FEDERATED_USER_ID_ALREADY_LINKED"]:"credential-already-in-use",["MISSING_REQ_TYPE"]:"internal-error",["EMAIL_NOT_FOUND"]:"user-not-found",["RESET_PASSWORD_EXCEED_LIMIT"]:"too-many-requests",["EXPIRED_OOB_CODE"]:"expired-action-code",["INVALID_OOB_CODE"]:"invalid-action-code",["MISSING_OOB_CODE"]:"internal-error",["CREDENTIAL_TOO_OLD_LOGIN_AGAIN"]:"requires-recent-login",["INVALID_ID_TOKEN"]:"invalid-user-token",["TOKEN_EXPIRED"]:"user-token-expired",["USER_NOT_FOUND"]:"user-token-expired",["TOO_MANY_ATTEMPTS_TRY_LATER"]:"too-many-requests",["INVALID_CODE"]:"invalid-verification-code",["INVALID_SESSION_INFO"]:"invalid-verification-id",["INVALID_TEMPORARY_PROOF"]:"invalid-credential",["MISSING_SESSION_INFO"]:"missing-verification-id",["SESSION_EXPIRED"]:"code-expired",["MISSING_ANDROID_PACKAGE_NAME"]:"missing-android-pkg-name",["UNAUTHORIZED_DOMAIN"]:"unauthorized-continue-uri",["INVALID_OAUTH_CLIENT_ID"]:"invalid-oauth-client-id",["ADMIN_ONLY_OPERATION"]:"admin-restricted-operation",["INVALID_MFA_PENDING_CREDENTIAL"]:"invalid-multi-factor-session",["MFA_ENROLLMENT_NOT_FOUND"]:"multi-factor-info-not-found",["MISSING_MFA_ENROLLMENT_ID"]:"missing-multi-factor-info",["MISSING_MFA_PENDING_CREDENTIAL"]:"missing-multi-factor-session",["SECOND_FACTOR_EXISTS"]:"second-factor-already-in-use",["SECOND_FACTOR_LIMIT_EXCEEDED"]:"maximum-second-factor-count-exceeded",["BLOCKING_FUNCTION_ERROR_RESPONSE"]:"internal-error"},yd=new pd(30e3,60e3);function zd(a,b){return a.tenantId&&!b.tenantId?Object.assign(Object.assign({},b),{tenantId:a.tenantId}):b}async function Ad(a,b,c,d,e={}){return Bd(a,e,async()=>{let e={},f={};d&&("GET"===b?f=d:e={body:JSON.stringify(d)});const g=ba(Object.assign({key:a.config.apiKey},f)).slice(1),h=await a._getAdditionalHeaders();return h["Content-Type"]="application/json",a.languageCode&&(h["X-Firebase-Locale"]=a.languageCode),td.fetch()(Dd(a,a.config.apiHost,c,g),Object.assign({method:b,headers:h,referrerPolicy:"no-referrer"},e))})}async function Bd(a,b,c){a._canInitEmulator=!1;const d=Object.assign(Object.assign({},xd),b);try{const e=new Ed(a),f=await Promise.race([c(),e.promise]);e.clearNetworkTimeout();const g=await f.json();if("needConfirmation"in g)throw Gd(a,"account-exists-with-different-credential",g);if(f.ok&&!("errorMessage"in g))return g;{const h=f.ok?g.errorMessage:g.error.message,[i,j]=h.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===i)throw Gd(a,"credential-already-in-use",g);if("EMAIL_EXISTS"===i)throw Gd(a,"email-already-in-use",g);const k=d[i]||i.toLowerCase().replace(/[_\s]+/g,"-");if(j)throw ed(a,k,j);cd(a,k)}}catch(l){if(l instanceof I)throw l;cd(a,"network-request-failed")}}async function Cd(a,b,c,d,e={}){const f=await Ad(a,b,c,d,e);return"mfaPendingCredential"in f&&cd(a,"multi-factor-auth-required",{_serverResponse:f}),f}function Dd(a,b,c,d){const e=`${b}${c}?${d}`;return a.config.emulator?sd(a.config,e):`${a.config.apiScheme}://${e}`}class Ed{constructor(Fd){this.auth=Fd,this.timer=null,this.promise=new Promise((a,b)=>{this.timer=setTimeout(()=>b(dd(this.auth,"network-request-failed")),yd.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Gd(a,b,c){const d={appName:a.name};c.email&&(d.email=c.email),c.phoneNumber&&(d.phoneNumber=c.phoneNumber);const e=dd(a,b,d);return e.customData._tokenResponse=c,e}async function Hd(a,b){return Ad(a,"POST","/v1/accounts:delete",b)}async function Id(a,b){return Ad(a,"POST","/v1/accounts:update",b)}async function Jd(a,b){return Ad(a,"POST","/v1/accounts:lookup",b)}function Kd(a){if(a)try{const b=new Date(Number(a));if(!isNaN(b.getTime()))return b.toUTCString()}catch(c){}}async function Ld(a,b=!1){const c=xa(a),d=await c.getIdToken(b),e=Nd(d);hd(e&&e.exp&&e.auth_time&&e.iat,c.auth,"internal-error");const f="object"==typeof e.firebase?e.firebase:void 0,g=null==f?void 0:f.sign_in_provider;return{claims:e,token:d,authTime:Kd(Md(e.auth_time)),issuedAtTime:Kd(Md(e.iat)),expirationTime:Kd(Md(e.exp)),signInProvider:g||null,signInSecondFactor:(null==f?void 0:f.sign_in_second_factor)||null}}function Md(a){return 1000*Number(a)}function Nd(a){const[b,c,d]=a.split(".");if(void 0===b|| void 0===c|| void 0===d)return bd("JWT malformed, contained fewer than 3 sections"),null;try{const e=v(c);if(!e)return bd("Failed to decode base64 JWT payload"),null;return JSON.parse(e)}catch(f){return bd("Caught error parsing JWT payload as JSON",f),null}}async function Od(a,b,c=!1){if(c)return b;try{return await b}catch(d){throw d instanceof I&&Pd(d)&&a.auth.currentUser===a&&await a.auth.signOut(),d}}function Pd({code:a}){return"auth/user-disabled"===a||"auth/user-token-expired"===a}class Qd{constructor(Rd,Sd){this.createdAt=Rd,this.lastLoginAt=Sd,this._initializeTime()}_initializeTime(){this.lastSignInTime=Kd(this.lastLoginAt),this.creationTime=Kd(this.createdAt)}_copy(Td){this.createdAt=Td.createdAt,this.lastLoginAt=Td.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Ud(a){var b;const c=a.auth,d=await a.getIdToken(),e=await Od(a,Jd(c,{idToken:d}));hd(null==e?void 0:e.users.length,c,"internal-error");const f=e.users[0];a._notifyReloadListener(f);const g=(null===(b=f.providerUserInfo)|| void 0===b?void 0:b.length)?Xd(f.providerUserInfo):[],h=Wd(a.providerData,g),i=a.isAnonymous,j=!(a.email&&f.passwordHash)&&!(null==h?void 0:h.length),k={uid:f.localId,displayName:f.displayName||null,photoURL:f.photoUrl||null,email:f.email||null,emailVerified:f.emailVerified||!1,phoneNumber:f.phoneNumber||null,tenantId:f.tenantId||null,providerData:h,metadata:new Qd(f.createdAt,f.lastLoginAt),isAnonymous:!!i&&j};Object.assign(a,k)}async function Vd(a){const b=xa(a);await Ud(b),await b.auth._persistUserIfCurrent(b),b.auth._notifyListenersIfCurrent(b)}function Wd(a,b){const c=a.filter(a=>!b.some(b=>b.providerId===a.providerId));return[...c,...b]}function Xd(a){return a.map(a=>{var{providerId:b}=a,c=Xc(a,["providerId"]);return{providerId:b,uid:c.rawId||"",displayName:c.displayName||null,email:c.email||null,phoneNumber:c.phoneNumber||null,photoURL:c.photoUrl||null}})}async function Yd(a,b){const c=await Bd(a,{},async()=>{const c=ba({grant_type:"refresh_token",refresh_token:b}).slice(1),{tokenApiHost:d,apiKey:e}=a.config,f=Dd(a,d,"/v1/token",`key=${e}`),g=await a._getAdditionalHeaders();return g["Content-Type"]="application/x-www-form-urlencoded",td.fetch()(f,{method:"POST",headers:g,body:c})});return{accessToken:c.access_token,expiresIn:c.expires_in,refreshToken:c.refresh_token}}class Zd{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-30e3}updateFromServerResponse($d){hd($d.idToken,"internal-error"),hd(void 0!==$d.idToken,"internal-error"),hd(void 0!==$d.refreshToken,"internal-error");const _d="expiresIn"in $d&& void 0!==$d.expiresIn?Number($d.expiresIn):function(a){const b=Nd(a);return hd(b,"internal-error"),hd(void 0!==b.exp,"internal-error"),hd(void 0!==b.iat,"internal-error"),Number(b.exp)-Number(b.iat)}($d.idToken);this.updateTokensAndExpiration($d.idToken,$d.refreshToken,_d)}async getToken(ae,be=!1){return(hd(!this.accessToken||this.refreshToken,ae,"user-token-expired"),be||!this.accessToken||this.isExpired)?this.refreshToken?(await this.refresh(ae,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(ce,de){const{accessToken:ee,refreshToken:fe,expiresIn:ge}=await Yd(ce,de);this.updateTokensAndExpiration(ee,fe,Number(ge))}updateTokensAndExpiration(he,ie,je){this.refreshToken=ie||null,this.accessToken=he||null,this.expirationTime=Date.now()+1000*je}static fromJSON(ke,le){const{refreshToken:me,accessToken:ne,expirationTime:oe}=le,pe=new Zd();return me&&(hd("string"==typeof me,"internal-error",{appName:ke}),pe.refreshToken=me),ne&&(hd("string"==typeof ne,"internal-error",{appName:ke}),pe.accessToken=ne),oe&&(hd("number"==typeof oe,"internal-error",{appName:ke}),pe.expirationTime=oe),pe}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(qe){this.accessToken=qe.accessToken,this.refreshToken=qe.refreshToken,this.expirationTime=qe.expirationTime}_clone(){return Object.assign(new Zd(),this.toJSON())}_performRefresh(){return id("not implemented")}}function re(a,b){hd("string"==typeof a|| void 0===a,"internal-error",{appName:b})}class se{constructor(te){var{uid:ue,auth:ve,stsTokenManager:we}=te,xe=Xc(te,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.emailVerified=!1,this.isAnonymous=!1,this.tenantId=null,this.providerData=[],this.proactiveRefresh=new class{constructor(ye){this.user=ye,this.isRunning=!1,this.timerId=null,this.errorBackoff=30e3}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(ze){var Ae;if(ze){const Be=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,960e3),Be}{this.errorBackoff=30e3;const Ce=null!==(Ae=this.user.stsTokenManager.expirationTime)&& void 0!==Ae?Ae:0,De=Ce-Date.now()-30e4;return Math.max(0,De)}}schedule(Ee=!1){if(this.isRunning){const Fe=this.getInterval(Ee);this.timerId=setTimeout(async()=>{await this.iteration()},Fe)}}async iteration(){try{await this.user.getIdToken(!0)}catch(Ge){"auth/network-request-failed"===Ge.code&&this.schedule(!0);return}this.schedule()}}(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=ue,this.auth=ve,this.stsTokenManager=we,this.accessToken=we.accessToken,this.displayName=xe.displayName||null,this.email=xe.email||null,this.emailVerified=xe.emailVerified||!1,this.phoneNumber=xe.phoneNumber||null,this.photoURL=xe.photoURL||null,this.isAnonymous=xe.isAnonymous||!1,this.tenantId=xe.tenantId||null,this.metadata=new Qd(xe.createdAt||void 0,xe.lastLoginAt||void 0)}async getIdToken(He){const Ie=await Od(this,this.stsTokenManager.getToken(this.auth,He));return hd(Ie,this.auth,"internal-error"),this.accessToken!==Ie&&(this.accessToken=Ie,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),Ie}getIdTokenResult(Je){return Ld(this,Je)}reload(){return Vd(this)}_assign(Ke){this!==Ke&&(hd(this.uid===Ke.uid,this.auth,"internal-error"),this.displayName=Ke.displayName,this.photoURL=Ke.photoURL,this.email=Ke.email,this.emailVerified=Ke.emailVerified,this.phoneNumber=Ke.phoneNumber,this.isAnonymous=Ke.isAnonymous,this.tenantId=Ke.tenantId,this.providerData=Ke.providerData.map(a=>Object.assign({},a)),this.metadata._copy(Ke.metadata),this.stsTokenManager._assign(Ke.stsTokenManager))}_clone(Le){return new se(Object.assign(Object.assign({},this),{auth:Le,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(Me){hd(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=Me,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(Ne){this.reloadListener?this.reloadListener(Ne):this.reloadUserInfo=Ne}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(Oe,Pe=!1){let Qe=!1;Oe.idToken&&Oe.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(Oe),Qe=!0),Pe&&await Ud(this),await this.auth._persistUserIfCurrent(this),Qe&&this.auth._notifyListenersIfCurrent(this)}async delete(){const Re=await this.getIdToken();return await Od(this,Hd(this.auth,{idToken:Re})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(a=>Object.assign({},a)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(Se,Te){var Ue,Ve,We,Xe,Ye,Ze,$e,_e;const af=null!==(Ue=Te.displayName)&& void 0!==Ue?Ue:void 0,bf=null!==(Ve=Te.email)&& void 0!==Ve?Ve:void 0,cf=null!==(We=Te.phoneNumber)&& void 0!==We?We:void 0,df=null!==(Xe=Te.photoURL)&& void 0!==Xe?Xe:void 0,ef=null!==(Ye=Te.tenantId)&& void 0!==Ye?Ye:void 0,ff=null!==(Ze=Te._redirectEventId)&& void 0!==Ze?Ze:void 0,gf=null!==($e=Te.createdAt)&& void 0!==$e?$e:void 0,hf=null!==(_e=Te.lastLoginAt)&& void 0!==_e?_e:void 0,{uid:jf,emailVerified:kf,isAnonymous:lf,providerData:mf,stsTokenManager:nf}=Te;hd(jf&&nf,Se,"internal-error");const of=Zd.fromJSON(this.name,nf);hd("string"==typeof jf,Se,"internal-error"),re(af,Se.name),re(bf,Se.name),hd("boolean"==typeof kf,Se,"internal-error"),hd("boolean"==typeof lf,Se,"internal-error"),re(cf,Se.name),re(df,Se.name),re(ef,Se.name),re(ff,Se.name),re(gf,Se.name),re(hf,Se.name);const pf=new se({uid:jf,auth:Se,email:bf,emailVerified:kf,displayName:af,isAnonymous:lf,photoURL:df,phoneNumber:cf,tenantId:ef,stsTokenManager:of,createdAt:gf,lastLoginAt:hf});return mf&&Array.isArray(mf)&&(pf.providerData=mf.map(a=>Object.assign({},a))),ff&&(pf._redirectEventId=ff),pf}static async _fromIdTokenResponse(qf,rf,sf=!1){const tf=new Zd();tf.updateFromServerResponse(rf);const uf=new se({uid:rf.localId,auth:qf,stsTokenManager:tf,isAnonymous:sf});return await Ud(uf),uf}}class vf{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(wf,xf){this.storage[wf]=xf}async _get(yf){const zf=this.storage[yf];return void 0===zf?null:zf}async _remove(Af){delete this.storage[Af]}_addListener(Bf,Cf){}_removeListener(Df,Ef){}}vf.type="NONE";const Ff=vf;function Gf(a,b,c){return`firebase:${a}:${b}:${c}`}class Hf{constructor(If,Jf,Kf){this.persistence=If,this.auth=Jf,this.userKey=Kf;const{config:Lf,name:Mf}=this.auth;this.fullUserKey=Gf(this.userKey,Lf.apiKey,Mf),this.fullPersistenceKey=Gf("persistence",Lf.apiKey,Mf),this.boundEventHandler=Jf._onStorageEvent.bind(Jf),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(Nf){return this.persistence._set(this.fullUserKey,Nf.toJSON())}async getCurrentUser(){const Of=await this.persistence._get(this.fullUserKey);return Of?se._fromJSON(this.auth,Of):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(Pf){if(this.persistence!==Pf){const Qf=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=Pf,Qf)return this.setCurrentUser(Qf)}}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(Rf,Sf,Tf="authUser"){if(!Sf.length)return new Hf(ld(Ff),Rf,Tf);const Uf=(await Promise.all(Sf.map(async a=>{if(await a._isAvailable())return a}))).filter(a=>a);let Vf=Uf[0]||ld(Ff);const Wf=Gf(Tf,Rf.config.apiKey,Rf.name);let Xf=null;for(const Yf of Sf)try{const Zf=await Yf._get(Wf);if(Zf){const $f=se._fromJSON(Rf,Zf);Yf!==Vf&&(Xf=$f),Vf=Yf;break}}catch(_f){}const ag=Uf.filter(a=>a._shouldAllowMigration);return Vf._shouldAllowMigration&&ag.length&&(Vf=ag[0],Xf&&await Vf._set(Wf,Xf.toJSON()),await Promise.all(Sf.map(async a=>{if(a!==Vf)try{await a._remove(Wf)}catch(b){}}))),new Hf(Vf,Rf,Tf)}}function bg(a){const b=a.toLowerCase();if(b.includes("opera/")||b.includes("opr/")||b.includes("opios/"))return"Opera";{if(fg(b))return"IEMobile";if(b.includes("msie")||b.includes("trident/"))return"IE";if(b.includes("edge/"))return"Edge";if(cg(b))return"Firefox";if(b.includes("silk/"))return"Silk";if(hg(b))return"Blackberry";if(ig(b))return"Webos";if(dg(b))return"Safari";if((b.includes("chrome/")||eg(b))&&!b.includes("edge/"))return"Chrome";if(gg(b))return"Android";const c=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,d=a.match(c);if((null==d?void 0:d.length)===2)return d[1]}return"Other"}function cg(a=B()){return/firefox\//i.test(a)}function dg(a=B()){const b=a.toLowerCase();return b.includes("safari/")&&!b.includes("chrome/")&&!b.includes("crios/")&&!b.includes("android")}function eg(a=B()){return/crios\//i.test(a)}function fg(a=B()){return/iemobile/i.test(a)}function gg(a=B()){return/android/i.test(a)}function hg(a=B()){return/blackberry/i.test(a)}function ig(a=B()){return/webos/i.test(a)}function jg(a=B()){return/iphone|ipad|ipod/i.test(a)}function kg(a=B()){return jg(a)||gg(a)||ig(a)||hg(a)||/windows phone/i.test(a)||fg(a)}function lg(a,b=[]){let c;switch(a){case"Browser":c=bg(B());break;case"Worker":c=`${bg(B())}-${a}`;break;default:c=a}const d=b.length?b.join(","):"FirebaseCore-web";return`${c}/JsCore/${vc}/${d}`}class mg{constructor(ng,og){this.app=ng,this.config=og,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new lh(this),this.idTokenSubscription=new lh(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=_c,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=ng.name,this.clientVersion=og.sdkClientVersion}_initializeWithPersistence(pg,qg){return qg&&(this._popupRedirectResolver=ld(qg)),this._initializationPromise=this.queue(async()=>{var a,b;if(!this._deleted&&(this.persistenceManager=await Hf.create(this,pg),!this._deleted)){if(null===(a=this._popupRedirectResolver)|| void 0===a?void 0:a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(c){}await this.initializeCurrentUser(qg),this.lastNotifiedUid=(null===(b=this.currentUser)|| void 0===b?void 0:b.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(!this._deleted){const rg=await this.assertedPersistence.getCurrentUser();if(this.currentUser||rg){if(this.currentUser&&rg&&this.currentUser.uid===rg.uid){this._currentUser._assign(rg),await this.currentUser.getIdToken();return}await this._updateCurrentUser(rg)}}}async initializeCurrentUser(sg){var tg;let ug=await this.assertedPersistence.getCurrentUser();if(sg&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const vg=null===(tg=this.redirectUser)|| void 0===tg?void 0:tg._redirectEventId,wg=null==ug?void 0:ug._redirectEventId,xg=await this.tryRedirectSignIn(sg);(!vg||vg===wg)&&(null==xg?void 0:xg.user)&&(ug=xg.user)}return ug?ug._redirectEventId&&(hd(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===ug._redirectEventId)?this.directlySetCurrentUser(ug):this.reloadAndSetCurrentUserOrClear(ug):this.directlySetCurrentUser(null)}async tryRedirectSignIn(yg){let zg=null;try{zg=await this._popupRedirectResolver._completeRedirectFn(this,yg,!0)}catch(Ag){await this._setRedirectUser(null)}return zg}async reloadAndSetCurrentUserOrClear(Bg){try{await Ud(Bg)}catch(Cg){if("auth/network-request-failed"!==Cg.code)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(Bg)}useDeviceLanguage(){this.languageCode=(function(){if("undefined"==typeof navigator)return null;const a=navigator;return a.languages&&a.languages[0]||a.language||null})()}async _delete(){this._deleted=!0}async updateCurrentUser(Dg){const Eg=Dg?xa(Dg):null;return Eg&&hd(Eg.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(Eg&&Eg._clone(this))}async _updateCurrentUser(Fg){if(!this._deleted)return Fg&&hd(this.tenantId===Fg.tenantId,this,"tenant-id-mismatch"),this.queue(async()=>{await this.directlySetCurrentUser(Fg),this.notifyAuthListeners()})}async signOut(){return(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null)}setPersistence(Gg){return this.queue(async()=>{await this.assertedPersistence.setPersistence(ld(Gg))})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(Hg){this._errorFactory=new M("auth","Firebase",Hg())}onAuthStateChanged(Ig,Jg,Kg){return this.registerStateListener(this.authStateSubscription,Ig,Jg,Kg)}onIdTokenChanged(Lg,Mg,Ng){return this.registerStateListener(this.idTokenSubscription,Lg,Mg,Ng)}toJSON(){var Og;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(Og=this._currentUser)|| void 0===Og?void 0:Og.toJSON()}}async _setRedirectUser(Pg,Qg){const Rg=await this.getOrInitRedirectPersistenceManager(Qg);return null===Pg?Rg.removeCurrentUser():Rg.setCurrentUser(Pg)}async getOrInitRedirectPersistenceManager(Sg){if(!this.redirectPersistenceManager){const Tg=Sg&&ld(Sg)||this._popupRedirectResolver;hd(Tg,this,"argument-error"),this.redirectPersistenceManager=await Hf.create(this,[ld(Tg._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(Ug){var Vg,Wg;return(this._isInitialized&&await this.queue(async()=>{}),(null===(Vg=this._currentUser)|| void 0===Vg?void 0:Vg._redirectEventId)===Ug)?this._currentUser:(null===(Wg=this.redirectUser)|| void 0===Wg?void 0:Wg._redirectEventId)===Ug?this.redirectUser:null}async _persistUserIfCurrent(Xg){if(Xg===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(Xg))}_notifyListenersIfCurrent(Yg){Yg===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var Zg,$g;if(this._isInitialized){this.idTokenSubscription.next(this.currentUser);const _g=null!==($g=null===(Zg=this.currentUser)|| void 0===Zg?void 0:Zg.uid)&& void 0!==$g?$g:null;this.lastNotifiedUid!==_g&&(this.lastNotifiedUid=_g,this.authStateSubscription.next(this.currentUser))}}registerStateListener(ah,bh,ch,dh){if(this._deleted)return()=>{};const eh="function"==typeof bh?bh:bh.next.bind(bh),fh=this._isInitialized?Promise.resolve():this._initializationPromise;return(hd(fh,this,"internal-error"),fh.then(()=>eh(this.currentUser)),"function"==typeof bh)?ah.addObserver(bh,ch,dh):ah.addObserver(bh)}async directlySetCurrentUser(gh){this.currentUser&&this.currentUser!==gh&&(this._currentUser._stopProactiveRefresh(),gh&&this.isProactiveRefreshEnabled&&gh._startProactiveRefresh()),this.currentUser=gh,gh?await this.assertedPersistence.setCurrentUser(gh):await this.assertedPersistence.removeCurrentUser()}queue(hh){return this.operations=this.operations.then(hh,hh),this.operations}get assertedPersistence(){return hd(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(ih){!ih||this.frameworks.includes(ih)||(this.frameworks.push(ih),this.frameworks.sort(),this.clientVersion=lg(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const jh={["X-Client-Version"]:this.clientVersion};return this.app.options.appId&&(jh["X-Firebase-gmpid"]=this.app.options.appId),jh}}function kh(a){return xa(a)}class lh{constructor(mh){this.auth=mh,this.observer=null,this.addObserver=ea(a=>this.observer=a)}get next(){return hd(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function nh(a){const b=a.indexOf(":");return b<0?"":a.substr(0,b+1)}function oh(a){if(!a)return null;const b=Number(a);return isNaN(b)?null:b}class ph{constructor(qh,rh){this.providerId=qh,this.signInMethod=rh}toJSON(){return id("not implemented")}_getIdTokenResponse(sh){return id("not implemented")}_linkToIdToken(th,uh){return id("not implemented")}_getReauthenticationResolver(vh){return id("not implemented")}}async function wh(a,b){return Ad(a,"POST","/v1/accounts:resetPassword",zd(a,b))}async function xh(a,b){return Ad(a,"POST","/v1/accounts:update",b)}async function yh(a,b){return Ad(a,"POST","/v1/accounts:update",zd(a,b))}async function zh(a,b){return Cd(a,"POST","/v1/accounts:signInWithPassword",zd(a,b))}async function Ah(a,b){return Ad(a,"POST","/v1/accounts:sendOobCode",zd(a,b))}async function Bh(a,b){return Ah(a,b)}async function Ch(a,b){return Ah(a,b)}async function Dh(a,b){return Ah(a,b)}async function Eh(a,b){return Ah(a,b)}async function Fh(a,b){return Cd(a,"POST","/v1/accounts:signInWithEmailLink",zd(a,b))}async function Gh(a,b){return Cd(a,"POST","/v1/accounts:signInWithEmailLink",zd(a,b))}class Hh extends ph{constructor(Ih,Jh,Kh,Lh=null){super("password",Kh),this._email=Ih,this._password=Jh,this._tenantId=Lh}static _fromEmailAndPassword(Mh,Nh){return new Hh(Mh,Nh,"password")}static _fromEmailAndCode(Oh,Ph,Qh=null){return new Hh(Oh,Ph,"emailLink",Qh)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(Rh){const Sh="string"==typeof Rh?JSON.parse(Rh):Rh;if((null==Sh?void 0:Sh.email)&&(null==Sh?void 0:Sh.password)){if("password"===Sh.signInMethod)return this._fromEmailAndPassword(Sh.email,Sh.password);if("emailLink"===Sh.signInMethod)return this._fromEmailAndCode(Sh.email,Sh.password,Sh.tenantId)}return null}async _getIdTokenResponse(Th){switch(this.signInMethod){case"password":return zh(Th,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return Fh(Th,{email:this._email,oobCode:this._password});default:cd(Th,"internal-error")}}async _linkToIdToken(Uh,Vh){switch(this.signInMethod){case"password":return xh(Uh,{idToken:Vh,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return Gh(Uh,{idToken:Vh,email:this._email,oobCode:this._password});default:cd(Uh,"internal-error")}}_getReauthenticationResolver(Wh){return this._getIdTokenResponse(Wh)}}async function Xh(a,b){return Cd(a,"POST","/v1/accounts:signInWithIdp",zd(a,b))}class Yh extends ph{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(Zh){const $h=new Yh(Zh.providerId,Zh.signInMethod);return Zh.idToken||Zh.accessToken?(Zh.idToken&&($h.idToken=Zh.idToken),Zh.accessToken&&($h.accessToken=Zh.accessToken),Zh.nonce&&!Zh.pendingToken&&($h.nonce=Zh.nonce),Zh.pendingToken&&($h.pendingToken=Zh.pendingToken)):Zh.oauthToken&&Zh.oauthTokenSecret?($h.accessToken=Zh.oauthToken,$h.secret=Zh.oauthTokenSecret):cd("argument-error"),$h}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(_h){const ai="string"==typeof _h?JSON.parse(_h):_h,{providerId:bi,signInMethod:ci}=ai,di=Xc(ai,["providerId","signInMethod"]);if(!bi||!ci)return null;const ei=new Yh(bi,ci);return ei.idToken=di.idToken||void 0,ei.accessToken=di.accessToken||void 0,ei.secret=di.secret,ei.nonce=di.nonce,ei.pendingToken=di.pendingToken||null,ei}_getIdTokenResponse(fi){const gi=this.buildRequest();return Xh(fi,gi)}_linkToIdToken(hi,ii){const ji=this.buildRequest();return ji.idToken=ii,Xh(hi,ji)}_getReauthenticationResolver(ki){const li=this.buildRequest();return li.autoCreate=!1,Xh(ki,li)}buildRequest(){const mi={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)mi.pendingToken=this.pendingToken;else{const ni={};this.idToken&&(ni.id_token=this.idToken),this.accessToken&&(ni.access_token=this.accessToken),this.secret&&(ni.oauth_token_secret=this.secret),ni.providerId=this.providerId,this.nonce&&!this.pendingToken&&(ni.nonce=this.nonce),mi.postBody=ba(ni)}return mi}}async function oi(a,b){return Ad(a,"POST","/v1/accounts:sendVerificationCode",zd(a,b))}async function pi(a,b){return Cd(a,"POST","/v1/accounts:signInWithPhoneNumber",zd(a,b))}async function qi(a,b){const c=await Cd(a,"POST","/v1/accounts:signInWithPhoneNumber",zd(a,b));if(c.temporaryProof)throw Gd(a,"account-exists-with-different-credential",c);return c}const ri={["USER_NOT_FOUND"]:"user-not-found"};async function si(a,b){const c=Object.assign(Object.assign({},b),{operation:"REAUTH"});return Cd(a,"POST","/v1/accounts:signInWithPhoneNumber",zd(a,c),ri)}class ti extends ph{constructor(ui){super("phone","phone"),this.params=ui}static _fromVerification(vi,wi){return new ti({verificationId:vi,verificationCode:wi})}static _fromTokenResponse(xi,yi){return new ti({phoneNumber:xi,temporaryProof:yi})}_getIdTokenResponse(zi){return pi(zi,this._makeVerificationRequest())}_linkToIdToken(Ai,Bi){return qi(Ai,Object.assign({idToken:Bi},this._makeVerificationRequest()))}_getReauthenticationResolver(Ci){return si(Ci,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:Di,phoneNumber:Ei,verificationId:Fi,verificationCode:Gi}=this.params;return Di&&Ei?{temporaryProof:Di,phoneNumber:Ei}:{sessionInfo:Fi,code:Gi}}toJSON(){const Hi={providerId:this.providerId};return this.params.phoneNumber&&(Hi.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(Hi.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(Hi.verificationCode=this.params.verificationCode),this.params.verificationId&&(Hi.verificationId=this.params.verificationId),Hi}static fromJSON(Ii){"string"==typeof Ii&&(Ii=JSON.parse(Ii));const{verificationId:Ji,verificationCode:Ki,phoneNumber:Li,temporaryProof:Mi}=Ii;return Ki||Ji||Li||Mi?new ti({verificationId:Ji,verificationCode:Ki,phoneNumber:Li,temporaryProof:Mi}):null}}class Ni{constructor(Oi){var Pi,Qi,Ri,Si,Ti,Ui;const Vi=ca(da(Oi)),Wi=null!==(Pi=Vi.apiKey)&& void 0!==Pi?Pi:null,Xi=null!==(Qi=Vi.oobCode)&& void 0!==Qi?Qi:null,Yi=function(a){switch(a){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(Ri=Vi.mode)&& void 0!==Ri?Ri:null);hd(Wi&&Xi&&Yi,"argument-error"),this.apiKey=Wi,this.operation=Yi,this.code=Xi,this.continueUrl=null!==(Si=Vi.continueUrl)&& void 0!==Si?Si:null,this.languageCode=null!==(Ti=Vi.languageCode)&& void 0!==Ti?Ti:null,this.tenantId=null!==(Ui=Vi.tenantId)&& void 0!==Ui?Ui:null}static parseLink(Zi){const $i=function(a){const b=ca(da(a)).link,c=b?ca(da(b)).deep_link_id:null,d=ca(da(a)).deep_link_id,e=d?ca(da(d)).link:null;return e||d||c||b||a}(Zi);try{return new Ni($i)}catch(_i){return null}}}class aj{constructor(){this.providerId=aj.PROVIDER_ID}static credential(bj,cj){return Hh._fromEmailAndPassword(bj,cj)}static credentialWithLink(dj,ej){const fj=Ni.parseLink(ej);return hd(fj,"argument-error"),Hh._fromEmailAndCode(dj,fj.code,fj.tenantId)}}aj.PROVIDER_ID="password",aj.EMAIL_PASSWORD_SIGN_IN_METHOD="password",aj.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class gj{constructor(hj){this.providerId=hj,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(ij){this.defaultLanguageCode=ij}setCustomParameters(jj){return this.customParameters=jj,this}getCustomParameters(){return this.customParameters}}class kj extends gj{constructor(){super(...arguments),this.scopes=[]}addScope(lj){return this.scopes.includes(lj)||this.scopes.push(lj),this}getScopes(){return[...this.scopes]}}class mj extends kj{static credentialFromJSON(nj){const oj="string"==typeof nj?JSON.parse(nj):nj;return hd("providerId"in oj&&"signInMethod"in oj,"argument-error"),Yh._fromParams(oj)}credential(pj){return this._credential(Object.assign(Object.assign({},pj),{nonce:pj.rawNonce}))}_credential(qj){return hd(qj.idToken||qj.accessToken,"argument-error"),Yh._fromParams(Object.assign(Object.assign({},qj),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(rj){return mj.oauthCredentialFromTaggedObject(rj)}static credentialFromError(sj){return mj.oauthCredentialFromTaggedObject(sj.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:tj}){if(!tj)return null;const{oauthIdToken:uj,oauthAccessToken:vj,oauthTokenSecret:wj,pendingToken:xj,nonce:yj,providerId:zj}=tj;if(!vj&&!wj&&!uj&&!xj)return null;if(!zj)return null;try{return new mj(zj)._credential({idToken:uj,accessToken:vj,nonce:yj,pendingToken:xj})}catch(Aj){return null}}}class Bj extends kj{constructor(){super("facebook.com")}static credential(Cj){return Yh._fromParams({providerId:Bj.PROVIDER_ID,signInMethod:Bj.FACEBOOK_SIGN_IN_METHOD,accessToken:Cj})}static credentialFromResult(Dj){return Bj.credentialFromTaggedObject(Dj)}static credentialFromError(Ej){return Bj.credentialFromTaggedObject(Ej.customData||{})}static credentialFromTaggedObject({_tokenResponse:Fj}){if(!Fj||!("oauthAccessToken"in Fj))return null;if(!Fj.oauthAccessToken)return null;try{return Bj.credential(Fj.oauthAccessToken)}catch(Gj){return null}}}Bj.FACEBOOK_SIGN_IN_METHOD="facebook.com",Bj.PROVIDER_ID="facebook.com";class Hj extends kj{constructor(){super("google.com"),this.addScope("profile")}static credential(Ij,Jj){return Yh._fromParams({providerId:Hj.PROVIDER_ID,signInMethod:Hj.GOOGLE_SIGN_IN_METHOD,idToken:Ij,accessToken:Jj})}static credentialFromResult(Kj){return Hj.credentialFromTaggedObject(Kj)}static credentialFromError(Lj){return Hj.credentialFromTaggedObject(Lj.customData||{})}static credentialFromTaggedObject({_tokenResponse:Mj}){if(!Mj)return null;const{oauthIdToken:Nj,oauthAccessToken:Oj}=Mj;if(!Nj&&!Oj)return null;try{return Hj.credential(Nj,Oj)}catch(Pj){return null}}}Hj.GOOGLE_SIGN_IN_METHOD="google.com",Hj.PROVIDER_ID="google.com";class Qj extends kj{constructor(){super("github.com")}static credential(Rj){return Yh._fromParams({providerId:Qj.PROVIDER_ID,signInMethod:Qj.GITHUB_SIGN_IN_METHOD,accessToken:Rj})}static credentialFromResult(Sj){return Qj.credentialFromTaggedObject(Sj)}static credentialFromError(Tj){return Qj.credentialFromTaggedObject(Tj.customData||{})}static credentialFromTaggedObject({_tokenResponse:Uj}){if(!Uj||!("oauthAccessToken"in Uj))return null;if(!Uj.oauthAccessToken)return null;try{return Qj.credential(Uj.oauthAccessToken)}catch(Vj){return null}}}Qj.GITHUB_SIGN_IN_METHOD="github.com",Qj.PROVIDER_ID="github.com";class Wj extends ph{constructor(Xj,Yj){super(Xj,Xj),this.pendingToken=Yj}_getIdTokenResponse(Zj){const $j=this.buildRequest();return Xh(Zj,$j)}_linkToIdToken(_j,ak){const bk=this.buildRequest();return bk.idToken=ak,Xh(_j,bk)}_getReauthenticationResolver(ck){const dk=this.buildRequest();return dk.autoCreate=!1,Xh(ck,dk)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(ek){const fk="string"==typeof ek?JSON.parse(ek):ek,{providerId:gk,signInMethod:hk,pendingToken:ik}=fk;return gk&&hk&&ik&&gk===hk?new Wj(gk,ik):null}static _create(jk,kk){return new Wj(jk,kk)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class lk extends gj{constructor(mk){hd(mk.startsWith("saml."),"argument-error"),super(mk)}static credentialFromResult(nk){return lk.samlCredentialFromTaggedObject(nk)}static credentialFromError(ok){return lk.samlCredentialFromTaggedObject(ok.customData||{})}static credentialFromJSON(pk){const qk=Wj.fromJSON(pk);return hd(qk,"argument-error"),qk}static samlCredentialFromTaggedObject({_tokenResponse:rk}){if(!rk)return null;const{pendingToken:sk,providerId:tk}=rk;if(!sk||!tk)return null;try{return Wj._create(tk,sk)}catch(uk){return null}}}class vk extends kj{constructor(){super("twitter.com")}static credential(wk,xk){return Yh._fromParams({providerId:vk.PROVIDER_ID,signInMethod:vk.TWITTER_SIGN_IN_METHOD,oauthToken:wk,oauthTokenSecret:xk})}static credentialFromResult(yk){return vk.credentialFromTaggedObject(yk)}static credentialFromError(zk){return vk.credentialFromTaggedObject(zk.customData||{})}static credentialFromTaggedObject({_tokenResponse:Ak}){if(!Ak)return null;const{oauthAccessToken:Bk,oauthTokenSecret:Ck}=Ak;if(!Bk||!Ck)return null;try{return vk.credential(Bk,Ck)}catch(Dk){return null}}}async function Ek(a,b){return Cd(a,"POST","/v1/accounts:signUp",zd(a,b))}vk.TWITTER_SIGN_IN_METHOD="twitter.com",vk.PROVIDER_ID="twitter.com";class Fk{constructor(Gk){this.user=Gk.user,this.providerId=Gk.providerId,this._tokenResponse=Gk._tokenResponse,this.operationType=Gk.operationType}static async _fromIdTokenResponse(Hk,Ik,Jk,Kk=!1){const Lk=await se._fromIdTokenResponse(Hk,Jk,Kk),Mk=Sk(Jk),Nk=new Fk({user:Lk,providerId:Mk,_tokenResponse:Jk,operationType:Ik});return Nk}static async _forOperation(Ok,Pk,Qk){await Ok._updateTokensIfNecessary(Qk,!0);const Rk=Sk(Qk);return new Fk({user:Ok,providerId:Rk,_tokenResponse:Qk,operationType:Pk})}}function Sk(a){return a.providerId?a.providerId:"phoneNumber"in a?"phone":null}async function Tk(a){var b;const c=kh(a);if(await c._initializationPromise,null===(b=c.currentUser)|| void 0===b?void 0:b.isAnonymous)return new Fk({user:c.currentUser,providerId:null,operationType:"signIn"});const d=await Ek(c,{returnSecureToken:!0}),e=await Fk._fromIdTokenResponse(c,"signIn",d,!0);return await c._updateCurrentUser(e.user),e}class Uk extends I{constructor(Vk,Wk,Xk,Yk){var Zk;super(Wk.code,Wk.message),this.operationType=Xk,this.user=Yk,Object.setPrototypeOf(this,Uk.prototype),this.customData={appName:Vk.name,tenantId:null!==(Zk=Vk.tenantId)&& void 0!==Zk?Zk:void 0,_serverResponse:Wk.customData._serverResponse,operationType:Xk}}static _fromErrorAndOperation($k,_k,al,bl){return new Uk($k,_k,al,bl)}}function cl(a,b,c,d){const e="reauthenticate"===b?c._getReauthenticationResolver(a):c._getIdTokenResponse(a);return e.catch(c=>{if("auth/multi-factor-auth-required"===c.code)throw Uk._fromErrorAndOperation(a,c,b,d);throw c})}function dl(a){return new Set(a.map(({providerId:a})=>a).filter(a=>!!a))}async function el(a,b){const c=xa(a);await gl(!0,c,b);const{providerUserInfo:d}=await Id(c.auth,{idToken:await c.getIdToken(),deleteProvider:[b]}),e=dl(d||[]);return c.providerData=c.providerData.filter(a=>e.has(a.providerId)),e.has("phone")||(c.phoneNumber=null),await c.auth._persistUserIfCurrent(c),c}async function fl(a,b,c=!1){const d=await Od(a,b._linkToIdToken(a.auth,await a.getIdToken()),c);return Fk._forOperation(a,"link",d)}async function gl(a,b,c){await Ud(b);const d=dl(b.providerData);hd(d.has(c)===a,b.auth,!1===a?"provider-already-linked":"no-such-provider")}async function hl(a,b,c=!1){const{auth:d}=a,e="reauthenticate";try{const f=await Od(a,cl(d,e,b,a),c);hd(f.idToken,d,"internal-error");const g=Nd(f.idToken);hd(g,d,"internal-error");const{sub:h}=g;return hd(a.uid===h,d,"user-mismatch"),Fk._forOperation(a,e,f)}catch(i){throw(null==i?void 0:i.code)==="auth/user-not-found"&&cd(d,"user-mismatch"),i}}async function il(a,b,c=!1){const d="signIn",e=await cl(a,d,b),f=await Fk._fromIdTokenResponse(a,d,e);return c||await a._updateCurrentUser(f.user),f}async function jl(a,b){return il(kh(a),b)}async function kl(a,b){const c=xa(a);return await gl(!1,c,b.providerId),fl(c,b)}async function ll(a,b){return hl(xa(a),b)}async function ml(a,b){return Cd(a,"POST","/v1/accounts:signInWithCustomToken",zd(a,b))}async function nl(a,b){const c=kh(a),d=await ml(c,{token:b,returnSecureToken:!0}),e=await Fk._fromIdTokenResponse(c,"signIn",d);return await c._updateCurrentUser(e.user),e}class ol{constructor(pl,ql){this.factorId=pl,this.uid=ql.mfaEnrollmentId,this.enrollmentTime=new Date(ql.enrolledAt).toUTCString(),this.displayName=ql.displayName}static _fromServerResponse(rl,sl){return"phoneInfo"in sl?tl._fromServerResponse(rl,sl):cd(rl,"internal-error")}}class tl extends ol{constructor(ul){super("phone",ul),this.phoneNumber=ul.phoneInfo}static _fromServerResponse(vl,wl){return new tl(wl)}}function xl(a,b,c){var d;hd((null===(d=c.url)|| void 0===d?void 0:d.length)>0,a,"invalid-continue-uri"),hd(void 0===c.dynamicLinkDomain||c.dynamicLinkDomain.length>0,a,"invalid-dynamic-link-domain"),b.continueUrl=c.url,b.dynamicLinkDomain=c.dynamicLinkDomain,b.canHandleCodeInApp=c.handleCodeInApp,c.iOS&&(hd(c.iOS.bundleId.length>0,a,"missing-ios-bundle-id"),b.iOSBundleId=c.iOS.bundleId),c.android&&(hd(c.android.packageName.length>0,a,"missing-android-pkg-name"),b.androidInstallApp=c.android.installApp,b.androidMinimumVersionCode=c.android.minimumVersion,b.androidPackageName=c.android.packageName)}async function yl(a,b,c){const d=xa(a),e={requestType:"PASSWORD_RESET",email:b};c&&xl(d,e,c),await Ch(d,e)}async function zl(a,b,c){await wh(xa(a),{oobCode:b,newPassword:c})}async function Al(a,b){await yh(xa(a),{oobCode:b})}async function Bl(a,b){const c=xa(a),d=await wh(c,{oobCode:b}),e=d.requestType;switch(hd(e,c,"internal-error"),e){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":hd(d.newEmail,c,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":hd(d.mfaInfo,c,"internal-error");default:hd(d.email,c,"internal-error")}let f=null;return d.mfaInfo&&(f=ol._fromServerResponse(kh(c),d.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===d.requestType?d.newEmail:d.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===d.requestType?d.email:d.newEmail)||null,multiFactorInfo:f},operation:e}}async function Cl(a,b){const{data:c}=await Bl(xa(a),b);return c.email}async function Dl(a,b,c){const d=kh(a),e=await Ek(d,{returnSecureToken:!0,email:b,password:c}),f=await Fk._fromIdTokenResponse(d,"signIn",e);return await d._updateCurrentUser(f.user),f}async function El(a,b,c){const d=xa(a),e={requestType:"EMAIL_SIGNIN",email:b};hd(c.handleCodeInApp,d,"argument-error"),c&&xl(d,e,c),await Dh(d,e)}async function Fl(a,b,c){const d=xa(a),e=aj.credentialWithLink(b,c||md());return hd(e._tenantId===(d.tenantId||null),d,"tenant-id-mismatch"),jl(d,e)}async function Gl(a,b){return Ad(a,"POST","/v1/accounts:createAuthUri",zd(a,b))}async function Hl(a,b){const c=nd()?md():"http://localhost",{signinMethods:d}=await Gl(xa(a),{identifier:b,continueUri:c});return d||[]}async function Il(a,b){const c=xa(a),d=await a.getIdToken(),e={requestType:"VERIFY_EMAIL",idToken:d};b&&xl(c.auth,e,b);const{email:f}=await Bh(c.auth,e);f!==a.email&&await a.reload()}async function Jl(a,b,c){const d=xa(a),e=await a.getIdToken(),f={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:e,newEmail:b};c&&xl(d.auth,f,c);const{email:g}=await Eh(d.auth,f);g!==a.email&&await a.reload()}async function Kl(a,b){return Ad(a,"POST","/v1/accounts:update",b)}async function Ll(a,{displayName:b,photoURL:c}){if(void 0!==b|| void 0!==c){const d=xa(a),e=await d.getIdToken(),f=await Od(d,Kl(d.auth,{idToken:e,displayName:b,photoUrl:c,returnSecureToken:!0}));d.displayName=f.displayName||null,d.photoURL=f.photoUrl||null;const g=d.providerData.find(({providerId:a})=>"password"===a);g&&(g.displayName=d.displayName,g.photoURL=d.photoURL),await d._updateTokensIfNecessary(f)}}async function Ml(a,b,c){const{auth:d}=a,e=await a.getIdToken(),f={idToken:e,returnSecureToken:!0};b&&(f.email=b),c&&(f.password=c);const g=await Od(a,xh(d,f));await a._updateTokensIfNecessary(g,!0)}class Nl{constructor(Ol,Pl,Ql={}){this.isNewUser=Ol,this.providerId=Pl,this.profile=Ql}}class Rl extends Nl{constructor(Sl,Tl,Ul,Vl){super(Sl,Tl,Ul),this.username=Vl}}class Wl extends Nl{constructor(Xl,Yl){super(Xl,"facebook.com",Yl)}}class Zl extends Rl{constructor($l,_l){super($l,"github.com",_l,"string"==typeof(null==_l?void 0:_l.login)?null==_l?void 0:_l.login:null)}}class am extends Nl{constructor(bm,cm){super(bm,"google.com",cm)}}class dm extends Rl{constructor(em,fm,gm){super(em,"twitter.com",fm,gm)}}class hm{constructor(im,jm){this.type=im,this.credential=jm}static _fromIdtoken(km){return new hm("enroll",km)}static _fromMfaPendingCredential(lm){return new hm("signin",lm)}toJSON(){const mm="enroll"===this.type?"idToken":"pendingCredential";return{multiFactorSession:{[mm]:this.credential}}}static fromJSON(nm){var om,pm;if(null==nm?void 0:nm.multiFactorSession){if(null===(om=nm.multiFactorSession)|| void 0===om?void 0:om.pendingCredential)return hm._fromMfaPendingCredential(nm.multiFactorSession.pendingCredential);if(null===(pm=nm.multiFactorSession)|| void 0===pm?void 0:pm.idToken)return hm._fromIdtoken(nm.multiFactorSession.idToken)}return null}}class qm{constructor(rm,sm,tm){this.session=rm,this.hints=sm,this.signInResolver=tm}static _fromError(um,vm){const wm=kh(um),xm=vm.customData._serverResponse,ym=(xm.mfaInfo||[]).map(a=>ol._fromServerResponse(wm,a));hd(xm.mfaPendingCredential,wm,"internal-error");const zm=hm._fromMfaPendingCredential(xm.mfaPendingCredential);return new qm(zm,ym,async a=>{const b=await a._process(wm,zm);delete xm.mfaInfo,delete xm.mfaPendingCredential;const c=Object.assign(Object.assign({},xm),{idToken:b.idToken,refreshToken:b.refreshToken});switch(vm.operationType){case"signIn":const d=await Fk._fromIdTokenResponse(wm,vm.operationType,c);return await wm._updateCurrentUser(d.user),d;case"reauthenticate":return hd(vm.user,wm,"internal-error"),Fk._forOperation(vm.user,vm.operationType,c);default:cd(wm,"internal-error")}})}async resolveSignIn(Am){return this.signInResolver(Am)}}class Bm{constructor(Cm){this.user=Cm,this.enrolledFactors=[],Cm._onReload(a=>{a.mfaInfo&&(this.enrolledFactors=a.mfaInfo.map(a=>ol._fromServerResponse(Cm.auth,a)))})}static _fromUser(Dm){return new Bm(Dm)}async getSession(){return hm._fromIdtoken(await this.user.getIdToken())}async enroll(Em,Fm){const Gm=await this.getSession(),Hm=await Od(this.user,Em._process(this.user.auth,Gm,Fm));return await this.user._updateTokensIfNecessary(Hm),this.user.reload()}async unenroll(Im){var Jm;const Km="string"==typeof Im?Im:Im.uid,Lm=await this.user.getIdToken(),Mm=await Od(this.user,Ad(Jm=this.user.auth,"POST","/v2/accounts/mfaEnrollment:withdraw",zd(Jm,{idToken:Lm,mfaEnrollmentId:Km})));this.enrolledFactors=this.enrolledFactors.filter(({uid:a})=>a!==Km),await this.user._updateTokensIfNecessary(Mm);try{await this.user.reload()}catch(Nm){if("auth/user-token-expired"!==Nm.code)throw Nm}}}const Om=new WeakMap(),Pm="__sak";class Qm{constructor(Rm,Sm){this.storageRetriever=Rm,this.type=Sm}_isAvailable(){try{if(!this.storage)return Promise.resolve(!1);return this.storage.setItem(Pm,"1"),this.storage.removeItem(Pm),Promise.resolve(!0)}catch(Tm){return Promise.resolve(!1)}}_set(Um,Vm){return this.storage.setItem(Um,JSON.stringify(Vm)),Promise.resolve()}_get(Wm){const Xm=this.storage.getItem(Wm);return Promise.resolve(Xm?JSON.parse(Xm):null)}_remove(Ym){return this.storage.removeItem(Ym),Promise.resolve()}get storage(){return this.storageRetriever()}}class Zm extends Qm{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(a,b)=>this.onStorageEvent(a,b),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=(function(){const a=B();return dg(a)||jg(a)})()&&(function(){try{return!!(window&&window!==window.top)}catch(a){return!1}})(),this.fallbackToPolling=kg(),this._shouldAllowMigration=!0}forAllChangedKeys($m){for(const _m of Object.keys(this.listeners)){const an=this.storage.getItem(_m),bn=this.localCache[_m];an!==bn&&$m(_m,bn,an)}}onStorageEvent(cn,dn=!1){if(!cn.key){this.forAllChangedKeys((a,b,c)=>{this.notifyListeners(a,c)});return}const en=cn.key;if(dn?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const fn=this.storage.getItem(en);if(cn.newValue!==fn)null!==cn.newValue?this.storage.setItem(en,cn.newValue):this.storage.removeItem(en);else if(this.localCache[en]===cn.newValue&&!dn)return}const gn=()=>{const a=this.storage.getItem(en);(dn||this.localCache[en]!==a)&&this.notifyListeners(en,a)},hn=this.storage.getItem(en);G()&&10===document.documentMode&&hn!==cn.newValue&&cn.newValue!==cn.oldValue?setTimeout(gn,10):gn()}notifyListeners(jn,kn){this.localCache[jn]=kn;const ln=this.listeners[jn];if(ln)for(const mn of Array.from(ln))mn(kn?JSON.parse(kn):kn)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((a,b,c)=>{this.onStorageEvent(new StorageEvent("storage",{key:a,oldValue:b,newValue:c}),!0)})},1000)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(nn,on){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[nn]||(this.listeners[nn]=new Set(),this.localCache[nn]=this.storage.getItem(nn)),this.listeners[nn].add(on)}_removeListener(pn,qn){this.listeners[pn]&&(this.listeners[pn].delete(qn),0===this.listeners[pn].size&&delete this.listeners[pn]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(rn,sn){await super._set(rn,sn),this.localCache[rn]=JSON.stringify(sn)}async _get(tn){const un=await super._get(tn);return this.localCache[tn]=JSON.stringify(un),un}async _remove(vn){await super._remove(vn),delete this.localCache[vn]}}Zm.type="LOCAL";const wn=Zm;class xn extends Qm{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(yn,zn){}_removeListener(An,Bn){}}xn.type="SESSION";const Cn=xn;class Dn{constructor(En){this.eventTarget=En,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(Fn){const Gn=this.receivers.find(a=>a.isListeningto(Fn));if(Gn)return Gn;const Hn=new Dn(Fn);return this.receivers.push(Hn),Hn}isListeningto(In){return this.eventTarget===In}async handleEvent(Jn){var Kn;const Ln=Jn,{eventId:Mn,eventType:Nn,data:On}=Ln.data,Pn=this.handlersMap[Nn];if(null==Pn?void 0:Pn.size){Ln.ports[0].postMessage({status:"ack",eventId:Mn,eventType:Nn});const Qn=Array.from(Pn).map(async a=>a(Ln.origin,On)),Rn=await (Kn=Qn,Promise.all(Kn.map(async a=>{try{const b=await a;return{fulfilled:!0,value:b}}catch(c){return{fulfilled:!1,reason:c}}})));Ln.ports[0].postMessage({status:"done",eventId:Mn,eventType:Nn,response:Rn})}}_subscribe(Sn,Tn){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[Sn]||(this.handlersMap[Sn]=new Set()),this.handlersMap[Sn].add(Tn)}_unsubscribe(Un,Vn){this.handlersMap[Un]&&Vn&&this.handlersMap[Un].delete(Vn),Vn&&0!==this.handlersMap[Un].size||delete this.handlersMap[Un],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Wn(a="",b=10){let c="";for(let d=0;d<b;d++)c+=Math.floor(10*Math.random());return a+c}Dn.receivers=[];class Xn{constructor(Yn){this.target=Yn,this.handlers=new Set()}removeMessageHandler(Zn){Zn.messageChannel&&(Zn.messageChannel.port1.removeEventListener("message",Zn.onMessage),Zn.messageChannel.port1.close()),this.handlers.delete(Zn)}async _send($n,_n,ao=50){const bo="undefined"!=typeof MessageChannel?new MessageChannel():null;if(!bo)throw new Error("connection_unavailable");let co,eo;return new Promise((a,b)=>{const c=Wn("",20);bo.port1.start();const d=setTimeout(()=>{b(new Error("unsupported_event"))},ao);eo={messageChannel:bo,onMessage(e){const f=e;if(f.data.eventId===c)switch(f.data.status){case"ack":clearTimeout(d),co=setTimeout(()=>{b(new Error("timeout"))},3000);break;case"done":clearTimeout(co),a(f.data.response);break;default:clearTimeout(d),clearTimeout(co),b(new Error("invalid_response"));break}}},this.handlers.add(eo),bo.port1.addEventListener("message",eo.onMessage),this.target.postMessage({eventType:$n,eventId:c,data:_n},[bo.port2])}).finally(()=>{eo&&this.removeMessageHandler(eo)})}}function fo(){return window}function go(){return void 0!==fo().WorkerGlobalScope&&"function"==typeof fo().importScripts}async function ho(){if(!(null==navigator?void 0:navigator.serviceWorker))return null;try{const a=await navigator.serviceWorker.ready;return a.active}catch(b){return null}}const io="firebaseLocalStorageDb",jo="firebaseLocalStorage",ko="fbase_key";class lo{constructor(mo){this.request=mo}toPromise(){return new Promise((a,b)=>{this.request.addEventListener("success",()=>{a(this.request.result)}),this.request.addEventListener("error",()=>{b(this.request.error)})})}}function no(a,b){return a.transaction([jo],b?"readwrite":"readonly").objectStore(jo)}function oo(){const a=indexedDB.open(io,1);return new Promise((b,c)=>{a.addEventListener("error",()=>{c(a.error)}),a.addEventListener("upgradeneeded",()=>{const b=a.result;try{b.createObjectStore(jo,{keyPath:ko})}catch(d){c(d)}}),a.addEventListener("success",async()=>{const c=a.result;c.objectStoreNames.contains(jo)?b(c):(c.close(),await function(){const a=indexedDB.deleteDatabase(io);return new lo(a).toPromise()}(),b(await oo()))})})}async function po(a,b,c){const d=no(a,!0).put({[ko]:b,value:c});return new lo(d).toPromise()}async function qo(a,b){const c=no(a,!1).get(b),d=await new lo(c).toPromise();return void 0===d?null:d.value}function ro(a,b){const c=no(a,!0).delete(b);return new lo(c).toPromise()}class so{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await oo()),this.db}async _withRetries(to){let uo=0;for(;;)try{const vo=await this._openDb();return await to(vo)}catch(wo){if(uo++ >3)throw wo;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return go()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Dn._getInstance(go()?self:null),this.receiver._subscribe("keyChanged",async(a,b)=>{const c=await this._poll();return{keyProcessed:c.includes(b.key)}}),this.receiver._subscribe("ping",async(a,b)=>["keyChanged"])}async initializeSender(){var xo,yo;if(this.activeServiceWorker=await ho(),this.activeServiceWorker){this.sender=new Xn(this.activeServiceWorker);const zo=await this.sender._send("ping",{},800);!!zo&&(null===(xo=zo[0])|| void 0===xo?void 0:xo.fulfilled)&&(null===(yo=zo[0])|| void 0===yo?void 0:yo.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}}async notifyServiceWorker(Ao){var Bo;if(this.sender&&this.activeServiceWorker&&((null===(Bo=null==navigator?void 0:navigator.serviceWorker)|| void 0===Bo?void 0:Bo.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:Ao},this.serviceWorkerReceiverAvailable?800:50)}catch(Co){}}async _isAvailable(){try{if(!indexedDB)return!1;const Do=await oo();return await po(Do,Pm,"1"),await ro(Do,Pm),!0}catch(Eo){}return!1}async _withPendingWrite(Fo){this.pendingWrites++;try{await Fo()}finally{this.pendingWrites--}}async _set(Go,Ho){return this._withPendingWrite(async()=>(await this._withRetries(a=>po(a,Go,Ho)),this.localCache[Go]=Ho,this.notifyServiceWorker(Go)))}async _get(Io){const Jo=await this._withRetries(a=>qo(a,Io));return this.localCache[Io]=Jo,Jo}async _remove(Ko){return this._withPendingWrite(async()=>(await this._withRetries(a=>ro(a,Ko)),delete this.localCache[Ko],this.notifyServiceWorker(Ko)))}async _poll(){const Lo=await this._withRetries(a=>{const b=no(a,!1).getAll();return new lo(b).toPromise()});if(!Lo)return[];if(0!==this.pendingWrites)return[];const Mo=[],No=new Set();for(const{fbase_key:Oo,value:Po}of Lo)No.add(Oo),JSON.stringify(this.localCache[Oo])!==JSON.stringify(Po)&&(this.notifyListeners(Oo,Po),Mo.push(Oo));for(const Qo of Object.keys(this.localCache))this.localCache[Qo]&&!No.has(Qo)&&(this.notifyListeners(Qo,null),Mo.push(Qo));return Mo}notifyListeners(Ro,So){this.localCache[Ro]=So;const To=this.listeners[Ro];if(To)for(const Uo of Array.from(To))Uo(So)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(Vo,Wo){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[Vo]||(this.listeners[Vo]=new Set(),this._get(Vo)),this.listeners[Vo].add(Wo)}_removeListener(Xo,Yo){this.listeners[Xo]&&(this.listeners[Xo].delete(Yo),0===this.listeners[Xo].size&&delete this.listeners[Xo]),0===Object.keys(this.listeners).length&&this.stopPolling()}}so.type="LOCAL";const Zo=so;async function $o(a){return(await Ad(a,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}function _o(a){return new Promise((b,c)=>{var d,e;const f=document.createElement("script");f.setAttribute("src",a),f.onload=b,f.onerror=a=>{const b=dd("internal-error");b.customData=a,c(b)},f.type="text/javascript",f.charset="UTF-8",(null!==(e=null===(d=document.getElementsByTagName("head"))|| void 0===d?void 0:d[0])&& void 0!==e?e:document).appendChild(f)})}function ap(a){return`__${a}${Math.floor(10e5*Math.random())}`}class bp{constructor(cp){this.auth=cp,this.counter=10e11,this._widgets=new Map()}render(dp,ep){const fp=this.counter;return this._widgets.set(fp,new np(dp,this.auth.name,ep||{})),this.counter++,fp}reset(gp){var hp;const ip=gp||10e11;null===(hp=this._widgets.get(ip))|| void 0===hp||hp.delete(),this._widgets.delete(ip)}getResponse(jp){var kp;return(null===(kp=this._widgets.get(jp||10e11))|| void 0===kp?void 0:kp.getResponse())||""}async execute(lp){var mp;return null===(mp=this._widgets.get(lp||10e11))|| void 0===mp||mp.execute(),""}}class np{constructor(op,pp,qp){this.params=qp,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const rp="string"==typeof op?document.getElementById(op):op;hd(rp,"argument-error",{appName:pp}),this.container=rp,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout(()=>{this.responseToken=sp(50);const{callback:a,"expired-callback":b}=this.params;if(a)try{a(this.responseToken)}catch(c){}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,b)try{b()}catch(a){}this.isVisible&&this.execute()},60e3)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function sp(a){const b=[],c="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let d=0;d<a;d++)b.push(c.charAt(Math.floor(Math.random()*c.length)));return b.join("")}const tp=ap("rcb"),up=new pd(30e3,60e3),vp="recaptcha";class wp{constructor(xp,yp){this.verificationId=xp,this.onConfirmation=yp}confirm(zp){const Ap=ti._fromVerification(this.verificationId,zp);return this.onConfirmation(Ap)}}async function Bp(a,b,c){const d=kh(a),e=await Ep(d,b,xa(c));return new wp(e,a=>jl(d,a))}async function Cp(a,b,c){const d=xa(a);await gl(!1,d,"phone");const e=await Ep(d.auth,b,xa(c));return new wp(e,a=>kl(d,a))}async function Dp(a,b,c){const d=xa(a),e=await Ep(d.auth,b,xa(c));return new wp(e,a=>ll(d,a))}async function Ep(a,b,c){var d,e,f,g,h;const i=await c.verify();try{hd("string"==typeof i,a,"argument-error"),hd(c.type===vp,a,"argument-error");let j;if(j="string"==typeof b?{phoneNumber:b}:b,"session"in j){const k=j.session;if("phoneNumber"in j){hd("enroll"===k.type,a,"internal-error");const l=await (e=a,f={idToken:k.credential,phoneEnrollmentInfo:{phoneNumber:j.phoneNumber,recaptchaToken:i}},Ad(e,"POST","/v2/accounts/mfaEnrollment:start",zd(e,f)));return l.phoneSessionInfo.sessionInfo}{hd("signin"===k.type,a,"internal-error");const m=(null===(d=j.multiFactorHint)|| void 0===d?void 0:d.uid)||j.multiFactorUid;hd(m,a,"missing-multi-factor-info");const n=await (g=a,h={mfaPendingCredential:k.credential,mfaEnrollmentId:m,phoneSignInInfo:{recaptchaToken:i}},Ad(g,"POST","/v2/accounts/mfaSignIn:start",zd(g,h)));return n.phoneResponseInfo.sessionInfo}}{const{sessionInfo:o}=await oi(a,{phoneNumber:j.phoneNumber,recaptchaToken:i});return o}}finally{c._reset()}}async function Fp(a,b){await fl(xa(a),b)}class Gp{constructor(Hp){this.providerId=Gp.PROVIDER_ID,this.auth=kh(Hp)}verifyPhoneNumber(Ip,Jp){return Ep(this.auth,Ip,xa(Jp))}static credential(Kp,Lp){return ti._fromVerification(Kp,Lp)}static credentialFromResult(Mp){return Gp.credentialFromTaggedObject(Mp)}static credentialFromError(Np){return Gp.credentialFromTaggedObject(Np.customData||{})}static credentialFromTaggedObject({_tokenResponse:Op}){if(!Op)return null;const{phoneNumber:Pp,temporaryProof:Qp}=Op;return Pp&&Qp?ti._fromTokenResponse(Pp,Qp):null}}function Rp(a,b){return b?ld(b):(hd(a._popupRedirectResolver,a,"argument-error"),a._popupRedirectResolver)}Gp.PROVIDER_ID="phone",Gp.PHONE_SIGN_IN_METHOD="phone";class Sp extends ph{constructor(Tp){super("custom","custom"),this.params=Tp}_getIdTokenResponse(Up){return Xh(Up,this._buildIdpRequest())}_linkToIdToken(Vp,Wp){return Xh(Vp,this._buildIdpRequest(Wp))}_getReauthenticationResolver(Xp){return Xh(Xp,this._buildIdpRequest())}_buildIdpRequest(Yp){const Zp={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return Yp&&(Zp.idToken=Yp),Zp}}function $p(a){return il(a.auth,new Sp(a),a.bypassAuthState)}function _p(a){const{auth:b,user:c}=a;return hd(c,b,"internal-error"),hl(c,new Sp(a),a.bypassAuthState)}async function aq(a){const{auth:b,user:c}=a;return hd(c,b,"internal-error"),fl(c,new Sp(a),a.bypassAuthState)}class bq{constructor(cq,dq,eq,fq,gq=!1){this.auth=cq,this.resolver=eq,this.user=fq,this.bypassAuthState=gq,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(dq)?dq:[dq]}execute(){return new Promise(async(a,b)=>{this.pendingPromise={resolve:a,reject:b};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(c){this.reject(c)}})}async onAuthEvent(hq){const{urlResponse:iq,sessionId:jq,postBody:kq,tenantId:lq,error:mq,type:nq}=hq;if(mq){this.reject(mq);return}const oq={auth:this.auth,requestUri:iq,sessionId:jq,tenantId:lq||void 0,postBody:kq||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(nq)(oq))}catch(pq){this.reject(pq)}}onError(qq){this.reject(qq)}getIdpTask(rq){switch(rq){case"signInViaPopup":case"signInViaRedirect":return $p;case"linkViaPopup":case"linkViaRedirect":return aq;case"reauthViaPopup":case"reauthViaRedirect":return _p;default:cd(this.auth,"internal-error")}}resolve(sq){jd(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(sq),this.unregisterAndCleanUp()}reject(tq){jd(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(tq),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const uq=new pd(2000,10e3);async function vq(a,b,c){const d=kh(a);fd(a,b,gj);const e=Rp(d,c),f=new yq(d,"signInViaPopup",b,e);return f.executeNotNull()}async function wq(a,b,c){const d=xa(a);fd(d.auth,b,gj);const e=Rp(d.auth,c),f=new yq(d.auth,"reauthViaPopup",b,e,d);return f.executeNotNull()}async function xq(a,b,c){const d=xa(a);fd(d.auth,b,gj);const e=Rp(d.auth,c),f=new yq(d.auth,"linkViaPopup",b,e,d);return f.executeNotNull()}class yq extends bq{constructor(zq,Aq,Bq,Cq,Dq){super(zq,Aq,Cq,Dq),this.provider=Bq,this.authWindow=null,this.pollId=null,yq.currentPopupAction&&yq.currentPopupAction.cancel(),yq.currentPopupAction=this}async executeNotNull(){const Eq=await this.execute();return hd(Eq,this.auth,"internal-error"),Eq}async onExecution(){jd(1===this.filter.length,"Popup operations only handle one event");const Fq=Wn();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],Fq),this.authWindow.associatedEvent=Fq,this.resolver._originValidation(this.auth).catch(a=>{this.reject(a)}),this.resolver._isIframeWebStorageSupported(this.auth,a=>{a||this.reject(dd(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var Gq;return(null===(Gq=this.authWindow)|| void 0===Gq?void 0:Gq.associatedEvent)||null}cancel(){this.reject(dd(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,yq.currentPopupAction=null}pollUserCancellation(){const Hq=()=>{var a,b;if(null===(b=null===(a=this.authWindow)|| void 0===a?void 0:a.window)|| void 0===b?void 0:b.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(dd(this.auth,"popup-closed-by-user"))},2000);return}this.pollId=window.setTimeout(Hq,uq.get())};Hq()}}yq.currentPopupAction=null;const Iq=new Map();class Jq extends bq{constructor(Kq,Lq,Mq=!1){super(Kq,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],Lq,void 0,Mq),this.eventId=null}async execute(){let Nq=Iq.get(this.auth._key());if(!Nq){try{const Oq=await Tq(this.resolver,this.auth),Pq=Oq?await super.execute():null;Nq=()=>Promise.resolve(Pq)}catch(Qq){Nq=()=>Promise.reject(Qq)}Iq.set(this.auth._key(),Nq)}return this.bypassAuthState||Iq.set(this.auth._key(),()=>Promise.resolve(null)),Nq()}async onAuthEvent(Rq){if("signInViaRedirect"===Rq.type)return super.onAuthEvent(Rq);if("unknown"===Rq.type){this.resolve(null);return}if(Rq.eventId){const Sq=await this.auth._redirectUserForId(Rq.eventId);if(Sq)return this.user=Sq,super.onAuthEvent(Rq);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Tq(a,b){const c=Wq(b),d=Vq(a);if(!await d._isAvailable())return!1;const e=await d._get(c)==="true";return await d._remove(c),e}async function Uq(a,b){return Vq(a)._set(Wq(b),"true")}function Vq(a){return ld(a._redirectPersistence)}function Wq(a){return Gf("pendingRedirect",a.config.apiKey,a.name)}async function Xq(a,b,c){const d=kh(a);fd(a,b,gj);const e=Rp(d,c);return await Uq(e,d),e._openRedirect(d,b,"signInViaRedirect")}async function Yq(a,b,c){const d=xa(a);fd(d.auth,b,gj);const e=Rp(d.auth,c);await Uq(e,d.auth);const f=await ar(d);return e._openRedirect(d.auth,b,"reauthViaRedirect",f)}async function Zq(a,b,c){const d=xa(a);fd(d.auth,b,gj);const e=Rp(d.auth,c);await gl(!1,d,b.providerId),await Uq(e,d.auth);const f=await ar(d);return e._openRedirect(d.auth,b,"linkViaRedirect",f)}async function $q(a,b){return await kh(a)._initializationPromise,_q(a,b,!1)}async function _q(a,b,c=!1){const d=kh(a),e=Rp(d,b),f=new Jq(d,e,c),g=await f.execute();return g&&!c&&(delete g.user._redirectEventId,await d._persistUserIfCurrent(g.user),await d._setRedirectUser(null,b)),g}async function ar(a){const b=Wn(`${a.uid}:::`);return a._redirectEventId=b,await a.auth._setRedirectUser(a),await a.auth._persistUserIfCurrent(a),b}class br{constructor(cr){this.auth=cr,this.cachedEventUids=new Set(),this.consumers=new Set(),this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(dr){this.consumers.add(dr),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,dr)&&(this.sendToConsumer(this.queuedRedirectEvent,dr),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(er){this.consumers.delete(er)}onEvent(fr){if(this.hasEventBeenHandled(fr))return!1;let gr=!1;return this.consumers.forEach(a=>{this.isEventForConsumer(fr,a)&&(gr=!0,this.sendToConsumer(fr,a),this.saveEventToCache(fr))}),this.hasHandledPotentialRedirect||!sr(fr)||(this.hasHandledPotentialRedirect=!0,gr||(this.queuedRedirectEvent=fr,gr=!0)),gr}sendToConsumer(hr,ir){var jr;if(hr.error&&!rr(hr)){const kr=(null===(jr=hr.error.code)|| void 0===jr?void 0:jr.split("auth/")[1])||"internal-error";ir.onError(dd(this.auth,kr))}else ir.onAuthEvent(hr)}isEventForConsumer(lr,mr){const nr=null===mr.eventId|| !!lr.eventId&&lr.eventId===mr.eventId;return mr.filter.includes(lr.type)&&nr}hasEventBeenHandled(or){return Date.now()-this.lastProcessedEventTime>=60e4&&this.cachedEventUids.clear(),this.cachedEventUids.has(qr(or))}saveEventToCache(pr){this.cachedEventUids.add(qr(pr)),this.lastProcessedEventTime=Date.now()}}function qr(a){return[a.type,a.eventId,a.sessionId,a.tenantId].filter(a=>a).join("-")}function rr({type:a,error:b}){return"unknown"===a&&(null==b?void 0:b.code)==="auth/no-auth-event"}function sr(a){switch(a.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return rr(a);default:return!1}}async function tr(a,b={}){return Ad(a,"GET","/v1/projects",b)}const ur=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,vr=/^https?/;async function wr(a){if(!a.config.emulator){const{authorizedDomains:b}=await tr(a);for(const c of b)try{if(xr(c))return}catch(d){}cd(a,"unauthorized-domain")}}function xr(a){const b=md(),{protocol:c,hostname:d}=new URL(b);if(a.startsWith("chrome-extension://")){const e=new URL(a);return""===e.hostname&&""===d?"chrome-extension:"===c&&a.replace("chrome-extension://","")===b.replace("chrome-extension://",""):"chrome-extension:"===c&&e.hostname===d}if(!vr.test(c))return!1;if(ur.test(a))return d===a;const f=a.replace(/\./g,"\\."),g=new RegExp("^(.+\\."+f+"|"+f+")$","i");return g.test(d)}const yr=new pd(30e3,60e3);function zr(){const a=fo().___jsl;if(null==a?void 0:a.H){for(const b of Object.keys(a.H))if(a.H[b].r=a.H[b].r||[],a.H[b].L=a.H[b].L||[],a.H[b].r=[...a.H[b].L],a.CP)for(let c=0;c<a.CP.length;c++)a.CP[c]=null}}let Ar=null;const Br=new pd(5000,15000),Cr={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Dr=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);async function Er(a){var b,c;const d=await (b=a,Ar=Ar||(c=b,new Promise((a,b)=>{var d,e,f;function g(){zr(),gapi.load("gapi.iframes",{callback:()=>{a(gapi.iframes.getContext())},ontimeout:()=>{zr(),b(dd(c,"network-request-failed"))},timeout:yr.get()})}if(null===(e=null===(d=fo().gapi)|| void 0===d?void 0:d.iframes)|| void 0===e?void 0:e.Iframe)a(gapi.iframes.getContext());else if(null===(f=fo().gapi)|| void 0===f?void 0:f.load)g();else{const h=ap("iframefcb");return fo()[h]=()=>{gapi.load?g():b(dd(c,"network-request-failed"))},_o(`https://apis.google.com/js/api.js?onload=${h}`).catch(a=>b(a))}}).catch(a=>{throw Ar=null,a}))),e=fo().gapi;return hd(e,a,"internal-error"),d.open({where:document.body,url:function(a){const b=a.config;hd(b.authDomain,a,"auth-domain-config-required");const c=b.emulator?sd(b,"emulator/auth/iframe"):`https://${a.config.authDomain}/__/auth/iframe`,d={apiKey:b.apiKey,appName:a.name,v:vc},e=Dr.get(a.config.apiHost);e&&(d.eid=e);const f=a._getFrameworks();return f.length&&(d.fw=f.join(",")),`${c}?${ba(d).slice(1)}`}(a),messageHandlersFilter:e.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Cr,dontclear:!0},b=>new Promise(async(c,d)=>{await b.restyle({setHideOnLeave:!1});const e=dd(a,"network-request-failed"),f=fo().setTimeout(()=>{d(e)},Br.get());function g(){fo().clearTimeout(f),c(b)}b.ping(g).then(g,()=>{d(e)})}))}const Fr={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Gr{constructor(Hr){this.window=Hr,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(Ir){}}}function Jr(a,b,c,d,e,f){hd(a.config.authDomain,a,"auth-domain-config-required"),hd(a.config.apiKey,a,"invalid-api-key");const g={apiKey:a.config.apiKey,appName:a.name,authType:c,redirectUrl:d,v:vc,eventId:e};if(b instanceof gj)for(const[h,i]of(b.setDefaultLanguage(a.languageCode),g.providerId=b.providerId||"",!function(a){for(const b in a)if(Object.prototype.hasOwnProperty.call(a,b))return!1;return!0}(b.getCustomParameters())&&(g.customParameters=JSON.stringify(b.getCustomParameters())),Object.entries(f||{})))g[h]=i;if(b instanceof kj){const j=b.getScopes().filter(a=>""!==a);j.length>0&&(g.scopes=j.join(","))}a.tenantId&&(g.tid=a.tenantId);const k=g;for(const l of Object.keys(k))void 0===k[l]&&delete k[l];return`${Kr(a)}?${ba(k).slice(1)}`}function Kr({config:a}){return a.emulator?sd(a,"emulator/auth/handler"):`https://${a.authDomain}/__/auth/handler`}const Lr="webStorageSupport",Mr=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Cn,this._completeRedirectFn=_q}async _openPopup(Nr,Or,Pr,Qr){var Rr;jd(null===(Rr=this.eventManagers[Nr._key()])|| void 0===Rr?void 0:Rr.manager,"_initialize() not called before _openPopup()");const Sr=Jr(Nr,Or,Pr,md(),Qr);return(function(a,b,c,d=500,e=600){const f=Math.max((window.screen.availHeight-e)/2,0).toString(),g=Math.max((window.screen.availWidth-d)/2,0).toString();let h="";const i=Object.assign(Object.assign({},Fr),{width:d.toString(),height:e.toString(),top:f,left:g}),j=B().toLowerCase();c&&(h=eg(j)?"_blank":c),cg(j)&&(b=b||"http://localhost",i.scrollbars="yes");const k=Object.entries(i).reduce((a,[b,c])=>`${a}${b}=${c},`,"");if((function(a=B()){var b;return jg(a)&&!!(null===(b=window.navigator)|| void 0===b?void 0:b.standalone)})(j)&&"_self"!==h)return(function(a,b){const c=document.createElement("a");c.href=a,c.target=b;const d=document.createEvent("MouseEvent");d.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),c.dispatchEvent(d)})(b||"",h),new Gr(null);const l=window.open(b||"",h,k);hd(l,a,"popup-blocked");try{l.focus()}catch(m){}return new Gr(l)})(Nr,Sr,Wn())}async _openRedirect(Tr,Ur,Vr,Wr){var Xr;return await this._originValidation(Tr),Xr=Jr(Tr,Ur,Vr,md(),Wr),fo().location.href=Xr,new Promise(()=>{})}_initialize(Yr){const Zr=Yr._key();if(this.eventManagers[Zr]){const{manager:$r,promise:_r}=this.eventManagers[Zr];return $r?Promise.resolve($r):(jd(_r,"If manager is not set, promise should be"),_r)}const as=this.initAndGetManager(Yr);return this.eventManagers[Zr]={promise:as},as.catch(()=>{delete this.eventManagers[Zr]}),as}async initAndGetManager(bs){const cs=await Er(bs),ds=new br(bs);return cs.register("authEvent",a=>{hd(null==a?void 0:a.authEvent,bs,"invalid-auth-event");const b=ds.onEvent(a.authEvent);return{status:b?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[bs._key()]={manager:ds},this.iframes[bs._key()]=cs,ds}_isIframeWebStorageSupported(es,fs){const gs=this.iframes[es._key()];gs.send(Lr,{type:Lr},a=>{var b;const c=null===(b=null==a?void 0:a[0])|| void 0===b?void 0:b[Lr];void 0!==c&&fs(!!c),cd(es,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(hs){const is=hs._key();return this.originValidationPromises[is]||(this.originValidationPromises[is]=wr(hs)),this.originValidationPromises[is]}get _shouldInitProactively(){return kg()||dg()||jg()}};class js{constructor(ks){this.factorId=ks}_process(ls,ms,ns){switch(ms.type){case"enroll":return this._finalizeEnroll(ls,ms.credential,ns);case"signin":return this._finalizeSignIn(ls,ms.credential);default:return id("unexpected MultiFactorSessionType")}}}class os extends js{constructor(ps){super("phone"),this.credential=ps}static _fromCredential(qs){return new os(qs)}_finalizeEnroll(rs,ss,ts){var us;return Ad(us=rs,"POST","/v2/accounts/mfaEnrollment:finalize",zd(us,{idToken:ss,displayName:ts,phoneVerificationInfo:this.credential._makeVerificationRequest()}))}_finalizeSignIn(vs,ws){var xs;return Ad(xs=vs,"POST","/v2/accounts/mfaSignIn:finalize",zd(xs,{mfaPendingCredential:ws,phoneVerificationInfo:this.credential._makeVerificationRequest()}))}}class ys{constructor(){}static assertion(zs){return os._fromCredential(zs)}}ys.FACTOR_ID="phone";var As="@firebase/auth",Bs="0.19.6";class Cs{constructor(Ds){this.auth=Ds,this.internalListeners=new Map()}getUid(){var Es;return this.assertAuthConfigured(),(null===(Es=this.auth.currentUser)|| void 0===Es?void 0:Es.uid)||null}async getToken(Fs){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;const Gs=await this.auth.currentUser.getIdToken(Fs);return{accessToken:Gs}}addAuthTokenListener(Hs){if(this.assertAuthConfigured(),!this.internalListeners.has(Hs)){const Is=this.auth.onIdTokenChanged(a=>{var b;Hs((null===(b=a)|| void 0===b?void 0:b.stsTokenManager.accessToken)||null)});this.internalListeners.set(Hs,Is),this.updateProactiveRefresh()}}removeAuthTokenListener(Js){this.assertAuthConfigured();const Ks=this.internalListeners.get(Js);Ks&&(this.internalListeners.delete(Js),Ks(),this.updateProactiveRefresh())}assertAuthConfigured(){hd(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Ls(){return window}async function Ms(a,b,c){var d;const{BuildInfo:e}=Ls();jd(b.sessionId,"AuthEvent did not contain a session ID");const f=await Ps(b.sessionId),g={};return jg()?g.ibi=e.packageName:gg()?g.apn=e.packageName:cd(a,"operation-not-supported-in-this-environment"),e.displayName&&(g.appDisplayName=e.displayName),g.sessionId=f,Jr(a,c,b.type,void 0,null!==(d=b.eventId)&& void 0!==d?d:void 0,g)}async function Ns(a){const{BuildInfo:b}=Ls(),c={};jg()?c.iosBundleId=b.packageName:gg()?c.androidPackageName=b.packageName:cd(a,"operation-not-supported-in-this-environment"),await tr(a,c)}async function Os(a,b,c){const{cordova:d}=Ls();let e=()=>{};try{await new Promise((f,g)=>{let h=null;function i(){var a;f();const b=null===(a=d.plugins.browsertab)|| void 0===a?void 0:a.close;"function"==typeof b&&b(),"function"==typeof(null==c?void 0:c.close)&&c.close()}function j(){h||(h=window.setTimeout(()=>{g(dd(a,"redirect-cancelled-by-user"))},2000))}function k(){(null==document?void 0:document.visibilityState)==="visible"&&j()}b.addPassiveListener(i),document.addEventListener("resume",j,!1),gg()&&document.addEventListener("visibilitychange",k,!1),e=()=>{b.removePassiveListener(i),document.removeEventListener("resume",j,!1),document.removeEventListener("visibilitychange",k,!1),h&&window.clearTimeout(h)}})}finally{e()}}async function Ps(a){const b=Qs(a),c=await crypto.subtle.digest("SHA-256",b),d=Array.from(new Uint8Array(c));return d.map(a=>a.toString(16).padStart(2,"0")).join("")}function Qs(a){if(jd(/[0-9a-zA-Z]+/.test(a),"Can only convert alpha-numeric strings"),"undefined"!=typeof TextEncoder)return new TextEncoder().encode(a);const b=new ArrayBuffer(a.length),c=new Uint8Array(b);for(let d=0;d<a.length;d++)c[d]=a.charCodeAt(d);return c}mw="Browser",kc(new ya("auth",(a,{options:b})=>{const c=a.getProvider("app").getImmediate(),{apiKey:d,authDomain:e}=c.options;return(a=>{hd(d&&!d.includes(":"),"invalid-api-key",{appName:a.name}),hd(!(null==e?void 0:e.includes(":")),"argument-error",{appName:a.name});const c={apiKey:d,authDomain:e,clientPlatform:mw,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:lg(mw)},f=new mg(a,c);return(function(a,b){const c=(null==b?void 0:b.persistence)||[],d=(Array.isArray(c)?c:[c]).map(ld);(null==b?void 0:b.errorMap)&&a._updateErrorMap(b.errorMap),a._initializeWithPersistence(d,null==b?void 0:b.popupRedirectResolver)})(f,b),f})(c)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((a,b,c)=>{const d=a.getProvider("auth-internal");d.initialize()})),kc(new ya("auth-internal",a=>{var b;const c=kh(a.getProvider("auth").getImmediate());return b=c,new Cs(b)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ac(As,Bs,function(a){switch(a){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(mw)),Ac(As,Bs,"esm2017");class Rs extends br{constructor(){super(...arguments),this.passiveListeners=new Set(),this.initPromise=new Promise(a=>{this.resolveInialized=a})}addPassiveListener(Ss){this.passiveListeners.add(Ss)}removePassiveListener(Ts){this.passiveListeners.delete(Ts)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(Us){return this.resolveInialized(),this.passiveListeners.forEach(a=>a(Us)),super.onEvent(Us)}async initialized(){await this.initPromise}}async function Vs(a){const b=await Ws()._get(Xs(a));return b&&await Ws()._remove(Xs(a)),b}function Ws(){return ld(wn)}function Xs(a){return Gf("authEvent",a.config.apiKey,a.name)}function Ys(a){if(!(null==a?void 0:a.includes("?")))return{};const[b,...c]=a.split("?");return ca(c.join("?"))}const Zs=class{constructor(){this._redirectPersistence=Cn,this._shouldInitProactively=!0,this.eventManagers=new Map(),this.originValidationPromises={},this._completeRedirectFn=_q}async _initialize($s){const _s=$s._key();let at=this.eventManagers.get(_s);return at||(at=new Rs($s),this.eventManagers.set(_s,at),this.attachCallbackListeners($s,at)),at}_openPopup(bt){cd(bt,"operation-not-supported-in-this-environment")}async _openRedirect(ct,dt,et,ft){var gt,ht;!function(a){var b,c,d,e,f,g,h,i,j,k;const l=Ls();hd("function"==typeof(null===(b=null==l?void 0:l.universalLinks)|| void 0===b?void 0:b.subscribe),a,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),hd(void 0!==(null===(c=null==l?void 0:l.BuildInfo)|| void 0===c?void 0:c.packageName),a,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),hd("function"==typeof(null===(f=null===(e=null===(d=null==l?void 0:l.cordova)|| void 0===d?void 0:d.plugins)|| void 0===e?void 0:e.browsertab)|| void 0===f?void 0:f.openUrl),a,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),hd("function"==typeof(null===(i=null===(h=null===(g=null==l?void 0:l.cordova)|| void 0===g?void 0:g.plugins)|| void 0===h?void 0:h.browsertab)|| void 0===i?void 0:i.isAvailable),a,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),hd("function"==typeof(null===(k=null===(j=null==l?void 0:l.cordova)|| void 0===j?void 0:j.InAppBrowser)|| void 0===k?void 0:k.open),a,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(ct);const it=await this._initialize(ct);await it.initialized(),it.resetRedirect(),Iq.clear(),await this._originValidation(ct);const jt=function(a,b,c=null){return{type:b,eventId:c,urlResponse:null,sessionId:(function(){const a=[],b="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let c=0;c<20;c++){const d=Math.floor(Math.random()*b.length);a.push(b.charAt(d))}return a.join("")})(),postBody:null,tenantId:a.tenantId,error:dd(a,"no-auth-event")}}(ct,et,ft);await (gt=ct,ht=jt,Ws()._set(Xs(gt),ht));const kt=await Ms(ct,jt,dt),lt=await function(a){const{cordova:b}=Ls();return new Promise(c=>{b.plugins.browsertab.isAvailable(d=>{let e=null;d?b.plugins.browsertab.openUrl(a):e=b.InAppBrowser.open(a,!function(a=B()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(a)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(a)}()?"_system":"_blank","location=yes"),c(e)})})}(kt);return Os(ct,it,lt)}_isIframeWebStorageSupported(mt,nt){throw new Error("Method not implemented.")}_originValidation(ot){const pt=ot._key();return this.originValidationPromises[pt]||(this.originValidationPromises[pt]=Ns(ot)),this.originValidationPromises[pt]}attachCallbackListeners(qt,rt){const{universalLinks:st,handleOpenURL:tt,BuildInfo:ut}=Ls(),vt=setTimeout(async()=>{await Vs(qt),rt.onEvent(zt())},500),wt=async a=>{clearTimeout(vt);const b=await Vs(qt);let c=null;b&&(null==a?void 0:a.url)&&(c=(function(a,b){var c,d;const e=function(a){const b=Ys(a),c=b.link?decodeURIComponent(b.link):void 0,d=Ys(c).link,e=b.deep_link_id?decodeURIComponent(b.deep_link_id):void 0,f=Ys(e).link;return f||e||d||c||a}(b);if(e.includes("/__/auth/callback")){const f=Ys(e),g=f.firebaseError?function(a){try{return JSON.parse(a)}catch(b){return null}}(decodeURIComponent(f.firebaseError)):null,h=null===(d=null===(c=null==g?void 0:g.code)|| void 0===c?void 0:c.split("auth/"))|| void 0===d?void 0:d[1],i=h?dd(h):null;return i?{type:a.type,eventId:a.eventId,tenantId:a.tenantId,error:i,urlResponse:null,sessionId:null,postBody:null}:{type:a.type,eventId:a.eventId,tenantId:a.tenantId,sessionId:a.sessionId,urlResponse:e,postBody:null}}return null})(b,a.url)),rt.onEvent(c||zt())};void 0!==st&&"function"==typeof st.subscribe&&st.subscribe(null,wt);const xt=tt,yt=`${ut.packageName.toLowerCase()}://`;Ls().handleOpenURL=async a=>{if(a.toLowerCase().startsWith(yt)&&wt({url:a}),"function"==typeof xt)try{xt(a)}catch(b){console.error(b)}}}};function zt(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:dd("no-auth-event")}}function At(){var a;return(null===(a=null==self?void 0:self.location)|| void 0===a?void 0:a.protocol)||null}function Bt(a=B()){return!!(("file:"===At()||"ionic:"===At())&&a.toLowerCase().match(/iphone|ipad|ipod|android/))}function Ct(){try{const a=self.localStorage,b=Wn();if(a){if(a.setItem(b,"1"),a.removeItem(b),(function(a=B()){return G()&&(null==document?void 0:document.documentMode)===11||(function(a=B()){return/Edge\/\d+/.test(a)})(a)})())return H();return!0}}catch(c){return Dt()&&H()}return!1}function Dt(){return void 0!==c.g&&"WorkerGlobalScope"in c.g&&"importScripts"in c.g}function Et(){return("http:"===At()||"https:"===At()||E()||Bt())&&!(F()||D())&&Ct()&&!Dt()}function Ft(){return Bt()&&"undefined"!=typeof document}async function Gt(){return!!Ft()&&new Promise(a=>{const b=setTimeout(()=>{a(!1)},1000);document.addEventListener("deviceready",()=>{clearTimeout(b),a(!0)})})}const Ht={LOCAL:"local",NONE:"none",SESSION:"session"},It=hd,Jt="persistence";async function Kt(a){await a._initializationPromise;const b=Lt(),c=Gf(Jt,a.config.apiKey,a.name);(null==b?void 0:b.sessionStorage)&&b.sessionStorage.setItem(c,a._getPersistence())}function Lt(){return"undefined"!=typeof window?window:null}const Mt=hd;class Nt{constructor(){this.browserResolver=ld(Mr),this.cordovaResolver=ld(Zs),this.underlyingResolver=null,this._redirectPersistence=Cn,this._completeRedirectFn=_q}async _initialize(Ot){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(Ot)}async _openPopup(Pt,Qt,Rt,St){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(Pt,Qt,Rt,St)}async _openRedirect(Tt,Ut,Vt,Wt){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(Tt,Ut,Vt,Wt)}_isIframeWebStorageSupported(Xt,Yt){this.assertedUnderlyingResolver._isIframeWebStorageSupported(Xt,Yt)}_originValidation(Zt){return this.assertedUnderlyingResolver._originValidation(Zt)}get _shouldInitProactively(){return Ft()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return Mt(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(!this.underlyingResolver){const $t=await Gt();this.underlyingResolver=$t?this.cordovaResolver:this.browserResolver}}}function _t(a){return a.unwrap()}function au(a){const{_tokenResponse:b}=a instanceof I?a.customData:a;if(!b)return null;if(!(a instanceof I)&&"temporaryProof"in b&&"phoneNumber"in b)return Gp.credentialFromResult(a);const c=b.providerId;if(!c||"password"===c)return null;let d;switch(c){case"google.com":d=Hj;break;case"facebook.com":d=Bj;break;case"github.com":d=Qj;break;case"twitter.com":d=vk;break;default:const{oauthIdToken:e,oauthAccessToken:f,oauthTokenSecret:g,pendingToken:h,nonce:i}=b;if(!f&&!g&&!e&&!h)return null;if(h){if(c.startsWith("saml."))return Wj._create(c,h);return Yh._fromParams({providerId:c,signInMethod:c,pendingToken:h,idToken:e,accessToken:f})}return new mj(c).credential({idToken:e,accessToken:f,rawNonce:i})}return a instanceof I?d.credentialFromError(a):d.credentialFromResult(a)}function bu(a,b){return b.catch(b=>{throw b instanceof I&&(function(a,b){var c;const d=null===(c=b.customData)|| void 0===c?void 0:c._tokenResponse;if("auth/multi-factor-auth-required"===b.code){const e=b;e.resolver=new du(a,function(a,b){var c;const d=xa(a),e=b;return hd(b.customData.operationType,d,"argument-error"),hd(null===(c=e.customData._serverResponse)|| void 0===c?void 0:c.mfaPendingCredential,d,"argument-error"),qm._fromError(d,e)}(a,b))}else if(d){const f=au(b),g=b;f&&(g.credential=f,g.tenantId=d.tenantId||void 0,g.email=d.email||void 0,g.phoneNumber=d.phoneNumber||void 0)}})(a,b),b}).then(a=>{const b=a.operationType,c=a.user;return{operationType:b,credential:au(a),additionalUserInfo:(function(a){const{user:b,_tokenResponse:c}=a;return b.isAnonymous&&!c?{providerId:null,isNewUser:!1,profile:null}:(function(a){var b,c;if(!a)return null;const{providerId:d}=a,e=a.rawUserInfo?JSON.parse(a.rawUserInfo):{},f=a.isNewUser||"identitytoolkit#SignupNewUserResponse"===a.kind;if(!d&&(null==a?void 0:a.idToken)){const g=null===(c=null===(b=Nd(a.idToken))|| void 0===b?void 0:b.firebase)|| void 0===c?void 0:c.sign_in_provider;if(g){const h="anonymous"!==g&&"custom"!==g?g:null;return new Nl(f,h)}}if(!d)return null;switch(d){case"facebook.com":return new Wl(f,e);case"github.com":return new Zl(f,e);case"google.com":return new am(f,e);case"twitter.com":return new dm(f,e,a.screenName||null);case"custom":case"anonymous":return new Nl(f,null);default:return new Nl(f,d,e)}})(c)})(a),user:hu.getOrCreate(c)}})}async function cu(a,b){const c=await b;return{verificationId:c.verificationId,confirm:b=>bu(a,c.confirm(b))}}class du{constructor(eu,fu){this.resolver=fu,this.auth=eu.wrapped()}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(gu){return bu(_t(this.auth),this.resolver.resolveSignIn(gu))}}class hu{constructor(iu){this._delegate=iu,this.multiFactor=(function(a){const b=xa(a);return Om.has(b)||Om.set(b,Bm._fromUser(b)),Om.get(b)})(iu)}static getOrCreate(ju){return hu.USER_MAP.has(ju)||hu.USER_MAP.set(ju,new hu(ju)),hu.USER_MAP.get(ju)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(ku){return this._delegate.getIdTokenResult(ku)}getIdToken(lu){return this._delegate.getIdToken(lu)}linkAndRetrieveDataWithCredential(mu){return this.linkWithCredential(mu)}async linkWithCredential(nu){return bu(this.auth,kl(this._delegate,nu))}async linkWithPhoneNumber(ou,pu){return cu(this.auth,Cp(this._delegate,ou,pu))}async linkWithPopup(qu){return bu(this.auth,xq(this._delegate,qu,Nt))}async linkWithRedirect(ru){return await Kt(kh(this.auth)),Zq(this._delegate,ru,Nt)}reauthenticateAndRetrieveDataWithCredential(su){return this.reauthenticateWithCredential(su)}async reauthenticateWithCredential(tu){return bu(this.auth,ll(this._delegate,tu))}reauthenticateWithPhoneNumber(uu,vu){return cu(this.auth,Dp(this._delegate,uu,vu))}reauthenticateWithPopup(wu){return bu(this.auth,wq(this._delegate,wu,Nt))}async reauthenticateWithRedirect(xu){return await Kt(kh(this.auth)),Yq(this._delegate,xu,Nt)}sendEmailVerification(yu){return Il(this._delegate,yu)}async unlink(zu){return await el(this._delegate,zu),this}updateEmail(Au){var Bu,Cu;return Bu=this._delegate,Cu=Au,Ml(xa(Bu),Cu,null)}updatePassword(Du){var Eu,Fu;return Eu=this._delegate,Fu=Du,Ml(xa(Eu),null,Fu)}updatePhoneNumber(Gu){return Fp(this._delegate,Gu)}updateProfile(Hu){return Ll(this._delegate,Hu)}verifyBeforeUpdateEmail(Iu,Ju){return Jl(this._delegate,Iu,Ju)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}hu.USER_MAP=new WeakMap();const Ku=hd;class Lu{constructor(Mu,Nu){if(this.app=Mu,Nu.isInitialized()){this._delegate=Nu.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:Ou}=Mu.options;Ku(Ou,"invalid-api-key",{appName:Mu.name}),Ku(Ou,"invalid-api-key",{appName:Mu.name}),this._delegate=Nu.initialize({options:{persistence:function(a,b){const c=function(a,b){const c=Lt();if(!(null==c?void 0:c.sessionStorage))return[];const d=Gf(Jt,a,b),e=c.sessionStorage.getItem(d);switch(e){case Ht.NONE:return[Ff];case Ht.LOCAL:return[Zo,Cn];case Ht.SESSION:return[Cn];default:return[]}}(a,b);if("undefined"==typeof self||c.includes(Zo)||c.push(Zo),"undefined"!=typeof window)for(const d of[wn,Cn])c.includes(d)||c.push(d);return c.includes(Ff)||c.push(Ff),c}(Ou,Mu.name),popupRedirectResolver:"undefined"!=typeof window?Nt:void 0}}),this._delegate._updateErrorMap(function(){return{["admin-restricted-operation"]:"This operation is restricted to administrators only.",["argument-error"]:"",["app-not-authorized"]:"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.",["app-not-installed"]:"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.",["captcha-check-failed"]:"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.",["code-expired"]:"The SMS code has expired. Please re-send the verification code to try again.",["cordova-not-ready"]:"Cordova framework is not ready.",["cors-unsupported"]:"This browser is not supported.",["credential-already-in-use"]:"This credential is already associated with a different user account.",["custom-token-mismatch"]:"The custom token corresponds to a different audience.",["requires-recent-login"]:"This operation is sensitive and requires recent authentication. Log in again before retrying this request.",["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.",["dynamic-link-not-activated"]:"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.",["email-change-needs-verification"]:"Multi-factor users must always have a verified email.",["email-already-in-use"]:"The email address is already in use by another account.",["emulator-config-failed"]:"Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling \"connectAuthEmulator()\" sooner.",["expired-action-code"]:"The action code has expired.",["cancelled-popup-request"]:"This operation has been cancelled due to another conflicting popup being opened.",["internal-error"]:"An internal AuthError has occurred.",["invalid-app-credential"]:"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.",["invalid-app-id"]:"The mobile app identifier is not registed for the current project.",["invalid-user-token"]:"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.",["invalid-auth-event"]:"An internal AuthError has occurred.",["invalid-verification-code"]:"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.",["invalid-continue-uri"]:"The continue URL provided in the request is invalid.",["invalid-cordova-configuration"]:"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.",["invalid-custom-token"]:"The custom token format is incorrect. Please check the documentation.",["invalid-dynamic-link-domain"]:"The provided dynamic link domain is not configured or authorized for the current project.",["invalid-email"]:"The email address is badly formatted.",["invalid-emulator-scheme"]:"Emulator URL must start with a valid scheme (http:// or https://).",["invalid-api-key"]:"Your API key is invalid, please check you have copied it correctly.",["invalid-cert-hash"]:"The SHA-1 certificate hash provided is invalid.",["invalid-credential"]:"The supplied auth credential is malformed or has expired.",["invalid-message-payload"]:"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.",["invalid-multi-factor-session"]:"The request does not contain a valid proof of first factor successful sign-in.",["invalid-oauth-provider"]:"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.",["invalid-oauth-client-id"]:"The OAuth client ID provided is either invalid or does not match the specified API key.",["unauthorized-domain"]:"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.",["invalid-action-code"]:"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.",["wrong-password"]:"The password is invalid or the user does not have a password.",["invalid-persistence-type"]:"The specified persistence type is invalid. It can only be local, session or none.",["invalid-phone-number"]:"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].",["invalid-provider-id"]:"The specified provider ID is invalid.",["invalid-recipient-email"]:"The email corresponding to this action failed to send as the provided recipient email address is invalid.",["invalid-sender"]:"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.",["invalid-verification-id"]:"The verification ID used to create the phone auth credential is invalid.",["invalid-tenant-id"]:"The Auth instance's tenant ID is invalid.",["missing-android-pkg-name"]:"An Android Package Name must be provided if the Android App is required to be installed.",["auth-domain-config-required"]:"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.",["missing-app-credential"]:"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.",["missing-verification-code"]:"The phone auth credential was created with an empty SMS verification code.",["missing-continue-uri"]:"A continue URL must be provided in the request.",["missing-iframe-start"]:"An internal AuthError has occurred.",["missing-ios-bundle-id"]:"An iOS Bundle ID must be provided if an App Store ID is provided.",["missing-or-invalid-nonce"]:"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.",["missing-multi-factor-info"]:"No second factor identifier is provided.",["missing-multi-factor-session"]:"The request is missing proof of first factor successful sign-in.",["missing-phone-number"]:"To send verification codes, provide a phone number for the recipient.",["missing-verification-id"]:"The phone auth credential was created with an empty verification ID.",["app-deleted"]:"This instance of FirebaseApp has been deleted.",["multi-factor-info-not-found"]:"The user does not have a second factor matching the identifier provided.",["multi-factor-auth-required"]:"Proof of ownership of a second factor is required to complete sign-in.",["account-exists-with-different-credential"]:"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.",["network-request-failed"]:"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.",["no-auth-event"]:"An internal AuthError has occurred.",["no-such-provider"]:"User was not linked to an account with the given provider.",["null-user"]:"A null user object was provided as the argument for an operation which requires a non-null user object.",["operation-not-allowed"]:"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.",["operation-not-supported-in-this-environment"]:"This operation is not supported in the environment this application is running on. \"location.protocol\" must be http, https or chrome-extension and web storage must be enabled.",["popup-blocked"]:"Unable to establish a connection with the popup. It may have been blocked by the browser.",["popup-closed-by-user"]:"The popup has been closed by the user before finalizing the operation.",["provider-already-linked"]:"User can only be linked to one identity for the given provider.",["quota-exceeded"]:"The project's quota for this operation has been exceeded.",["redirect-cancelled-by-user"]:"The redirect operation has been cancelled by the user before finalizing.",["redirect-operation-pending"]:"A redirect sign-in operation is already pending.",["rejected-credential"]:"The request contains malformed or mismatching credentials.",["second-factor-already-in-use"]:"The second factor is already enrolled on this account.",["maximum-second-factor-count-exceeded"]:"The maximum allowed number of second factors on a user has been exceeded.",["tenant-id-mismatch"]:"The provided tenant ID does not match the Auth instance's tenant ID",["timeout"]:"The operation has timed out.",["user-token-expired"]:"The user's credential is no longer valid. The user must sign in again.",["too-many-requests"]:"We have blocked all requests from this device due to unusual activity. Try again later.",["unauthorized-continue-uri"]:"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.",["unsupported-first-factor"]:"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.",["unsupported-persistence-type"]:"The current environment does not support the specified persistence type.",["unsupported-tenant-operation"]:"This operation is not supported in a multi-tenant context.",["unverified-email"]:"The operation requires a verified email.",["user-cancelled"]:"The user did not grant your application the permissions it requested.",["user-not-found"]:"There is no user record corresponding to this identifier. The user may have been deleted.",["user-disabled"]:"The user account has been disabled by an administrator.",["user-mismatch"]:"The supplied credentials do not correspond to the previously signed in user.",["user-signed-out"]:"",["weak-password"]:"The password must be 6 characters long or more.",["web-storage-unsupported"]:"This browser is not supported or 3rd party cookies and data may be disabled.",["already-initialized"]:"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}}),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?hu.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(Pu){this._delegate.languageCode=Pu}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(Qu){this._delegate.tenantId=Qu}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(Ru,Su){!function(a,b,c){const d=kh(a);hd(d._canInitEmulator,d,"emulator-config-failed"),hd(/^https?:\/\//.test(b),d,"invalid-emulator-scheme");const e=!!(null==c?void 0:c.disableWarnings),f=nh(b),{host:g,port:h}=function(a){const b=nh(a),c=/(\/\/)?([^?#/]+)/.exec(a.substr(b.length));if(!c)return{host:"",port:null};const d=c[2].split("@").pop()||"",e=/^(\[[^\]]+\])(:|$)/.exec(d);if(e){const f=e[1];return{host:f,port:oh(d.substr(f.length+1))}}{const[g,h]=d.split(":");return{host:g,port:oh(h)}}}(b),i=null===h?"":`:${h}`;d.config.emulator={url:`${f}//${g}${i}/`},d.settings.appVerificationDisabledForTesting=!0,d.emulatorConfig=Object.freeze({host:g,port:h,protocol:f.replace(":",""),options:Object.freeze({disableWarnings:e})}),e||(function(){function a(){const a=document.createElement("p"),b=a.style;a.innerText="Running in emulator mode. Do not use with production credentials.",b.position="fixed",b.width="100%",b.backgroundColor="#ffffff",b.border=".1em solid #000000",b.color="#b50000",b.bottom="0px",b.left="0px",b.margin="0px",b.zIndex="10000",b.textAlign="center",a.classList.add("firebase-emulator-warning"),document.body.appendChild(a)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",a):a())})()}(this._delegate,Ru,Su)}applyActionCode(Tu){return Al(this._delegate,Tu)}checkActionCode(Uu){return Bl(this._delegate,Uu)}confirmPasswordReset(Vu,Wu){return zl(this._delegate,Vu,Wu)}async createUserWithEmailAndPassword(Xu,Yu){return bu(this._delegate,Dl(this._delegate,Xu,Yu))}fetchProvidersForEmail(Zu){return this.fetchSignInMethodsForEmail(Zu)}fetchSignInMethodsForEmail($u){return Hl(this._delegate,$u)}isSignInWithEmailLink(_u){return(function(a,b){const c=Ni.parseLink(b);return(null==c?void 0:c.operation)==="EMAIL_SIGNIN"})(this._delegate,_u)}async getRedirectResult(){Ku(Et(),this._delegate,"operation-not-supported-in-this-environment");const av=await $q(this._delegate,Nt);return av?bu(this._delegate,Promise.resolve(av)):{credential:null,user:null}}addFrameworkForLogging(bv){!function(a,b){kh(a)._logFramework(b)}(this._delegate,bv)}onAuthStateChanged(cv,dv,ev){const{next:fv,error:gv,complete:hv}=Lv(cv,dv,ev);return this._delegate.onAuthStateChanged(fv,gv,hv)}onIdTokenChanged(iv,jv,kv){const{next:lv,error:mv,complete:nv}=Lv(iv,jv,kv);return this._delegate.onIdTokenChanged(lv,mv,nv)}sendSignInLinkToEmail(ov,pv){return El(this._delegate,ov,pv)}sendPasswordResetEmail(qv,rv){return yl(this._delegate,qv,rv||void 0)}async setPersistence(sv){!function(a,b){if(It(Object.values(Ht).includes(b),a,"invalid-persistence-type"),F()){It(b!==Ht.SESSION,a,"unsupported-persistence-type");return}if(D()){It(b===Ht.NONE,a,"unsupported-persistence-type");return}if(Dt()){It(b===Ht.NONE||b===Ht.LOCAL&&H(),a,"unsupported-persistence-type");return}It(b===Ht.NONE||Ct(),a,"unsupported-persistence-type")}(this._delegate,sv);let tv;switch(sv){case Ht.SESSION:tv=Cn;break;case Ht.LOCAL:const uv=await ld(Zo)._isAvailable();tv=uv?Zo:wn;break;case Ht.NONE:tv=Ff;break;default:return cd("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(tv)}signInAndRetrieveDataWithCredential(vv){return this.signInWithCredential(vv)}signInAnonymously(){return bu(this._delegate,Tk(this._delegate))}signInWithCredential(wv){return bu(this._delegate,jl(this._delegate,wv))}signInWithCustomToken(xv){return bu(this._delegate,nl(this._delegate,xv))}signInWithEmailAndPassword(yv,zv){var Av,Bv,Cv;return bu(this._delegate,(Av=this._delegate,Bv=yv,Cv=zv,jl(xa(Av),aj.credential(Bv,Cv))))}signInWithEmailLink(Dv,Ev){return bu(this._delegate,Fl(this._delegate,Dv,Ev))}signInWithPhoneNumber(Fv,Gv){return cu(this._delegate,Bp(this._delegate,Fv,Gv))}async signInWithPopup(Hv){return Ku(Et(),this._delegate,"operation-not-supported-in-this-environment"),bu(this._delegate,vq(this._delegate,Hv,Nt))}async signInWithRedirect(Iv){return Ku(Et(),this._delegate,"operation-not-supported-in-this-environment"),await Kt(this._delegate),Xq(this._delegate,Iv,Nt)}updateCurrentUser(Jv){return this._delegate.updateCurrentUser(Jv)}verifyPasswordResetCode(Kv){return Cl(this._delegate,Kv)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}function Lv(a,b,c){let d=a;"function"!=typeof a&&({next:d,error:b,complete:c}=a);const e=d;return{next:a=>e(a&&hu.getOrCreate(a)),error:b,complete:c}}Lu.Persistence=Ht;class Mv{constructor(){this.providerId="phone",this._delegate=new Gp(_t(Uc.auth()))}static credential(Nv,Ov){return Gp.credential(Nv,Ov)}verifyPhoneNumber(Pv,Qv){return this._delegate.verifyPhoneNumber(Pv,Qv)}unwrap(){return this._delegate}}Mv.PHONE_SIGN_IN_METHOD=Gp.PHONE_SIGN_IN_METHOD,Mv.PROVIDER_ID=Gp.PROVIDER_ID,(nw=Uc).INTERNAL.registerComponent(new ya("auth-compat",a=>{const b=a.getProvider("app-compat").getImmediate(),c=a.getProvider("auth");return new Lu(b,c)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},EmailAuthProvider:aj,FacebookAuthProvider:Bj,GithubAuthProvider:Qj,GoogleAuthProvider:Hj,OAuthProvider:mj,SAMLAuthProvider:lk,PhoneAuthProvider:Mv,PhoneMultiFactorGenerator:ys,RecaptchaVerifier:class{constructor(Rv,Sv,Tv=Uc.app()){var Uv;hd(null===(Uv=Tv.options)|| void 0===Uv?void 0:Uv.apiKey,"invalid-api-key",{appName:Tv.name}),this._delegate=new class{constructor(Vv,Wv=Object.assign({},{theme:"light",type:"image"}),Xv){this.parameters=Wv,this.type=vp,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set(),this.renderPromise=null,this.recaptcha=null,this.auth=kh(Xv),this.isInvisible="invisible"===this.parameters.size,hd("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");const Yv="string"==typeof Vv?document.getElementById(Vv):Vv;hd(Yv,this.auth,"argument-error"),this.container=Yv,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new class{async load(Zv){return new bp(Zv)}clearedOneInstance(){}}():new class{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!fo().grecaptcha}load($v,_v=""){var aw;return(hd((aw=_v).length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(aw),$v,"argument-error"),this.shouldResolveImmediately(_v))?Promise.resolve(fo().grecaptcha):new Promise((a,b)=>{const c=fo().setTimeout(()=>{b(dd($v,"network-request-failed"))},up.get());fo()[tp]=()=>{fo().clearTimeout(c),delete fo()[tp];const d=fo().grecaptcha;if(!d){b(dd($v,"internal-error"));return}const e=d.render;d.render=(a,b)=>{const c=e(a,b);return this.counter++,c},this.hostLanguage=_v,a(d)};const d=`https://www.google.com/recaptcha/api.js??${ba({onload:tp,render:"explicit",hl:_v})}`;_o(d).catch(()=>{clearTimeout(c),b(dd($v,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(bw){return!!fo().grecaptcha&&(bw===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}(),this.validateStartingState()}async verify(){this.assertNotDestroyed();const cw=await this.render(),dw=this.getAssertedRecaptcha(),ew=dw.getResponse(cw);return ew||new Promise(a=>{const b=c=>{c&&(this.tokenChangeListeners.delete(b),a(c))};this.tokenChangeListeners.add(b),this.isInvisible&&dw.execute(cw)})}render(){try{this.assertNotDestroyed()}catch(fw){return Promise.reject(fw)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(a=>{throw this.renderPromise=null,a})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(a=>{this.container.removeChild(a)})}validateStartingState(){hd(!this.parameters.sitekey,this.auth,"argument-error"),hd(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),hd("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(gw){return a=>{if(this.tokenChangeListeners.forEach(b=>b(a)),"function"==typeof gw)gw(a);else if("string"==typeof gw){const b=fo()[gw];"function"==typeof b&&b(a)}}}assertNotDestroyed(){hd(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let hw=this.container;if(!this.isInvisible){const iw=document.createElement("div");hw.appendChild(iw),hw=iw}this.widgetId=this.getAssertedRecaptcha().render(hw,this.parameters)}return this.widgetId}async init(){let jw;hd(nd()&&!go(),this.auth,"internal-error"),await (jw=null,new Promise(a=>{if("complete"===document.readyState){a();return}jw=()=>a(),window.addEventListener("load",jw)}).catch(a=>{throw jw&&window.removeEventListener("load",jw),a})),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const kw=await $o(this.auth);hd(kw,this.auth,"internal-error"),this.parameters.sitekey=kw}getAssertedRecaptcha(){return hd(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}(Rv,Sv,Tv.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}},TwitterAuthProvider:vk,Auth:Lu,AuthCredential:ph,Error:I}).setInstantiationMode("LAZY").setMultipleInstances(!1)),nw.registerVersion("@firebase/auth-compat","0.2.6");var lw,mw,nw,ow,pw,qw="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==c.g?c.g:"undefined"!=typeof self?self:{},rw={},sw=sw||{},tw=qw||self;function uw(){}function vw(a){var b=typeof a;return"array"==(b="object"!=b?b:a?Array.isArray(a)?"array":b:"null")||"object"==b&&"number"==typeof a.length}function ww(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}function xw(a,b,c){return a.call.apply(a.bind,arguments)}function yw(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(c,d),a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function zw(a,b,c){return(zw=Function.prototype.bind&& -1!=Function.prototype.bind.toString().indexOf("native code")?xw:yw).apply(null,arguments)}function Aw(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();return b.push.apply(b,arguments),a.apply(this,b)}}function Bw(a,b){function c(){}c.prototype=b.prototype,a.Z=b.prototype,a.prototype=new c,a.prototype.constructor=a,a.Vb=function(a,c,d){for(var e=Array(arguments.length-2),f=2;f<arguments.length;f++)e[f-2]=arguments[f];return b.prototype[c].apply(a,e)}}function Cw(){this.s=this.s,this.o=this.o}Cw.prototype.s=!1,Cw.prototype.na=function(){this.s||(this.s=!0,this.M())},Cw.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Dw=Array.prototype.indexOf?function(a,b){return Array.prototype.indexOf.call(a,b,void 0)}:function(a,b){if("string"==typeof a)return"string"!=typeof b||1!=b.length?-1:a.indexOf(b,0);for(let c=0;c<a.length;c++)if(c in a&&a[c]===b)return c;return -1},Ew=Array.prototype.forEach?function(a,b,c){Array.prototype.forEach.call(a,b,c)}:function(a,b,c){const d=a.length,e="string"==typeof a?a.split(""):a;for(let f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)};function Fw(a){return Array.prototype.concat.apply([],arguments)}function Gw(a){const b=a.length;if(0<b){const c=Array(b);for(let d=0;d<b;d++)c[d]=a[d];return c}return[]}function Hw(a){return/^[\s\xa0]*$/.test(a)}var Iw=String.prototype.trim?function(a){return a.trim()}:function(a){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(a)[1]};function Jw(a,b){return -1!=a.indexOf(b)}function Kw(a,b){return a<b?-1:a>b?1:0}a:{var Lw=tw.navigator;if(Lw){var Mw=Lw.userAgent;if(Mw){g=Mw;break a}}g=""}function Nw(a,b,c){for(const d in a)b.call(c,a[d],d,a)}function Ow(a){const b={};for(const c in a)b[c]=a[c];return b}var Pw="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Qw(a,b){let c,d;for(let e=1;e<arguments.length;e++){for(c in d=arguments[e])a[c]=d[c];for(let f=0;f<Pw.length;f++)c=Pw[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}}function Rw(a){return Rw[" "](a),a}Rw[" "]=uw;var Sw=Jw(g,"Opera"),Tw=Jw(g,"Trident")||Jw(g,"MSIE"),Uw=Jw(g,"Edge"),Vw=Uw||Tw,Ww=Jw(g,"Gecko")&&!(Jw(g.toLowerCase(),"webkit")&&!Jw(g,"Edge"))&&!(Jw(g,"Trident")||Jw(g,"MSIE"))&&!Jw(g,"Edge"),Xw=Jw(g.toLowerCase(),"webkit")&&!Jw(g,"Edge");function Yw(){var a=tw.document;return a?a.documentMode:void 0}a:{var Zw,$w="",_w=(Zw=g,Ww?/rv:([^\);]+)(\)|;)/.exec(Zw):Uw?/Edge\/([\d\.]+)/.exec(Zw):Tw?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Zw):Xw?/WebKit\/(\S+)/.exec(Zw):Sw?/(?:Version)[ \/]?(\S+)/.exec(Zw):void 0);if(_w&&($w=_w?_w[1]:""),Tw){var ax=Yw();if(null!=ax&&ax>parseFloat($w)){h=String(ax);break a}}h=$w}var bx={},cx=tw.document&&Tw?Yw()||parseInt(h,10)||void 0:void 0,dx=function(){if(!tw.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},"passive",{get:function(){a=!0}});try{tw.addEventListener("test",uw,b),tw.removeEventListener("test",uw,b)}catch(c){}return a}();function ex(a,b){this.type=a,this.g=this.target=b,this.defaultPrevented=!1}function fx(a,b){if(ex.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var c=this.type=a.type,d=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=b,b=a.relatedTarget){if(Ww){a:{try{Rw(b.nodeName);var e=!0;break a}catch(f){}e=!1}e||(b=null)}}else"mouseover"==c?b=a.fromElement:"mouseout"==c&&(b=a.toElement);this.relatedTarget=b,d?(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0):(this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType="string"==typeof a.pointerType?a.pointerType:gx[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&fx.Z.h.call(this)}}ex.prototype.h=function(){this.defaultPrevented=!0},Bw(fx,ex);var gx={2:"touch",3:"pen",4:"mouse"};fx.prototype.h=function(){fx.Z.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var hx="closure_listenable_"+(10e5*Math.random()|0),ix=0;function jx(a,b,c,d,e){this.listener=a,this.proxy=null,this.src=b,this.type=c,this.capture=!!d,this.ia=e,this.key=++ix,this.ca=this.fa=!1}function kx(a){a.ca=!0,a.listener=null,a.proxy=null,a.src=null,a.ia=null}function lx(a){this.src=a,this.g={},this.h=0}function mx(a,b){var c=b.type;if(c in a.g){var d,e=a.g[c],f=Dw(e,b);(d=0<=f)&&Array.prototype.splice.call(e,f,1),d&&(kx(b),0==a.g[c].length&&(delete a.g[c],a.h--))}}function nx(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.ca&&f.listener==b&& !!c==f.capture&&f.ia==d)return e}return -1}lx.prototype.add=function(a,b,c,d,e){var f=a.toString();(a=this.g[f])||(a=this.g[f]=[],this.h++);var g=nx(a,b,d,e);return -1<g?(b=a[g],c||(b.fa=!1)):((b=new jx(b,this.src,f,!!d,e)).fa=c,a.push(b)),b};var ox="closure_lm_"+(10e5*Math.random()|0),px={};function qx(a,b,c,d,e){if(d&&d.once)return tx(a,b,c,d,e);if(Array.isArray(b)){for(var f=0;f<b.length;f++)qx(a,b[f],c,d,e);return null}return c=Ax(c),a&&a[hx]?a.N(b,c,ww(d)?!!d.capture:!!d,e):rx(a,b,c,!1,d,e)}function rx(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var g=ww(e)?!!e.capture:!!e,h=yx(a);if(h||(a[ox]=h=new lx(a)),(c=h.add(b,c,d,g,f)).proxy)return c;if(d=sx(),c.proxy=d,d.src=a,d.listener=c,a.addEventListener)dx||(e=g),void 0===e&&(e=!1),a.addEventListener(b.toString(),d,e);else if(a.attachEvent)a.attachEvent(wx(b.toString()),d);else if(a.addListener&&a.removeListener)a.addListener(d);else throw Error("addEventListener and attachEvent are unavailable.");return c}function sx(){function a(c){return b.call(a.src,a.listener,c)}var b=xx;return a}function tx(a,b,c,d,e){if(Array.isArray(b)){for(var f=0;f<b.length;f++)tx(a,b[f],c,d,e);return null}return c=Ax(c),a&&a[hx]?a.O(b,c,ww(d)?!!d.capture:!!d,e):rx(a,b,c,!0,d,e)}function ux(a,b,c,d,e){if(Array.isArray(b))for(var f=0;f<b.length;f++)ux(a,b[f],c,d,e);else(d=ww(d)?!!d.capture:!!d,c=Ax(c),a&&a[hx])?(a=a.i,(b=String(b).toString())in a.g&& -1<(c=nx(f=a.g[b],c,d,e))&&(kx(f[c]),Array.prototype.splice.call(f,c,1),0==f.length&&(delete a.g[b],a.h--))):a&&(a=yx(a))&&(b=a.g[b.toString()],a=-1,b&&(a=nx(b,c,d,e)),(c=-1<a?b[a]:null)&&vx(c))}function vx(a){if("number"!=typeof a&&a&&!a.ca){var b=a.src;if(b&&b[hx])mx(b.i,a);else{var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent?b.detachEvent(wx(c),d):b.addListener&&b.removeListener&&b.removeListener(d),(c=yx(b))?(mx(c,a),0==c.h&&(c.src=null,b[ox]=null)):kx(a)}}}function wx(a){return a in px?px[a]:px[a]="on"+a}function xx(a,b){if(a.ca)a=!0;else{b=new fx(b,this);var c=a.listener,d=a.ia||a.src;a.fa&&vx(a),a=c.call(d,b)}return a}function yx(a){return(a=a[ox])instanceof lx?a:null}var zx="__closure_events_fn_"+(10e8*Math.random()>>>0);function Ax(a){return"function"==typeof a?a:(a[zx]||(a[zx]=function(b){return a.handleEvent(b)}),a[zx])}function Bx(){Cw.call(this),this.i=new lx(this),this.P=this,this.I=null}function Cx(a,b){var c,d=a.I;if(d)for(c=[];d;d=d.I)c.push(d);if(a=a.P,d=b.type||b,"string"==typeof b)b=new ex(b,a);else if(b instanceof ex)b.target=b.target||a;else{var e=b;Qw(b=new ex(d,a),e)}if(e=!0,c)for(var f=c.length-1;0<=f;f--){var g=b.g=c[f];e=Dx(g,d,!0,b)&&e}if(e=Dx(g=b.g=a,d,!0,b)&&e,e=Dx(g,d,!1,b)&&e,c)for(f=0;f<c.length;f++)e=Dx(g=b.g=c[f],d,!1,b)&&e}function Dx(a,b,c,d){if(!(b=a.i.g[String(b)]))return!0;b=b.concat();for(var e=!0,f=0;f<b.length;++f){var g=b[f];if(g&&!g.ca&&g.capture==c){var h=g.listener,i=g.ia||g.src;g.fa&&mx(a.i,g),e=!1!==h.call(i,d)&&e}}return e&&!d.defaultPrevented}Bw(Bx,Cw),Bx.prototype[hx]=!0,Bx.prototype.removeEventListener=function(a,b,c,d){ux(this,a,b,c,d)},Bx.prototype.M=function(){if(Bx.Z.M.call(this),this.i){var a,b=this.i;for(a in b.g){for(var c=b.g[a],d=0;d<c.length;d++)kx(c[d]);delete b.g[a],b.h--}}this.I=null},Bx.prototype.N=function(a,b,c,d){return this.i.add(String(a),b,!1,c,d)},Bx.prototype.O=function(a,b,c,d){return this.i.add(String(a),b,!0,c,d)};var Ex=tw.JSON.stringify;function Fx(){var a=Rx;let b=null;return a.g&&(b=a.g,a.g=a.g.next,a.g||(a.h=null),b.next=null),b}var Gx=new class{constructor(Hx,Ix){this.i=Hx,this.j=Ix,this.h=0,this.g=null}get(){let Jx;return 0<this.h?(this.h--,Jx=this.g,this.g=Jx.next,Jx.next=null):Jx=this.i(),Jx}}(()=>new Kx,a=>a.reset());class Kx{constructor(){this.next=this.g=this.h=null}set(Lx,Mx){this.h=Lx,this.g=Mx,this.next=null}reset(){this.next=this.g=this.h=null}}function Nx(a){tw.setTimeout(()=>{throw a},0)}function Ox(a,b){i||Px(),Qx||(i(),Qx=!0),Rx.add(a,b)}function Px(){var a=tw.Promise.resolve(void 0);i=function(){a.then(Vx)}}var Qx=!1,Rx=new class{constructor(){this.h=this.g=null}add(Sx,Tx){const Ux=Gx.get();Ux.set(Sx,Tx),this.h?this.h.next=Ux:this.g=Ux,this.h=Ux}};function Vx(){for(var a;a=Fx();){try{a.h.call(a.g)}catch(b){Nx(b)}var c=Gx;c.j(a),100>c.h&&(c.h++,a.next=c.g,c.g=a)}Qx=!1}function Wx(a,b){Bx.call(this),this.h=a||1,this.g=b||tw,this.j=zw(this.kb,this),this.l=Date.now()}function Xx(a){a.da=!1,a.S&&(a.g.clearTimeout(a.S),a.S=null)}function Yx(a,b,c){if("function"==typeof a)c&&(a=zw(a,c));else if(a&&"function"==typeof a.handleEvent)a=zw(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(b)?-1:tw.setTimeout(a,b||0)}function Zx(a){a.g=Yx(()=>{a.g=null,a.i&&(a.i=!1,Zx(a))},a.j);const b=a.h;a.h=null,a.m.apply(null,b)}Bw(Wx,Bx),(pw=Wx.prototype).da=!1,pw.S=null,pw.kb=function(){if(this.da){var a=Date.now()-this.l;0<a&&a<0.8*this.h?this.S=this.g.setTimeout(this.j,this.h-a):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Cx(this,"tick"),this.da&&(Xx(this),this.start()))}},pw.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},pw.M=function(){Wx.Z.M.call(this),Xx(this),delete this.g};class $x extends Cw{constructor(_x,ay){super(),this.m=_x,this.j=ay,this.h=null,this.i=!1,this.g=null}l(by){this.h=arguments,this.g?this.i=!0:Zx(this)}M(){super.M(),this.g&&(tw.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function cy(a){Cw.call(this),this.h=a,this.g={}}Bw(cy,Cw);var dy=[];function ey(a,b,c,d){Array.isArray(c)||(c&&(dy[0]=c.toString()),c=dy);for(var e=0;e<c.length;e++){var f=qx(b,c[e],d||a.handleEvent,!1,a.h||a);if(!f)break;a.g[f.key]=f}}function fy(a){Nw(a.g,function(a,b){this.g.hasOwnProperty(b)&&vx(a)},a),a.g={}}function gy(){this.g=!0}function hy(a,b,c,d){a.info(function(){return"XMLHTTP TEXT ("+b+"): "+iy(a,c)+(d?" "+d:"")})}function iy(a,b){if(!a.g)return b;if(!b)return null;try{var c=JSON.parse(b);if(c){for(a=0;a<c.length;a++)if(Array.isArray(c[a])){var d=c[a];if(!(2>d.length)){var e=d[1];if(Array.isArray(e)&&!(1>e.length)){var f=e[0];if("noop"!=f&&"stop"!=f&&"close"!=f)for(var g=1;g<e.length;g++)e[g]=""}}}}return Ex(c)}catch(h){return b}}cy.prototype.M=function(){cy.Z.M.call(this),fy(this)},cy.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},gy.prototype.Aa=function(){this.g=!1},gy.prototype.info=function(){};var jy={},ky=null;function ly(){return ky=ky||new Bx}function my(a){ex.call(this,jy.Ma,a)}function ny(a){const b=ly();Cx(b,new my(b,a))}function oy(a,b){ex.call(this,jy.STAT_EVENT,a),this.stat=b}function py(a){const b=ly();Cx(b,new oy(b,a))}function qy(a,b){ex.call(this,jy.Na,a),this.size=b}function ry(a,b){if("function"!=typeof a)throw Error("Fn must not be null and must be a function");return tw.setTimeout(function(){a()},b)}jy.Ma="serverreachability",Bw(my,ex),jy.STAT_EVENT="statevent",Bw(oy,ex),jy.Na="timingevent",Bw(qy,ex);var sy={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},ty={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function uy(){}function vy(a){return a.h||(a.h=a.i())}function wy(){}uy.prototype.h=null;var xy={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function yy(){ex.call(this,"d")}function zy(){ex.call(this,"c")}function Ay(){}function By(a,b,c,d){this.l=a,this.j=b,this.m=c,this.X=d||1,this.V=new cy(this),this.P=Dy,a=Vw?125:void 0,this.W=new Wx(a),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new Cy}function Cy(){this.i=null,this.g="",this.h=!1}Bw(yy,ex),Bw(zy,ex),Bw(Ay,uy),Ay.prototype.g=function(){return new XMLHttpRequest},Ay.prototype.i=function(){return{}},j=new Ay;var Dy=45000,Ey={},Fy={};function Gy(a,b,c){a.K=1,a.v=bz(Xy(b)),a.s=c,a.U=!0,Hy(a,null)}function Hy(a,b){a.F=Date.now(),Ly(a),a.A=Xy(a.v);var c=a.A,d=a.X;Array.isArray(d)||(d=[String(d)]),oz(c.h,"t",d),a.C=0,c=a.l.H,a.h=new Cy,a.g=sA(a.l,c?b:null,!a.s),0<a.O&&(a.L=new $x(zw(a.Ia,a,a.g),a.O)),ey(a.V,a.g,"readystatechange",a.gb),b=a.H?Ow(a.H):{},a.s?(a.u||(a.u="POST"),b["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.s,b)):(a.u="GET",a.g.ea(a.A,a.u,null,b)),ny(1),(function(a,b,c,d,e,f){a.info(function(){if(a.g)if(f)for(var g="",h=f.split("&"),i=0;i<h.length;i++){var j=h[i].split("=");if(1<j.length){var k=j[0];j=j[1];var l=k.split("_");g=2<=l.length&&"type"==l[1]?g+(k+"="+j+"&"):g+(k+"=redacted&")}}else g=null;else g=f;return"XMLHTTP REQ ("+d+") [attempt "+e+"]: "+b+"\n"+c+"\n"+g})})(a.j,a.u,a.A,a.m,a.X,a.s)}function Iy(a){return!!a.g&&"GET"==a.u&&2!=a.K&&a.l.Ba}function Jy(a,b,c){let d=!0,e;for(;!a.I&&a.C<c.length;)if((e=Ky(a,c))==Fy){4==b&&(a.o=4,py(14),d=!1),hy(a.j,a.m,null,"[Incomplete Response]");break}else if(e==Ey){a.o=4,py(15),hy(a.j,a.m,c,"[Invalid Chunk]"),d=!1;break}else hy(a.j,a.m,e,null),Qy(a,e);Iy(a)&&e!=Fy&&e!=Ey&&(a.h.g="",a.C=0),4!=b||0!=c.length||a.h.h||(a.o=1,py(16),d=!1),a.i=a.i&&d,d?0<c.length&&!a.aa&&(a.aa=!0,(b=a.l).g==a&&b.$&&!b.L&&(b.h.info("Great, no buffering proxy detected. Bytes received: "+c.length),kA(b),b.L=!0,py(11))):(hy(a.j,a.m,c,"[Invalid Chunked Response]"),Py(a),Oy(a))}function Ky(a,b){var c=a.C,d=b.indexOf("\n",c);return -1==d?Fy:isNaN(c=Number(b.substring(c,d)))?Ey:(d+=1)+c>b.length?Fy:(b=b.substr(d,c),a.C=d+c,b)}function Ly(a){a.Y=Date.now()+a.P,My(a,a.P)}function My(a,b){if(null!=a.B)throw Error("WatchDog timer not null");a.B=ry(zw(a.eb,a),b)}function Ny(a){a.B&&(tw.clearTimeout(a.B),a.B=null)}function Oy(a){0==a.l.G||a.I||nA(a.l,a)}function Py(a){Ny(a);var b=a.L;b&&"function"==typeof b.na&&b.na(),a.L=null,Xx(a.W),fy(a.V),a.g&&(b=a.g,a.g=null,b.abort(),b.na())}function Qy(a,b){try{var c=a.l;if(0!=c.G&&(c.g==a||yz(c.i,a))){if(c.I=a.N,!a.J&&yz(c.i,a)&&3==c.G){try{var d=c.Ca.g.parse(b)}catch(e){d=null}if(Array.isArray(d)&&3==d.length){var f=d;if(0==f[0]){a:if(!c.u){if(c.g)if(c.g.F+3000<a.F)mA(c),bA(c);else break a;jA(c),py(18)}}else c.ta=f[1],0<c.ta-c.U&&37500>f[2]&&c.N&&0==c.A&&!c.v&&(c.v=ry(zw(c.ab,c),6000));if(1>=xz(c.i)&&c.ka){try{c.ka()}catch(g){}c.ka=void 0}}else pA(c,11)}else if((a.J||c.g==a)&&mA(c),!Hw(b))for(f=c.Ca.g.parse(b),b=0;b<f.length;b++){let h=f[b];if(c.U=h[0],h=h[1],2==c.G)if("c"==h[0]){c.J=h[1],c.la=h[2];const i=h[3];null!=i&&(c.ma=i,c.h.info("VER="+c.ma));const j=h[4];null!=j&&(c.za=j,c.h.info("SVER="+c.za));const k=h[5];null!=k&&"number"==typeof k&&0<k&&(d=1.5*k,c.K=d,c.h.info("backChannelRequestTimeoutMs_="+d)),d=c;const l=a.g;if(l){const m=l.g?l.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(m){var n=d.i;!n.g&&(Jw(m,"spdy")||Jw(m,"quic")||Jw(m,"h2"))&&(n.j=n.l,n.g=new Set,n.h&&(zz(n,n.h),n.h=null))}if(d.D){const o=l.g?l.g.getResponseHeader("X-HTTP-Session-Id"):null;o&&(d.sa=o,az(d.F,d.D,o))}}c.G=3,c.j&&c.j.xa(),c.$&&(c.O=Date.now()-a.F,c.h.info("Handshake RTT: "+c.O+"ms")),d=c;var p=a;if(d.oa=rA(d,d.H?d.la:null,d.W),p.J){Az(d.i,p);var q=p,r=d.K;r&&q.setTimeout(r),q.B&&(Ny(q),Ly(q)),d.g=p}else iA(d);0<c.l.length&&eA(c)}else"stop"!=h[0]&&"close"!=h[0]||pA(c,7);else 3==c.G&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?pA(c,7):aA(c):"noop"!=h[0]&&c.j&&c.j.wa(h),c.A=0)}}ny(4)}catch(s){}}function Ry(a,b){if(a.forEach&&"function"==typeof a.forEach)a.forEach(b,void 0);else if(vw(a)||"string"==typeof a)Ew(a,b,void 0);else{if(a.T&&"function"==typeof a.T)var c=a.T();else if(a.R&&"function"==typeof a.R)c=void 0;else if(vw(a)||"string"==typeof a){c=[];for(var d=a.length,e=0;e<d;e++)c.push(e)}else for(e in c=[],d=0,a)c[d++]=e;e=(d=(function(a){if(a.R&&"function"==typeof a.R)return a.R();if("string"==typeof a)return a.split("");if(vw(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}for(d in b=[],c=0,a)b[c++]=a[d];return b})(a)).length;for(var f=0;f<e;f++)b.call(void 0,d[f],c&&c[f],a)}}function Sy(a,b){this.h={},this.g=[],this.i=0;var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else if(a)if(a instanceof Sy)for(c=a.T(),d=0;d<c.length;d++)this.set(c[d],a.get(c[d]));else for(d in a)this.set(d,a[d])}function Ty(a){if(a.i!=a.g.length){for(var b=0,c=0;b<a.g.length;){var d=a.g[b];Uy(a.h,d)&&(a.g[c++]=d),b++}a.g.length=c}if(a.i!=a.g.length){var e={};for(c=b=0;b<a.g.length;)Uy(e,d=a.g[b])||(a.g[c++]=d,e[d]=1),b++;a.g.length=c}}function Uy(a,b){return Object.prototype.hasOwnProperty.call(a,b)}(pw=By.prototype).setTimeout=function(a){this.P=a},pw.gb=function(a){a=a.target;const b=this.L;b&&3==Xz(a)?b.l():this.Ia(a)},pw.Ia=function(a){try{if(a==this.g)a:{const b=Xz(this.g);var c=this.g.Da();const d=this.g.ba();if(!(3>b)&&(3!=b||Vw||this.g&&(this.h.h||this.g.ga()||Yz(this.g)))){this.I||4!=b||7==c||(8==c||0>=d?ny(3):ny(2)),Ny(this);var e=this.g.ba();this.N=e;b:if(Iy(this)){var f=Yz(this.g);a="";var g=f.length,h=4==Xz(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Py(this),Oy(this);var i="";break b}this.h.i=new tw.TextDecoder}for(c=0;c<g;c++)this.h.h=!0,a+=this.h.i.decode(f[c],{stream:h&&c==g-1});f.splice(0,g),this.h.g+=a,this.C=0,i=this.h.g}else i=this.g.ga();if(this.i=200==e,(function(a,b,c,d,e,f,g){a.info(function(){return"XMLHTTP RESP ("+d+") [ attempt "+e+"]: "+b+"\n"+c+"\n"+f+" "+g})})(this.j,this.u,this.A,this.m,this.X,b,e),this.i){if(this.$&&!this.J){b:{if(this.g){var j,k=this.g;if((j=k.g?k.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Hw(j)){var l=j;break b}}l=null}if(e=l)hy(this.j,this.m,e,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Qy(this,e);else{this.i=!1,this.o=3,py(12),Py(this),Oy(this);break a}}this.U?(Jy(this,b,i),Vw&&this.i&&3==b&&(ey(this.V,this.W,"tick",this.fb),this.W.start())):(hy(this.j,this.m,i,null),Qy(this,i)),4==b&&Py(this),this.i&&!this.I&&(4==b?nA(this.l,this):(this.i=!1,Ly(this)))}else 400==e&&0<i.indexOf("Unknown SID")?(this.o=3,py(12)):(this.o=0,py(13)),Py(this),Oy(this)}}}catch(m){}finally{}},pw.fb=function(){if(this.g){var a=Xz(this.g),b=this.g.ga();this.C<b.length&&(Ny(this),Jy(this,a,b),this.i&&4!=a&&Ly(this))}},pw.cancel=function(){this.I=!0,Py(this)},pw.eb=function(){this.B=null;const a=Date.now();0<=a-this.Y?((function(a,b){a.info(function(){return"TIMEOUT: "+b})})(this.j,this.A),2!=this.K&&(ny(3),py(17)),Py(this),this.o=2,Oy(this)):My(this,this.Y-a)},(pw=Sy.prototype).R=function(){Ty(this);for(var a=[],b=0;b<this.g.length;b++)a.push(this.h[this.g[b]]);return a},pw.T=function(){return Ty(this),this.g.concat()},pw.get=function(a,b){return Uy(this.h,a)?this.h[a]:b},pw.set=function(a,b){Uy(this.h,a)||(this.i++,this.g.push(a)),this.h[a]=b},pw.forEach=function(a,b){for(var c=this.T(),d=0;d<c.length;d++){var e=c[d],f=this.get(e);a.call(b,f,e,this)}};var Vy=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Wy(a,b){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,a instanceof Wy){this.g=void 0!==b?b:a.g,Yy(this,a.j),this.s=a.s,Zy(this,a.i),$y(this,a.m),this.l=a.l,b=a.h;var c=new kz;c.i=b.i,b.g&&(c.g=new Sy(b.g),c.h=b.h),_y(this,c),this.o=a.o}else a&&(c=String(a).match(Vy))?(this.g=!!b,Yy(this,c[1]||"",!0),this.s=cz(c[2]||""),Zy(this,c[3]||"",!0),$y(this,c[4]),this.l=cz(c[5]||"",!0),_y(this,c[6]||"",!0),this.o=cz(c[7]||"")):(this.g=!!b,this.h=new kz(null,this.g))}function Xy(a){return new Wy(a)}function Yy(a,b,c){a.j=c?cz(b,!0):b,a.j&&(a.j=a.j.replace(/:$/,""))}function Zy(a,b,c){a.i=c?cz(b,!0):b}function $y(a,b){if(b){if(isNaN(b=Number(b))||0>b)throw Error("Bad port number "+b);a.m=b}else a.m=null}function _y(a,b,c){b instanceof kz?(a.h=b,qz(a.h,a.g)):(c||(b=dz(b,iz)),a.h=new kz(b,a.g))}function az(a,b,c){a.h.set(b,c)}function bz(a){return az(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function cz(a,b){return a?b?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function dz(a,b,c){return"string"==typeof a?(a=encodeURI(a).replace(b,ez),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function ez(a){return"%"+((a=a.charCodeAt(0))>>4&15).toString(16)+(15&a).toString(16)}Wy.prototype.toString=function(){var a=[],b=this.j;b&&a.push(dz(b,fz,!0),":");var c=this.i;return(c||"file"==b)&&(a.push("//"),(b=this.s)&&a.push(dz(b,fz,!0),"@"),a.push(encodeURIComponent(String(c)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(c=this.m)&&a.push(":",String(c))),(c=this.l)&&(this.i&&"/"!=c.charAt(0)&&a.push("/"),a.push(dz(c,"/"==c.charAt(0)?hz:gz,!0))),(c=this.h.toString())&&a.push("?",c),(c=this.o)&&a.push("#",dz(c,jz)),a.join("")};var fz=/[#\/\?@]/g,gz=/[#\?:]/g,hz=/[#\?]/g,iz=/[#\?@]/g,jz=/#/g;function kz(a,b){this.h=this.g=null,this.i=a||null,this.j=!!b}function lz(a){a.g||(a.g=new Sy,a.h=0,a.i&&(function(a,b){if(a){a=a.split("&");for(var c=0;c<a.length;c++){var d=a[c].indexOf("="),e=null;if(0<=d){var f=a[c].substring(0,d);e=a[c].substring(d+1)}else f=a[c];b(f,e?decodeURIComponent(e.replace(/\+/g," ")):"")}}})(a.i,function(b,c){a.add(decodeURIComponent(b.replace(/\+/g," ")),c)}))}function mz(a,b){lz(a),b=pz(a,b),Uy(a.g.h,b)&&(a.i=null,a.h-=a.g.get(b).length,Uy((a=a.g).h,b)&&(delete a.h[b],a.i--,a.g.length>2*a.i&&Ty(a)))}function nz(a,b){return lz(a),b=pz(a,b),Uy(a.g.h,b)}function oz(a,b,c){mz(a,b),0<c.length&&(a.i=null,a.g.set(pz(a,b),Gw(c)),a.h+=c.length)}function pz(a,b){return b=String(b),a.j&&(b=b.toLowerCase()),b}function qz(a,b){b&&!a.j&&(lz(a),a.i=null,a.g.forEach(function(a,b){var c=b.toLowerCase();b!=c&&(mz(this,b),oz(this,c,a))},a)),a.j=b}(pw=kz.prototype).add=function(a,b){lz(this),this.i=null,a=pz(this,a);var c=this.g.get(a);return c||this.g.set(a,c=[]),c.push(b),this.h+=1,this},pw.forEach=function(a,b){lz(this),this.g.forEach(function(c,d){Ew(c,function(c){a.call(b,c,d,this)},this)},this)},pw.T=function(){lz(this);for(var a=this.g.R(),b=this.g.T(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c},pw.R=function(a){lz(this);var b=[];if("string"==typeof a)nz(this,a)&&(b=Fw(b,this.g.get(pz(this,a))));else{a=this.g.R();for(var c=0;c<a.length;c++)b=Fw(b,a[c])}return b},pw.set=function(a,b){return lz(this),this.i=null,nz(this,a=pz(this,a))&&(this.h-=this.g.get(a).length),this.g.set(a,[b]),this.h+=1,this},pw.get=function(a,b){return a&&0<(a=this.R(a)).length?String(a[0]):b},pw.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var a=[],b=this.g.T(),c=0;c<b.length;c++){var d=b[c],e=encodeURIComponent(String(d));d=this.R(d);for(var f=0;f<d.length;f++){var g=e;""!==d[f]&&(g+="="+encodeURIComponent(String(d[f]))),a.push(g)}}return this.i=a.join("&")};var rz=class{constructor(sz,tz){this.h=sz,this.g=tz}};function uz(a){this.l=a||vz,a=tw.PerformanceNavigationTiming?0<(a=tw.performance.getEntriesByType("navigation")).length&&("hq"==a[0].nextHopProtocol||"h2"==a[0].nextHopProtocol):!!(tw.g&&tw.g.Ea&&tw.g.Ea()&&tw.g.Ea().Zb),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var vz=10;function wz(a){return!!a.h|| !!a.g&&a.g.size>=a.j}function xz(a){return a.h?1:a.g?a.g.size:0}function yz(a,b){return a.h?a.h==b:!!a.g&&a.g.has(b)}function zz(a,b){a.g?a.g.add(b):a.h=b}function Az(a,b){a.h&&a.h==b?a.h=null:a.g&&a.g.has(b)&&a.g.delete(b)}function Bz(a){if(null!=a.h)return a.i.concat(a.h.D);if(null!=a.g&&0!==a.g.size){let b=a.i;for(const c of a.g.values())b=b.concat(c.D);return b}return Gw(a.i)}function Cz(){}function Dz(){this.g=new Cz}function Ez(a,b,c){const d=c||"";try{Ry(a,function(a,c){let e=a;ww(a)&&(e=Ex(a)),b.push(d+c+"="+encodeURIComponent(e))})}catch(e){throw b.push(d+"type="+encodeURIComponent("_badmap")),e}}function Fz(a,b,c,d,e){try{b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null,e(d)}catch(f){}}function Gz(a){this.l=a.$b||null,this.j=a.ib||!1}function Hz(a,b){Bx.call(this),this.D=a,this.u=b,this.m=void 0,this.readyState=Iz,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}uz.prototype.cancel=function(){if(this.i=Bz(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const a of this.g.values())a.cancel();this.g.clear()}},Cz.prototype.stringify=function(a){return tw.JSON.stringify(a,void 0)},Cz.prototype.parse=function(a){return tw.JSON.parse(a,void 0)},Bw(Gz,uy),Gz.prototype.g=function(){return new Hz(this.l,this.j)},d={},Gz.prototype.i=function(){return d},Bw(Hz,Bx);var Iz=0;function Jz(a){a.j.read().then(a.Sa.bind(a)).catch(a.ha.bind(a))}function Kz(a){a.readyState=4,a.l=null,a.j=null,a.A=null,Lz(a)}function Lz(a){a.onreadystatechange&&a.onreadystatechange.call(a)}(pw=Hz.prototype).open=function(a,b){if(this.readyState!=Iz)throw this.abort(),Error("Error reopening a connection");this.C=a,this.B=b,this.readyState=1,Lz(this)},pw.send=function(a){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const b={headers:this.v,method:this.C,credentials:this.m,cache:void 0};a&&(b.body=a),(this.D||tw).fetch(new Request(this.B,b)).then(this.Va.bind(this),this.ha.bind(this))},pw.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Kz(this)),this.readyState=Iz},pw.Va=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Lz(this)),this.g&&(this.readyState=3,Lz(this),this.g)))if("arraybuffer"===this.responseType)a.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==tw.ReadableStream&&"body"in a){if(this.j=a.body.getReader(),this.u){if(this.responseType)throw Error("responseType must be empty for \"streamBinaryChunks\" mode responses.");this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Jz(this)}else a.text().then(this.Ua.bind(this),this.ha.bind(this))},pw.Sa=function(a){if(this.g){if(this.u&&a.value)this.response.push(a.value);else if(!this.u){var b=a.value?a.value:new Uint8Array(0);(b=this.A.decode(b,{stream:!a.done}))&&(this.response=this.responseText+=b)}a.done?Kz(this):Lz(this),3==this.readyState&&Jz(this)}},pw.Ua=function(a){this.g&&(this.response=this.responseText=a,Kz(this))},pw.Ta=function(a){this.g&&(this.response=a,Kz(this))},pw.ha=function(){this.g&&Kz(this)},pw.setRequestHeader=function(a,b){this.v.append(a,b)},pw.getResponseHeader=function(a){return this.h?this.h.get(a.toLowerCase())||"":""},pw.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],b=this.h.entries();for(var c=b.next();!c.done;)c=c.value,a.push(c[0]+": "+c[1]),c=b.next();return a.join("\r\n")},Object.defineProperty(Hz.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(a){this.m=a?"include":"same-origin"}});var Mz=tw.JSON.parse;function Nz(a){Bx.call(this),this.headers=new Sy,this.u=a||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Oz,this.K=this.L=!1}Bw(Nz,Bx);var Oz="",Pz=/^https?$/i,Qz=["POST","PUT"];function Rz(a){return"content-type"==a.toLowerCase()}function Sz(a,b){a.h=!1,a.g&&(a.l=!0,a.g.abort(),a.l=!1),a.j=b,a.m=5,Tz(a),Vz(a)}function Tz(a){a.D||(a.D=!0,Cx(a,"complete"),Cx(a,"error"))}function Uz(a){if(a.h&& void 0!==sw&&(!a.C[1]||4!=Xz(a)||2!=a.ba())){if(a.v&&4==Xz(a))Yx(a.Fa,0,a);else if(Cx(a,"readystatechange"),4==Xz(a)){a.h=!1;try{const b=a.ba();a:switch(b){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c,d,e=!0;break a;default:e=!1}if(!(c=e)){if(d=0===b){var f=String(a.H).match(Vy)[1]||null;if(!f&&tw.self&&tw.self.location){var g=tw.self.location.protocol;f=g.substr(0,g.length-1)}d=!Pz.test(f?f.toLowerCase():"")}c=d}if(c)Cx(a,"complete"),Cx(a,"success");else{a.m=6;try{var h=2<Xz(a)?a.g.statusText:""}catch(i){h=""}a.j=h+" ["+a.ba()+"]",Tz(a)}}finally{Vz(a)}}}}function Vz(a,b){if(a.g){Wz(a);const c=a.g,d=a.C[0]?uw:null;a.g=null,a.C=null,b||Cx(a,"ready");try{c.onreadystatechange=d}catch(e){}}}function Wz(a){a.g&&a.K&&(a.g.ontimeout=null),a.A&&(tw.clearTimeout(a.A),a.A=null)}function Xz(a){return a.g?a.g.readyState:0}function Yz(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.J){case Oz:case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch(b){return null}}function Zz(a,b,c){a:{for(d in c){var d=!1;break a}d=!0}let e;d||(e="",Nw(c,function(a,b){e+=b,e+=":",e+=a,e+="\r\n"}),c=e,"string"==typeof a?null!=c&&encodeURIComponent(String(c)):az(a,b,c))}function $z(a,b,c){return c&&c.internalChannelParams?c.internalChannelParams[a]||b:b}function _z(a){this.za=0,this.l=[],this.h=new gy,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=$z("failFast",!1,a),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=$z("baseRetryDelayMs",5000,a),this.$a=$z("retryDelaySeedMs",10e3,a),this.Ya=$z("forwardChannelMaxRetries",2,a),this.ra=$z("forwardChannelRequestTimeoutMs",20e3,a),this.qa=a&&a.xmlHttpFactory||void 0,this.Ba=a&&a.Yb||!1,this.K=void 0,this.H=a&&a.supportsCrossDomainXhr||!1,this.J="",this.i=new uz(a&&a.concurrentRequestLimit),this.Ca=new Dz,this.ja=a&&a.fastHandshake||!1,this.Ra=a&&a.Wb||!1,a&&a.Aa&&this.h.Aa(),a&&a.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&a&&a.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!a|| !1!==a.Xb}function aA(a){if(cA(a),3==a.G){var b=a.V++,c=Xy(a.F);az(c,"SID",a.J),az(c,"RID",b),az(c,"TYPE","terminate"),gA(a,c),(b=new By(a,a.h,b,void 0)).K=2,b.v=bz(Xy(c)),c=!1,tw.navigator&&tw.navigator.sendBeacon&&(c=tw.navigator.sendBeacon(b.v.toString(),"")),!c&&tw.Image&&((new Image).src=b.v,c=!0),c||(b.g=sA(b.l,null),b.g.ea(b.v)),b.F=Date.now(),Ly(b)}qA(a)}function bA(a){a.g&&(kA(a),a.g.cancel(),a.g=null)}function cA(a){bA(a),a.u&&(tw.clearTimeout(a.u),a.u=null),mA(a),a.i.cancel(),a.m&&("number"==typeof a.m&&tw.clearTimeout(a.m),a.m=null)}function dA(a,b){a.l.push(new rz(a.Za++,b)),3==a.G&&eA(a)}function eA(a){wz(a.i)||a.m||(a.m=!0,Ox(a.Ha,a),a.C=0)}function fA(a,b){var c;c=b?b.m:a.V++;const d=Xy(a.F);az(d,"SID",a.J),az(d,"RID",c),az(d,"AID",a.U),gA(a,d),a.o&&a.s&&Zz(d,a.o,a.s),c=new By(a,a.h,c,a.C+1),null===a.o&&(c.H=a.s),b&&(a.l=b.D.concat(a.l)),b=hA(a,c,1000),c.setTimeout(Math.round(0.5*a.ra)+Math.round(0.5*a.ra*Math.random())),zz(a.i,c),Gy(c,d,b)}function gA(a,b){a.j&&Ry({},function(a,c){az(b,c,a)})}function hA(a,b,c){c=Math.min(a.l.length,c);var d=a.j?zw(a.j.Oa,a.j,a):null;a:{var e=a.l;let f=-1;for(;;){const g=["count="+c];-1==f?0<c?(f=e[0].h,g.push("ofs="+f)):f=0:g.push("ofs="+f);let h=!0;for(let i=0;i<c;i++){let j=e[i].h;const k=e[i].g;if(0>(j-=f))f=Math.max(0,e[i].h-100),h=!1;else try{Ez(k,g,"req"+j+"_")}catch(l){d&&d(k)}}if(h){d=g.join("&");break a}}}return a=a.l.splice(0,c),b.D=a,d}function iA(a){a.g||a.u||(a.Y=1,Ox(a.Ga,a),a.A=0)}function jA(a){return!a.g&&!a.u&&!(3<=a.A)&&(a.Y++,a.u=ry(zw(a.Ga,a),oA(a,a.A)),a.A++,!0)}function kA(a){null!=a.B&&(tw.clearTimeout(a.B),a.B=null)}function lA(a){a.g=new By(a,a.h,"rpc",a.Y),null===a.o&&(a.g.H=a.s),a.g.O=0;var b=Xy(a.oa);az(b,"RID","rpc"),az(b,"SID",a.J),az(b,"CI",a.N?"0":"1"),az(b,"AID",a.U),gA(a,b),az(b,"TYPE","xmlhttp"),a.o&&a.s&&Zz(b,a.o,a.s),a.K&&a.g.setTimeout(a.K);var c=a.g;a=a.la,c.K=1,c.v=bz(Xy(b)),c.s=null,c.U=!0,Hy(c,a)}function mA(a){null!=a.v&&(tw.clearTimeout(a.v),a.v=null)}function nA(a,b){var c,d,e=null;if(a.g==b){mA(a),kA(a),a.g=null;var f=2}else{if(!yz(a.i,b))return;e=b.D,Az(a.i,b),f=1}if(a.I=b.N,0!=a.G){if(b.i)if(1==f){e=b.s?b.s.length:0,b=Date.now()-b.F;var g=a.C;Cx(f=ly(),new qy(f,e,b,g)),eA(a)}else iA(a);else if(3==(g=b.o)||0==g&&0<a.I||!(1==f&&(c=a,d=b,!(xz(c.i)>=c.i.j-(c.m?1:0))&&(c.m?(c.l=d.D.concat(c.l),!0):1!=c.G&&2!=c.G&&!(c.C>=(c.Xa?0:c.Ya))&&(c.m=ry(zw(c.Ha,c,d),oA(c,c.C)),c.C++,!0)))||2==f&&jA(a)))switch(e&&0<e.length&&((b=a.i).i=b.i.concat(e)),g){case 1:pA(a,5);break;case 4:pA(a,10);break;case 3:pA(a,6);break;default:pA(a,2)}}}function oA(a,b){let c=a.Pa+Math.floor(Math.random()*a.$a);return a.j||(c*=2),c*b}function pA(a,b){if(a.h.info("Error code "+b),2==b){var c=null;a.j&&(c=null);var d=zw(a.jb,a);c||(c=new Wy("//www.google.com/images/cleardot.gif"),tw.location&&"http"==tw.location.protocol||Yy(c,"https"),bz(c)),(function(a,b){const c=new gy;if(tw.Image){const d=new Image;d.onload=Aw(Fz,c,d,"TestLoadImage: loaded",!0,b),d.onerror=Aw(Fz,c,d,"TestLoadImage: error",!1,b),d.onabort=Aw(Fz,c,d,"TestLoadImage: abort",!1,b),d.ontimeout=Aw(Fz,c,d,"TestLoadImage: timeout",!1,b),tw.setTimeout(function(){d.ontimeout&&d.ontimeout()},10e3),d.src=a}else b(!1)})(c.toString(),d)}else py(2);a.G=0,a.j&&a.j.va(b),qA(a),cA(a)}function qA(a){a.G=0,a.I=-1,a.j&&((0!=Bz(a.i).length||0!=a.l.length)&&(a.i.i.length=0,Gw(a.l),a.l.length=0),a.j.ua())}function rA(a,b,c){var d,e,f,g,h,i;let j=(d=c)instanceof Wy?Xy(d):new Wy(d,void 0);if(""!=j.i)b&&Zy(j,b+"."+j.i),$y(j,j.m);else{const k=tw.location;j=(e=k.protocol,f=b?b+"."+k.hostname:k.hostname,g=+k.port,h=c,i=new Wy(null,void 0),e&&Yy(i,e),f&&Zy(i,f),g&&$y(i,g),h&&(i.l=h),i)}return a.aa&&Nw(a.aa,function(a,b){az(j,b,a)}),b=a.D,c=a.sa,b&&c&&az(j,b,c),az(j,"VER",a.ma),gA(a,j),j}function sA(a,b,c){if(b&&!a.H)throw Error("Can't create secondary domain capable XhrIo object.");return(b=new Nz(c&&a.Ba&&!a.qa?new Gz({ib:!0}):a.qa)).L=a.H,b}function tA(){}function uA(){if(Tw&&!(10<=Number(cx)))throw Error("Environmental error: no available transport.")}function vA(a,b){Bx.call(this),this.g=new _z(b),this.l=a,this.h=b&&b.messageUrlParams||null,a=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.s=a,a=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(a?a["X-WebChannel-Content-Type"]=b.messageContentType:a={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.ya&&(a?a["X-WebChannel-Client-Profile"]=b.ya:a={"X-WebChannel-Client-Profile":b.ya}),this.g.P=a,(a=b&&b.httpHeadersOverwriteParam)&&!Hw(a)&&(this.g.o=a),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!Hw(b)&&(this.g.D=b,null!==(a=this.h)&&b in a&&b in(a=this.h)&&delete a[b]),this.j=new yA(this)}function wA(a){yy.call(this);var b=a.__sm__;if(b){a:{for(const c in b){a=c;break a}a=void 0}(this.i=a)&&(a=this.i,b=null!==b&&a in b?b[a]:void 0),this.data=b}else this.data=a}function xA(){zy.call(this),this.status=1}function yA(a){this.g=a}(pw=Nz.prototype).ea=function(a,b,c,d){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+a);b=b?b.toUpperCase():"GET",this.H=a,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():j.g(),this.C=this.u?vy(this.u):vy(j),this.g.onreadystatechange=zw(this.Fa,this);try{this.F=!0,this.g.open(b,String(a),!0),this.F=!1}catch(e){Sz(this,e);return}a=c||"";const f=new Sy(this.headers);d&&Ry(d,function(a,b){f.set(b,a)}),d=(function(a){a:{var b=Rz;const c=a.length,d="string"==typeof a?a.split(""):a;for(let e=0;e<c;e++)if(e in d&&b.call(void 0,d[e],e,a)){b=e;break a}b=-1}return 0>b?null:"string"==typeof a?a.charAt(b):a[b]})(f.T()),c=tw.FormData&&a instanceof tw.FormData,!(0<=Dw(Qz,b))||d||c||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),f.forEach(function(a,b){this.g.setRequestHeader(b,a)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{var g;Wz(this),0<this.B&&((this.K=(g=this.g,Tw&&(function(a){var b=bx;return Object.prototype.hasOwnProperty.call(b,9)?b[9]:b[9]=a(9)})(function(){let a=0;const b=Iw(String(h)).split("."),c=Iw("9").split("."),d=Math.max(b.length,c.length);for(let e=0;0==a&&e<d;e++){var f=b[e]||"",g=c[e]||"";do{if(f=/(\d*)(\D*)(.*)/.exec(f)||["","","",""],g=/(\d*)(\D*)(.*)/.exec(g)||["","","",""],0==f[0].length&&0==g[0].length)break;a=Kw(0==f[1].length?0:parseInt(f[1],10),0==g[1].length?0:parseInt(g[1],10))||Kw(0==f[2].length,0==g[2].length)||Kw(f[2],g[2]),f=f[3],g=g[3]}while(0==a)}return 0<=a})&&"number"==typeof g.timeout&& void 0!==g.ontimeout))?(this.g.timeout=this.B,this.g.ontimeout=zw(this.pa,this)):this.A=Yx(this.pa,this.B,this)),this.v=!0,this.g.send(a),this.v=!1}catch(i){Sz(this,i)}},pw.pa=function(){void 0!==sw&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Cx(this,"timeout"),this.abort(8))},pw.abort=function(a){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=a||7,Cx(this,"complete"),Cx(this,"abort"),Vz(this))},pw.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Vz(this,!0)),Nz.Z.M.call(this)},pw.Fa=function(){this.s||(this.F||this.v||this.l?Uz(this):this.cb())},pw.cb=function(){Uz(this)},pw.ba=function(){try{return 2<Xz(this)?this.g.status:-1}catch(a){return -1}},pw.ga=function(){try{return this.g?this.g.responseText:""}catch(a){return""}},pw.Qa=function(a){if(this.g){var b=this.g.responseText;return a&&0==b.indexOf(a)&&(b=b.substring(a.length)),Mz(b)}},pw.Da=function(){return this.m},pw.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(pw=_z.prototype).ma=8,pw.G=1,pw.hb=function(a){try{this.h.info("Origin Trials invoked: "+a)}catch(b){}},pw.Ha=function(a){if(this.m)if(this.m=null,1==this.G){if(!a){this.V=Math.floor(10e4*Math.random()),a=this.V++;const b=new By(this,this.h,a,void 0);let c=this.s;if(this.P&&(c?Qw(c=Ow(c),this.P):c=this.P),null===this.o&&(b.H=c),this.ja)a:{for(var d=0,e=0;e<this.l.length;e++){b:{var f=this.l[e];if("__data__"in f.g&&"string"==typeof(f=f.g.__data__)){f=f.length;break b}f=void 0}if(void 0===f)break;if(4096<(d+=f)){d=e;break a}if(4096===d||e===this.l.length-1){d=e+1;break a}}d=1000}else d=1000;d=hA(this,b,d),az(e=Xy(this.F),"RID",a),az(e,"CVER",22),this.D&&az(e,"X-HTTP-Session-Id",this.D),gA(this,e),this.o&&c&&Zz(e,this.o,c),zz(this.i,b),this.Ra&&az(e,"TYPE","init"),this.ja?(az(e,"$req",d),az(e,"SID","null"),b.$=!0,Gy(b,e,null)):Gy(b,e,d),this.G=2}}else 3==this.G&&(a?fA(this,a):0==this.l.length||wz(this.i)||fA(this))},pw.Ga=function(){if(this.u=null,lA(this),this.$&&!(this.L||null==this.g||0>=this.O)){var a=2*this.O;this.h.info("BP detection timer enabled: "+a),this.B=ry(zw(this.bb,this),a)}},pw.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,py(10),bA(this),lA(this))},pw.ab=function(){null!=this.v&&(this.v=null,bA(this),jA(this),py(19))},pw.jb=function(a){a?(this.h.info("Successfully pinged google.com"),py(2)):(this.h.info("Failed to ping google.com"),py(1))},(pw=tA.prototype).xa=function(){},pw.wa=function(){},pw.va=function(){},pw.ua=function(){},pw.Oa=function(){},uA.prototype.g=function(a,b){return new vA(a,b)},Bw(vA,Bx),vA.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var a=this.g,b=this.l,c=this.h||void 0;a.Wa&&(a.h.info("Origin Trials enabled."),Ox(zw(a.hb,a,b))),py(0),a.W=b,a.aa=c||{},a.N=a.X,a.F=rA(a,null,a.W),eA(a)},vA.prototype.close=function(){aA(this.g)},vA.prototype.u=function(a){if("string"==typeof a){var b={};b.__data__=a,dA(this.g,b)}else this.v?((b={}).__data__=Ex(a),dA(this.g,b)):dA(this.g,a)},vA.prototype.M=function(){this.g.j=null,delete this.j,aA(this.g),delete this.g,vA.Z.M.call(this)},Bw(wA,yy),Bw(xA,zy),Bw(yA,tA),yA.prototype.xa=function(){Cx(this.g,"a")},yA.prototype.wa=function(a){Cx(this.g,new wA(a))},yA.prototype.va=function(a){Cx(this.g,new xA(a))},yA.prototype.ua=function(){Cx(this.g,"b")},uA.prototype.createWebChannel=uA.prototype.g,vA.prototype.send=vA.prototype.u,vA.prototype.open=vA.prototype.m,vA.prototype.close=vA.prototype.close,sy.NO_ERROR=0,sy.TIMEOUT=8,sy.HTTP_ERROR=6,ty.COMPLETE="complete",wy.EventType=xy,xy.OPEN="a",xy.CLOSE="b",xy.ERROR="c",xy.MESSAGE="d",Bx.prototype.listen=Bx.prototype.N,Nz.prototype.listenOnce=Nz.prototype.O,Nz.prototype.getLastError=Nz.prototype.La,Nz.prototype.getLastErrorCode=Nz.prototype.Da,Nz.prototype.getStatus=Nz.prototype.ba,Nz.prototype.getResponseJson=Nz.prototype.Qa,Nz.prototype.getResponseText=Nz.prototype.ga,Nz.prototype.send=Nz.prototype.ea;var zA=rw.createWebChannelTransport=function(){return new uA},AA=rw.getStatEventTarget=function(){return ly()},BA=rw.ErrorCode=sy,CA=rw.EventType=ty,DA=rw.Event=jy,EA=rw.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},FA=rw.FetchXmlHttpFactory=Gz,GA=rw.WebChannel=wy,HA=rw.XhrIo=Nz,IA=c(3454);const JA="@firebase/firestore";class KA{constructor(LA){this.uid=LA}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(MA){return MA.uid===this.uid}}KA.UNAUTHENTICATED=new KA(null),KA.GOOGLE_CREDENTIALS=new KA("google-credentials-uid"),KA.FIRST_PARTY=new KA("first-party-uid"),KA.MOCK_USER=new KA("mock-user");let NA="9.6.3";const OA=new Ob("@firebase/firestore");function PA(){return OA.logLevel}function QA(a,...b){if(OA.logLevel<=ow.DEBUG){const c=b.map(TA);OA.debug(`Firestore (${NA}): ${a}`,...c)}}function RA(a,...b){if(OA.logLevel<=ow.ERROR){const c=b.map(TA);OA.error(`Firestore (${NA}): ${a}`,...c)}}function SA(a,...b){if(OA.logLevel<=ow.WARN){const c=b.map(TA);OA.warn(`Firestore (${NA}): ${a}`,...c)}}function TA(a){var b;if("string"==typeof a)return a;try{return b=a,JSON.stringify(b)}catch(c){return a}}function UA(a="Unexpected state"){const b=`FIRESTORE (${NA}) INTERNAL ASSERTION FAILED: `+a;throw RA(b),new Error(b)}function VA(a,b){a||UA()}function WA(a,b){return a}const XA={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class YA extends I{constructor(ZA,$A){super(ZA,$A),this.code=ZA,this.message=$A,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class _A{constructor(){this.promise=new Promise((a,b)=>{this.resolve=a,this.reject=b})}}class aB{constructor(bB,cB){this.user=cB,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${bB}`)}}class dB{getToken(){return Promise.resolve(null)}invalidateToken(){}start(eB,fB){eB.enqueueRetryable(()=>fB(KA.UNAUTHENTICATED))}shutdown(){}}class gB{constructor(hB){this.token=hB,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(iB,jB){this.changeListener=jB,iB.enqueueRetryable(()=>jB(this.token.user))}shutdown(){this.changeListener=null}}class kB{constructor(lB){this.t=lB,this.currentUser=KA.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(mB,nB){let oB=this.i;const pB=a=>this.i!==oB?(oB=this.i,nB(a)):Promise.resolve();let qB=new _A;this.o=()=>{this.i++,this.currentUser=this.u(),qB.resolve(),qB=new _A,mB.enqueueRetryable(()=>pB(this.currentUser))};const rB=()=>{const a=qB;mB.enqueueRetryable(async()=>{await a.promise,await pB(this.currentUser)})},sB=a=>{QA("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=a,this.auth.addAuthTokenListener(this.o),rB()};this.t.onInit(a=>sB(a)),setTimeout(()=>{if(!this.auth){const a=this.t.getImmediate({optional:!0});a?sB(a):(QA("FirebaseAuthCredentialsProvider","Auth not yet detected"),qB.resolve(),qB=new _A)}},0),rB()}getToken(){const tB=this.i,uB=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(uB).then(a=>this.i!==tB?(QA("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):a?(VA("string"==typeof a.accessToken),new aB(a.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const vB=this.auth&&this.auth.getUid();return VA(null===vB||"string"==typeof vB),new KA(vB)}}class wB{constructor(xB,yB,zB){this.type="FirstParty",this.user=KA.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",yB);const AB=xB.auth.getAuthHeaderValueForFirstParty([]);AB&&this.headers.set("Authorization",AB),zB&&this.headers.set("X-Goog-Iam-Authorization-Token",zB)}}class BB{constructor(CB,DB,EB){this.h=CB,this.l=DB,this.m=EB}getToken(){return Promise.resolve(new wB(this.h,this.l,this.m))}start(FB,GB){FB.enqueueRetryable(()=>GB(KA.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class HB{constructor(IB){this.value=IB,this.type="AppCheck",this.headers=new Map,IB&&IB.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class JB{constructor(KB){this.g=KB,this.forceRefresh=!1,this.appCheck=null}start(LB,MB){this.o=a=>{LB.enqueueRetryable(()=>{var b;return null!=(b=a).error&&QA("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${b.error.message}`),MB(b.token)})};const NB=a=>{QA("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.appCheck.addTokenListener(this.o)};this.g.onInit(a=>NB(a)),setTimeout(()=>{if(!this.appCheck){const a=this.g.getImmediate({optional:!0});a?NB(a):QA("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const OB=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(OB).then(a=>a?(VA("string"==typeof a.token),new HB(a.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}class PB{constructor(QB,RB){this.previousValue=QB,RB&&(RB.sequenceNumberHandler=a=>this.p(a),this.T=a=>RB.writeSequenceNumber(a))}p(SB){return this.previousValue=Math.max(SB,this.previousValue),this.previousValue}next(){const TB=++this.previousValue;return this.T&&this.T(TB),TB}}function UB(a){const b="undefined"!=typeof self&&(self.crypto||self.msCrypto),c=new Uint8Array(a);if(b&&"function"==typeof b.getRandomValues)b.getRandomValues(c);else for(let d=0;d<a;d++)c[d]=Math.floor(256*Math.random());return c}PB.I=-1;class VB{static A(){const WB="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",XB=Math.floor(256/WB.length)*WB.length;let YB="";for(;YB.length<20;){const ZB=UB(40);for(let $B=0;$B<ZB.length;++$B)YB.length<20&&ZB[$B]<XB&&(YB+=WB.charAt(ZB[$B]%WB.length))}return YB}}function _B(a,b){return a<b?-1:a>b?1:0}function aC(a,b,c){return a.length===b.length&&a.every((a,d)=>c(a,b[d]))}function bC(a){return a+"\x00"}class cC{constructor(dC,eC){if(this.seconds=dC,this.nanoseconds=eC,eC<0)throw new YA(XA.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+eC);if(eC>=10e8)throw new YA(XA.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+eC);if(dC< -62135596800)throw new YA(XA.INVALID_ARGUMENT,"Timestamp seconds out of range: "+dC);if(dC>=253402300800)throw new YA(XA.INVALID_ARGUMENT,"Timestamp seconds out of range: "+dC)}static now(){return cC.fromMillis(Date.now())}static fromDate(fC){return cC.fromMillis(fC.getTime())}static fromMillis(gC){const hC=Math.floor(gC/1000);return new cC(hC,Math.floor(10e5*(gC-1000*hC)))}toDate(){return new Date(this.toMillis())}toMillis(){return 1000*this.seconds+this.nanoseconds/10e5}_compareTo(iC){return this.seconds===iC.seconds?_B(this.nanoseconds,iC.nanoseconds):_B(this.seconds,iC.seconds)}isEqual(jC){return jC.seconds===this.seconds&&jC.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const kC=this.seconds- -62135596800;return String(kC).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class lC{constructor(mC){this.timestamp=mC}static fromTimestamp(nC){return new lC(nC)}static min(){return new lC(new cC(0,0))}compareTo(oC){return this.timestamp._compareTo(oC.timestamp)}isEqual(pC){return this.timestamp.isEqual(pC.timestamp)}toMicroseconds(){return 10e5*this.timestamp.seconds+this.timestamp.nanoseconds/1000}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}function qC(a){let b=0;for(const c in a)Object.prototype.hasOwnProperty.call(a,c)&&b++;return b}function rC(a,b){for(const c in a)Object.prototype.hasOwnProperty.call(a,c)&&b(c,a[c])}function sC(a){for(const b in a)if(Object.prototype.hasOwnProperty.call(a,b))return!1;return!0}class tC{constructor(uC,vC,wC){void 0===vC?vC=0:0>uC.length&&UA(),void 0===wC?wC=uC.length-0:wC>uC.length-0&&UA(),this.segments=uC,this.offset=0,this.len=wC}get length(){return this.len}isEqual(xC){return 0===tC.comparator(this,xC)}child(yC){const zC=this.segments.slice(this.offset,this.limit());return yC instanceof tC?yC.forEach(a=>{zC.push(a)}):zC.push(yC),this.construct(zC)}limit(){return this.offset+this.length}popFirst(AC){return AC=void 0===AC?1:AC,this.construct(this.segments,this.offset+AC,this.length-AC)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(BC){return this.segments[this.offset+BC]}isEmpty(){return 0===this.length}isPrefixOf(CC){if(CC.length<this.length)return!1;for(let DC=0;DC<this.length;DC++)if(this.get(DC)!==CC.get(DC))return!1;return!0}isImmediateParentOf(EC){if(this.length+1!==EC.length)return!1;for(let FC=0;FC<this.length;FC++)if(this.get(FC)!==EC.get(FC))return!1;return!0}forEach(GC){for(let HC=this.offset,IC=this.limit();HC<IC;HC++)GC(this.segments[HC])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(JC,KC){const LC=Math.min(JC.length,KC.length);for(let MC=0;MC<LC;MC++){const NC=JC.get(MC),OC=KC.get(MC);if(NC<OC)return -1;if(NC>OC)return 1}return JC.length<KC.length?-1:JC.length>KC.length?1:0}}class PC extends tC{construct(QC,RC,SC){return new PC(QC,RC,SC)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...TC){const UC=[];for(const VC of TC){if(VC.indexOf("//")>=0)throw new YA(XA.INVALID_ARGUMENT,`Invalid segment (${VC}). Paths must not contain // in them.`);UC.push(...VC.split("/").filter(a=>a.length>0))}return new PC(UC)}static emptyPath(){return new PC([])}}const WC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class XC extends tC{construct(YC,ZC,$C){return new XC(YC,ZC,$C)}static isValidIdentifier(_C){return WC.test(_C)}canonicalString(){return this.toArray().map(a=>(a=a.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),XC.isValidIdentifier(a)||(a="`"+a+"`"),a)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new XC(["__name__"])}static fromServerFormat(aD){const bD=[];let cD="",dD=0;const eD=()=>{if(0===cD.length)throw new YA(XA.INVALID_ARGUMENT,`Invalid field path (${aD}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);bD.push(cD),cD=""};let fD=!1;for(;dD<aD.length;){const gD=aD[dD];if("\\"===gD){if(dD+1===aD.length)throw new YA(XA.INVALID_ARGUMENT,"Path has trailing escape character: "+aD);const hD=aD[dD+1];if("\\"!==hD&&"."!==hD&&"`"!==hD)throw new YA(XA.INVALID_ARGUMENT,"Path has invalid escape sequence: "+aD);cD+=hD,dD+=2}else"`"===gD?(fD=!fD,dD++):"."!==gD||fD?(cD+=gD,dD++):(eD(),dD++)}if(eD(),fD)throw new YA(XA.INVALID_ARGUMENT,"Unterminated ` in path: "+aD);return new XC(bD)}static emptyPath(){return new XC([])}}class iD{constructor(jD){this.fields=jD,jD.sort(XC.comparator)}covers(kD){for(const lD of this.fields)if(lD.isPrefixOf(kD))return!0;return!1}isEqual(mD){return aC(this.fields,mD.fields,(a,b)=>a.isEqual(b))}}class nD{constructor(oD){this.binaryString=oD}static fromBase64String(pD){const qD=atob(pD);return new nD(qD)}static fromUint8Array(rD){const sD=function(a){let b="";for(let c=0;c<a.length;++c)b+=String.fromCharCode(a[c]);return b}(rD);return new nD(sD)}[Symbol.iterator](){let tD=0;return{next:()=>tD<this.binaryString.length?{value:this.binaryString.charCodeAt(tD++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return(function(a){const b=new Uint8Array(a.length);for(let c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(uD){return _B(this.binaryString,uD.binaryString)}isEqual(vD){return this.binaryString===vD.binaryString}}nD.EMPTY_BYTE_STRING=new nD("");const wD=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function xD(a){if(VA(!!a),"string"==typeof a){let b=0;const c=wD.exec(a);if(VA(!!c),c[1]){let d=c[1];b=Number(d=(d+"000000000").substr(0,9))}const e=new Date(a);return{seconds:Math.floor(e.getTime()/1000),nanos:b}}return{seconds:yD(a.seconds),nanos:yD(a.nanos)}}function yD(a){return"number"==typeof a?a:"string"==typeof a?Number(a):0}function zD(a){return"string"==typeof a?nD.fromBase64String(a):nD.fromUint8Array(a)}function AD(a){var b,c;return"server_timestamp"===(null===(c=((null===(b=null==a?void 0:a.mapValue)|| void 0===b?void 0:b.fields)||{}).__type__)|| void 0===c?void 0:c.stringValue)}function BD(a){const b=a.mapValue.fields.__previous_value__;return AD(b)?BD(b):b}function CD(a){const b=xD(a.mapValue.fields.__local_write_time__.timestampValue);return new cC(b.seconds,b.nanos)}function DD(a){return null==a}function ED(a){return 0===a&&1/a== -1/0}function FD(a){return"number"==typeof a&&Number.isInteger(a)&&!ED(a)&&a<=Number.MAX_SAFE_INTEGER&&a>=Number.MIN_SAFE_INTEGER}class GD{constructor(HD){this.path=HD}static fromPath(ID){return new GD(PC.fromString(ID))}static fromName(JD){return new GD(PC.fromString(JD).popFirst(5))}hasCollectionId(KD){return this.path.length>=2&&this.path.get(this.path.length-2)===KD}isEqual(LD){return null!==LD&&0===PC.comparator(this.path,LD.path)}toString(){return this.path.toString()}static comparator(MD,ND){return PC.comparator(MD.path,ND.path)}static isDocumentKey(OD){return OD.length%2==0}static fromSegments(PD){return new GD(new PC(PD.slice()))}}function QD(a){return"nullValue"in a?0:"booleanValue"in a?1:"integerValue"in a||"doubleValue"in a?2:"timestampValue"in a?3:"stringValue"in a?5:"bytesValue"in a?6:"referenceValue"in a?7:"geoPointValue"in a?8:"arrayValue"in a?9:"mapValue"in a?AD(a)?4:10:UA()}function RD(a,b){var c,d,e,f;if(a===b)return!0;const g=QD(a);if(g!==QD(b))return!1;switch(g){case 0:return!0;case 1:return a.booleanValue===b.booleanValue;case 4:return CD(a).isEqual(CD(b));case 3:return(function(a,b){if("string"==typeof a.timestampValue&&"string"==typeof b.timestampValue&&a.timestampValue.length===b.timestampValue.length)return a.timestampValue===b.timestampValue;const c=xD(a.timestampValue),d=xD(b.timestampValue);return c.seconds===d.seconds&&c.nanos===d.nanos})(a,b);case 5:return a.stringValue===b.stringValue;case 6:return c=a,d=b,zD(c.bytesValue).isEqual(zD(d.bytesValue));case 7:return a.referenceValue===b.referenceValue;case 8:return e=a,f=b,yD(e.geoPointValue.latitude)===yD(f.geoPointValue.latitude)&&yD(e.geoPointValue.longitude)===yD(f.geoPointValue.longitude);case 2:return(function(a,b){if("integerValue"in a&&"integerValue"in b)return yD(a.integerValue)===yD(b.integerValue);if("doubleValue"in a&&"doubleValue"in b){const c=yD(a.doubleValue),d=yD(b.doubleValue);return c===d?ED(c)===ED(d):isNaN(c)&&isNaN(d)}return!1})(a,b);case 9:return aC(a.arrayValue.values||[],b.arrayValue.values||[],RD);case 10:return(function(a,b){const c=a.mapValue.fields||{},d=b.mapValue.fields||{};if(qC(c)!==qC(d))return!1;for(const e in c)if(c.hasOwnProperty(e)&&(void 0===d[e]||!RD(c[e],d[e])))return!1;return!0})(a,b);default:return UA()}}function SD(a,b){return void 0!==(a.values||[]).find(a=>RD(a,b))}function TD(a,b){if(a===b)return 0;const c=QD(a),d=QD(b);if(c!==d)return _B(c,d);switch(c){case 0:return 0;case 1:return _B(a.booleanValue,b.booleanValue);case 2:return(function(a,b){const c=yD(a.integerValue||a.doubleValue),d=yD(b.integerValue||b.doubleValue);return c<d?-1:c>d?1:c===d?0:isNaN(c)?isNaN(d)?0:-1:1})(a,b);case 3:return UD(a.timestampValue,b.timestampValue);case 4:return UD(CD(a),CD(b));case 5:return _B(a.stringValue,b.stringValue);case 6:return(function(a,b){const c=zD(a),d=zD(b);return c.compareTo(d)})(a.bytesValue,b.bytesValue);case 7:return(function(a,b){const c=a.split("/"),d=b.split("/");for(let e=0;e<c.length&&e<d.length;e++){const f=_B(c[e],d[e]);if(0!==f)return f}return _B(c.length,d.length)})(a.referenceValue,b.referenceValue);case 8:return(function(a,b){const c=_B(yD(a.latitude),yD(b.latitude));return 0!==c?c:_B(yD(a.longitude),yD(b.longitude))})(a.geoPointValue,b.geoPointValue);case 9:return(function(a,b){const c=a.values||[],d=b.values||[];for(let e=0;e<c.length&&e<d.length;++e){const f=TD(c[e],d[e]);if(f)return f}return _B(c.length,d.length)})(a.arrayValue,b.arrayValue);case 10:return(function(a,b){const c=a.fields||{},d=Object.keys(c),e=b.fields||{},f=Object.keys(e);d.sort(),f.sort();for(let g=0;g<d.length&&g<f.length;++g){const h=_B(d[g],f[g]);if(0!==h)return h;const i=TD(c[d[g]],e[f[g]]);if(0!==i)return i}return _B(d.length,f.length)})(a.mapValue,b.mapValue);default:throw UA()}}function UD(a,b){if("string"==typeof a&&"string"==typeof b&&a.length===b.length)return _B(a,b);const c=xD(a),d=xD(b),e=_B(c.seconds,d.seconds);return 0!==e?e:_B(c.nanos,d.nanos)}function VD(a){return WD(a)}function WD(a){var b,c;return"nullValue"in a?"null":"booleanValue"in a?""+a.booleanValue:"integerValue"in a?""+a.integerValue:"doubleValue"in a?""+a.doubleValue:"timestampValue"in a?(function(a){const b=xD(a);return`time(${b.seconds},${b.nanos})`})(a.timestampValue):"stringValue"in a?a.stringValue:"bytesValue"in a?zD(a.bytesValue).toBase64():"referenceValue"in a?(c=a.referenceValue,GD.fromName(c).toString()):"geoPointValue"in a?`geo(${(b=a.geoPointValue).latitude},${b.longitude})`:"arrayValue"in a?(function(a){let b="[",c=!0;for(const d of a.values||[])c?c=!1:b+=",",b+=WD(d);return b+"]"})(a.arrayValue):"mapValue"in a?(function(a){const b=Object.keys(a.fields||{}).sort();let c="{",d=!0;for(const e of b)d?d=!1:c+=",",c+=`${e}:${WD(a.fields[e])}`;return c+"}"})(a.mapValue):UA()}function XD(a,b){return{referenceValue:`projects/${a.projectId}/databases/${a.database}/documents/${b.path.canonicalString()}`}}function YD(a){return!!a&&"integerValue"in a}function ZD(a){return!!a&&"arrayValue"in a}function $D(a){return!!a&&"nullValue"in a}function _D(a){return!!a&&"doubleValue"in a&&isNaN(Number(a.doubleValue))}function aE(a){return!!a&&"mapValue"in a}function bE(a){if(a.geoPointValue)return{geoPointValue:Object.assign({},a.geoPointValue)};if(a.timestampValue&&"object"==typeof a.timestampValue)return{timestampValue:Object.assign({},a.timestampValue)};if(a.mapValue){const b={mapValue:{fields:{}}};return rC(a.mapValue.fields,(a,c)=>b.mapValue.fields[a]=bE(c)),b}if(a.arrayValue){const c={arrayValue:{values:[]}};for(let d=0;d<(a.arrayValue.values||[]).length;++d)c.arrayValue.values[d]=bE(a.arrayValue.values[d]);return c}return Object.assign({},a)}class cE{constructor(dE){this.value=dE}static empty(){return new cE({mapValue:{}})}field(eE){if(eE.isEmpty())return this.value;{let fE=this.value;for(let gE=0;gE<eE.length-1;++gE)if(!aE(fE=(fE.mapValue.fields||{})[eE.get(gE)]))return null;return(fE=(fE.mapValue.fields||{})[eE.lastSegment()])||null}}set(hE,iE){this.getFieldsMap(hE.popLast())[hE.lastSegment()]=bE(iE)}setAll(jE){let kE=XC.emptyPath(),lE={},mE=[];jE.forEach((a,b)=>{if(!kE.isImmediateParentOf(b)){const c=this.getFieldsMap(kE);this.applyChanges(c,lE,mE),lE={},mE=[],kE=b.popLast()}a?lE[b.lastSegment()]=bE(a):mE.push(b.lastSegment())});const nE=this.getFieldsMap(kE);this.applyChanges(nE,lE,mE)}delete(oE){const pE=this.field(oE.popLast());aE(pE)&&pE.mapValue.fields&&delete pE.mapValue.fields[oE.lastSegment()]}isEqual(qE){return RD(this.value,qE.value)}getFieldsMap(rE){let sE=this.value;sE.mapValue.fields||(sE.mapValue={fields:{}});for(let tE=0;tE<rE.length;++tE){let uE=sE.mapValue.fields[rE.get(tE)];aE(uE)&&uE.mapValue.fields||(uE={mapValue:{fields:{}}},sE.mapValue.fields[rE.get(tE)]=uE),sE=uE}return sE.mapValue.fields}applyChanges(vE,wE,xE){for(const yE of(rC(wE,(a,b)=>vE[a]=b),xE))delete vE[yE]}clone(){return new cE(bE(this.value))}}function zE(a){const b=[];return rC(a.fields,(a,c)=>{const d=new XC([a]);if(aE(c)){const e=zE(c.mapValue).fields;if(0===e.length)b.push(d);else for(const f of e)b.push(d.child(f))}else b.push(d)}),new iD(b)}class AE{constructor(BE,CE,DE,EE,FE){this.key=BE,this.documentType=CE,this.version=DE,this.data=EE,this.documentState=FE}static newInvalidDocument(GE){return new AE(GE,0,lC.min(),cE.empty(),0)}static newFoundDocument(HE,IE,JE){return new AE(HE,1,IE,JE,0)}static newNoDocument(KE,LE){return new AE(KE,2,LE,cE.empty(),0)}static newUnknownDocument(ME,NE){return new AE(ME,3,NE,cE.empty(),2)}convertToFoundDocument(OE,PE){return this.version=OE,this.documentType=1,this.data=PE,this.documentState=0,this}convertToNoDocument(QE){return this.version=QE,this.documentType=2,this.data=cE.empty(),this.documentState=0,this}convertToUnknownDocument(RE){return this.version=RE,this.documentType=3,this.data=cE.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(SE){return SE instanceof AE&&this.key.isEqual(SE.key)&&this.version.isEqual(SE.version)&&this.documentType===SE.documentType&&this.documentState===SE.documentState&&this.data.isEqual(SE.data)}mutableCopy(){return new AE(this.key,this.documentType,this.version,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class TE{constructor(UE,VE=null,WE=[],XE=[],YE=null,ZE=null,$E=null){this.path=UE,this.collectionGroup=VE,this.orderBy=WE,this.filters=XE,this.limit=YE,this.startAt=ZE,this.endAt=$E,this.R=null}}function _E(a,b=null,c=[],d=[],e=null,f=null,g=null){return new TE(a,b,c,d,e,f,g)}function aF(a){const b=WA(a);if(null===b.R){let c=b.path.canonicalString();null!==b.collectionGroup&&(c+="|cg:"+b.collectionGroup),c+="|f:",c+=b.filters.map(a=>qF(a)).join(","),c+="|ob:",c+=b.orderBy.map(a=>{var b;return(b=a).field.canonicalString()+b.dir}).join(","),DD(b.limit)||(c+="|l:",c+=b.limit),b.startAt&&(c+="|lb:",c+=bG(b.startAt)),b.endAt&&(c+="|ub:",c+=bG(b.endAt)),b.R=c}return b.R}function bF(a,b){var c,d;if(a.limit!==b.limit)return!1;if(a.orderBy.length!==b.orderBy.length)return!1;for(let e=0;e<a.orderBy.length;e++)if(!fG(a.orderBy[e],b.orderBy[e]))return!1;if(a.filters.length!==b.filters.length)return!1;for(let f=0;f<a.filters.length;f++)if(c=a.filters[f],d=b.filters[f],c.op!==d.op||!c.field.isEqual(d.field)||!RD(c.value,d.value))return!1;return a.collectionGroup===b.collectionGroup&& !!a.path.isEqual(b.path)&& !!hG(a.startAt,b.startAt)&&hG(a.endAt,b.endAt)}function cF(a){return GD.isDocumentKey(a.path)&&null===a.collectionGroup&&0===a.filters.length}class dF extends class{}{constructor(eF,fF,gF){super(),this.field=eF,this.op=fF,this.value=gF}static create(hF,iF,jF){return hF.isKeyField()?"in"===iF||"not-in"===iF?this.P(hF,iF,jF):new rF(hF,iF,jF):"array-contains"===iF?new GF(hF,jF):"in"===iF?new LF(hF,jF):"not-in"===iF?new QF(hF,jF):"array-contains-any"===iF?new VF(hF,jF):new dF(hF,iF,jF)}static P(kF,lF,mF){return"in"===lF?new xF(kF,mF):new BF(kF,mF)}matches(nF){const oF=nF.data.field(this.field);return"!="===this.op?null!==oF&&this.v(TD(oF,this.value)):null!==oF&&QD(this.value)===QD(oF)&&this.v(TD(oF,this.value))}v(pF){switch(this.op){case"<":return pF<0;case"<=":return pF<=0;case"==":return 0===pF;case"!=":return 0!==pF;case">":return pF>0;case">=":return pF>=0;default:return UA()}}V(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}function qF(a){return a.field.canonicalString()+a.op.toString()+VD(a.value)}class rF extends dF{constructor(sF,tF,uF){super(sF,tF,uF),this.key=GD.fromName(uF.referenceValue)}matches(vF){const wF=GD.comparator(vF.key,this.key);return this.v(wF)}}class xF extends dF{constructor(yF,zF){super(yF,"in",zF),this.keys=FF("in",zF)}matches(AF){return this.keys.some(a=>a.isEqual(AF.key))}}class BF extends dF{constructor(CF,DF){super(CF,"not-in",DF),this.keys=FF("not-in",DF)}matches(EF){return!this.keys.some(a=>a.isEqual(EF.key))}}function FF(a,b){var c;return((null===(c=b.arrayValue)|| void 0===c?void 0:c.values)||[]).map(a=>GD.fromName(a.referenceValue))}class GF extends dF{constructor(HF,IF){super(HF,"array-contains",IF)}matches(JF){const KF=JF.data.field(this.field);return ZD(KF)&&SD(KF.arrayValue,this.value)}}class LF extends dF{constructor(MF,NF){super(MF,"in",NF)}matches(OF){const PF=OF.data.field(this.field);return null!==PF&&SD(this.value.arrayValue,PF)}}class QF extends dF{constructor(RF,SF){super(RF,"not-in",SF)}matches(TF){if(SD(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const UF=TF.data.field(this.field);return null!==UF&&!SD(this.value.arrayValue,UF)}}class VF extends dF{constructor(WF,XF){super(WF,"array-contains-any",XF)}matches(YF){const ZF=YF.data.field(this.field);return!(!ZD(ZF)||!ZF.arrayValue.values)&&ZF.arrayValue.values.some(a=>SD(this.value.arrayValue,a))}}class $F{constructor(_F,aG){this.position=_F,this.before=aG}}function bG(a){return`${a.before?"b":"a"}:${a.position.map(a=>VD(a)).join(",")}`}class cG{constructor(dG,eG="asc"){this.field=dG,this.dir=eG}}function fG(a,b){return a.dir===b.dir&&a.field.isEqual(b.field)}function gG(a,b,c){let d=0;for(let e=0;e<a.position.length;e++){const f=b[e],g=a.position[e];if(d=f.field.isKeyField()?GD.comparator(GD.fromName(g.referenceValue),c.key):TD(g,c.data.field(f.field)),"desc"===f.dir&&(d*=-1),0!==d)break}return a.before?d<=0:d<0}function hG(a,b){if(null===a)return null===b;if(null===b)return!1;if(a.before!==b.before||a.position.length!==b.position.length)return!1;for(let c=0;c<a.position.length;c++)if(!RD(a.position[c],b.position[c]))return!1;return!0}class iG{constructor(jG,kG=null,lG=[],mG=[],nG=null,oG="F",pG=null,qG=null){this.path=jG,this.collectionGroup=kG,this.explicitOrderBy=lG,this.filters=mG,this.limit=nG,this.limitType=oG,this.startAt=pG,this.endAt=qG,this.S=null,this.D=null,this.startAt,this.endAt}}function rG(a,b,c,d,e,f,g,h){return new iG(a,b,c,d,e,f,g,h)}function sG(a){return new iG(a)}function tG(a){return!DD(a.limit)&&"F"===a.limitType}function uG(a){return!DD(a.limit)&&"L"===a.limitType}function vG(a){return a.explicitOrderBy.length>0?a.explicitOrderBy[0].field:null}function wG(a){for(const b of a.filters)if(b.V())return b.field;return null}function xG(a){return null!==a.collectionGroup}function yG(a){const b=WA(a);if(null===b.S){b.S=[];const c=wG(b),d=vG(b);if(null!==c&&null===d)c.isKeyField()||b.S.push(new cG(c)),b.S.push(new cG(XC.keyField(),"asc"));else{let e=!1;for(const f of b.explicitOrderBy)b.S.push(f),f.field.isKeyField()&&(e=!0);if(!e){const g=b.explicitOrderBy.length>0?b.explicitOrderBy[b.explicitOrderBy.length-1].dir:"asc";b.S.push(new cG(XC.keyField(),g))}}}return b.S}function zG(a){const b=WA(a);if(!b.D)if("F"===b.limitType)b.D=_E(b.path,b.collectionGroup,yG(b),b.filters,b.limit,b.startAt,b.endAt);else{const c=[];for(const d of yG(b)){const e="desc"===d.dir?"asc":"desc";c.push(new cG(d.field,e))}const f=b.endAt?new $F(b.endAt.position,!b.endAt.before):null,g=b.startAt?new $F(b.startAt.position,!b.startAt.before):null;b.D=_E(b.path,b.collectionGroup,c,b.filters,b.limit,f,g)}return b.D}function AG(a,b,c){return new iG(a.path,a.collectionGroup,a.explicitOrderBy.slice(),a.filters.slice(),b,c,a.startAt,a.endAt)}function BG(a,b){return bF(zG(a),zG(b))&&a.limitType===b.limitType}function CG(a){return`${aF(zG(a))}|lt:${a.limitType}`}function DG(a){var b;let c;return`Query(target=${c=(b=zG(a)).path.canonicalString(),null!==b.collectionGroup&&(c+=" collectionGroup="+b.collectionGroup),b.filters.length>0&&(c+=`, filters: [${b.filters.map(a=>{var b;return`${(b=a).field.canonicalString()} ${b.op} ${VD(b.value)}`}).join(", ")}]`),DD(b.limit)||(c+=", limit: "+b.limit),b.orderBy.length>0&&(c+=`, orderBy: [${b.orderBy.map(a=>{var b;return b=a,`${b.field.canonicalString()} (${b.dir})`}).join(", ")}]`),b.startAt&&(c+=", startAt: "+bG(b.startAt)),b.endAt&&(c+=", endAt: "+bG(b.endAt)),`Target(${c})`}; limitType=${a.limitType})`}function EG(a,b){var c,d;return b.isFoundDocument()&&(function(a,b){const c=b.key.path;return null!==a.collectionGroup?b.key.hasCollectionId(a.collectionGroup)&&a.path.isPrefixOf(c):GD.isDocumentKey(a.path)?a.path.isEqual(c):a.path.isImmediateParentOf(c)})(a,b)&&(function(a,b){for(const c of a.explicitOrderBy)if(!c.field.isKeyField()&&null===b.data.field(c.field))return!1;return!0})(a,b)&&(function(a,b){for(const c of a.filters)if(!c.matches(b))return!1;return!0})(a,b)&&(c=a,d=b,(!c.startAt||!!gG(c.startAt,yG(c),d))&&!(c.endAt&&gG(c.endAt,yG(c),d)))}function FG(a){return(b,c)=>{let d=!1;for(const e of yG(a)){const f=GG(e,b,c);if(0!==f)return f;d=d||e.field.isKeyField()}return 0}}function GG(a,b,c){const d=a.field.isKeyField()?GD.comparator(b.key,c.key):function(a,b,c){const d=b.data.field(a),e=c.data.field(a);return null!==d&&null!==e?TD(d,e):UA()}(a.field,b,c);switch(a.dir){case"asc":return d;case"desc":return -1*d;default:return UA()}}function HG(a,b){if(a.C){if(isNaN(b))return{doubleValue:"NaN"};if(b===1/0)return{doubleValue:"Infinity"};if(b=== -1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ED(b)?"-0":b}}function IG(a){return{integerValue:""+a}}function JG(a,b){return FD(b)?IG(b):HG(a,b)}class KG{constructor(){this._=void 0}}function LG(a,b,c){return a instanceof OG?(function(a,b){const c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return b&&(c.fields.__previous_value__=b),{mapValue:c}})(c,b):a instanceof PG?RG(a,b):a instanceof SG?UG(a,b):(function(a,b){const c=NG(a,b),d=YG(c)+YG(a.N);return YD(c)&&YD(a.N)?IG(d):HG(a.k,d)})(a,b)}function MG(a,b,c){return a instanceof PG?RG(a,b):a instanceof SG?UG(a,b):c}function NG(a,b){var c,d;return a instanceof VG?YD(c=b)||(d=c)&&"doubleValue"in d?b:{integerValue:0}:null}class OG extends KG{}class PG extends KG{constructor(QG){super(),this.elements=QG}}function RG(a,b){const c=ZG(b);for(const d of a.elements)c.some(a=>RD(a,d))||c.push(d);return{arrayValue:{values:c}}}class SG extends KG{constructor(TG){super(),this.elements=TG}}function UG(a,b){let c=ZG(b);for(const d of a.elements)c=c.filter(a=>!RD(a,d));return{arrayValue:{values:c}}}class VG extends KG{constructor(WG,XG){super(),this.k=WG,this.N=XG}}function YG(a){return yD(a.integerValue||a.doubleValue)}function ZG(a){return ZD(a)&&a.arrayValue.values?a.arrayValue.values.slice():[]}class $G{constructor(_G,aH){this.field=_G,this.transform=aH}}class bH{constructor(cH,dH){this.version=cH,this.transformResults=dH}}class eH{constructor(fH,gH){this.updateTime=fH,this.exists=gH}static none(){return new eH}static exists(hH){return new eH(void 0,hH)}static updateTime(iH){return new eH(iH)}get isNone(){return void 0===this.updateTime&& void 0===this.exists}isEqual(jH){return this.exists===jH.exists&&(this.updateTime?!!jH.updateTime&&this.updateTime.isEqual(jH.updateTime):!jH.updateTime)}}function kH(a,b){return void 0!==a.updateTime?b.isFoundDocument()&&b.version.isEqual(a.updateTime):void 0===a.exists||a.exists===b.isFoundDocument()}class lH{}function mH(a,b,c){a instanceof rH?(function(a,b,c){const d=a.value.clone(),e=DH(a.fieldTransforms,b,c.transformResults);d.setAll(e),b.convertToFoundDocument(c.version,d).setHasCommittedMutations()})(a,b,c):a instanceof wH?(function(a,b,c){if(!kH(a.precondition,b))return void b.convertToUnknownDocument(c.version);const d=DH(a.fieldTransforms,b,c.transformResults),e=b.data;e.setAll(CH(a)),e.setAll(d),b.convertToFoundDocument(c.version,e).setHasCommittedMutations()})(a,b,c):(function(a,b,c){b.convertToNoDocument(c.version).setHasCommittedMutations()})(0,b,c)}function nH(a,b,c){var d,e;a instanceof rH?(function(a,b,c){if(kH(a.precondition,b)){const d=a.value.clone(),e=EH(a.fieldTransforms,c,b);d.setAll(e),b.convertToFoundDocument(qH(b),d).setHasLocalMutations()}})(a,b,c):a instanceof wH?(function(a,b,c){if(kH(a.precondition,b)){const d=EH(a.fieldTransforms,c,b),e=b.data;e.setAll(CH(a)),e.setAll(d),b.convertToFoundDocument(qH(b),e).setHasLocalMutations()}})(a,b,c):(d=a,e=b,kH(d.precondition,e)&&e.convertToNoDocument(lC.min()))}function oH(a,b){let c=null;for(const d of a.fieldTransforms){const e=b.data.field(d.field),f=NG(d.transform,e||null);null!=f&&(null==c&&(c=cE.empty()),c.set(d.field,f))}return c||null}function pH(a,b){var c,d;return a.type===b.type&& !!a.key.isEqual(b.key)&& !!a.precondition.isEqual(b.precondition)&&(c=a.fieldTransforms,d=b.fieldTransforms,!!(void 0===c&& void 0===d|| !(!c||!d)&&aC(c,d,(a,b)=>{var c,d,e,f;return c=a,d=b,c.field.isEqual(d.field)&&(e=c.transform,f=d.transform,e instanceof PG&&f instanceof PG||e instanceof SG&&f instanceof SG?aC(e.elements,f.elements,RD):e instanceof VG&&f instanceof VG?RD(e.N,f.N):e instanceof OG&&f instanceof OG)}))&&(0===a.type?a.value.isEqual(b.value):1!==a.type||a.data.isEqual(b.data)&&a.fieldMask.isEqual(b.fieldMask)))}function qH(a){return a.isFoundDocument()?a.version:lC.min()}class rH extends lH{constructor(sH,tH,uH,vH=[]){super(),this.key=sH,this.value=tH,this.precondition=uH,this.fieldTransforms=vH,this.type=0}}class wH extends lH{constructor(xH,yH,zH,AH,BH=[]){super(),this.key=xH,this.data=yH,this.fieldMask=zH,this.precondition=AH,this.fieldTransforms=BH,this.type=1}}function CH(a){const b=new Map;return a.fieldMask.fields.forEach(c=>{if(!c.isEmpty()){const d=a.data.field(c);b.set(c,d)}}),b}function DH(a,b,c){const d=new Map;VA(a.length===c.length);for(let e=0;e<c.length;e++){const f=a[e],g=f.transform,h=b.data.field(f.field);d.set(f.field,MG(g,h,c[e]))}return d}function EH(a,b,c){const d=new Map;for(const e of a){const f=e.transform,g=c.data.field(e.field);d.set(e.field,LG(f,g,b))}return d}class FH extends lH{constructor(GH,HH){super(),this.key=GH,this.precondition=HH,this.type=2,this.fieldTransforms=[]}}class IH extends lH{constructor(JH,KH){super(),this.key=JH,this.precondition=KH,this.type=3,this.fieldTransforms=[]}}class LH{constructor(MH){this.count=MH}}function NH(a){switch(a){default:return UA();case XA.CANCELLED:case XA.UNKNOWN:case XA.DEADLINE_EXCEEDED:case XA.RESOURCE_EXHAUSTED:case XA.INTERNAL:case XA.UNAVAILABLE:case XA.UNAUTHENTICATED:return!1;case XA.INVALID_ARGUMENT:case XA.NOT_FOUND:case XA.ALREADY_EXISTS:case XA.PERMISSION_DENIED:case XA.FAILED_PRECONDITION:case XA.ABORTED:case XA.OUT_OF_RANGE:case XA.UNIMPLEMENTED:case XA.DATA_LOSS:return!0}}function OH(a){if(void 0===a)return RA("GRPC error has no .code"),XA.UNKNOWN;switch(a){case k.OK:return XA.OK;case k.CANCELLED:return XA.CANCELLED;case k.UNKNOWN:return XA.UNKNOWN;case k.DEADLINE_EXCEEDED:return XA.DEADLINE_EXCEEDED;case k.RESOURCE_EXHAUSTED:return XA.RESOURCE_EXHAUSTED;case k.INTERNAL:return XA.INTERNAL;case k.UNAVAILABLE:return XA.UNAVAILABLE;case k.UNAUTHENTICATED:return XA.UNAUTHENTICATED;case k.INVALID_ARGUMENT:return XA.INVALID_ARGUMENT;case k.NOT_FOUND:return XA.NOT_FOUND;case k.ALREADY_EXISTS:return XA.ALREADY_EXISTS;case k.PERMISSION_DENIED:return XA.PERMISSION_DENIED;case k.FAILED_PRECONDITION:return XA.FAILED_PRECONDITION;case k.ABORTED:return XA.ABORTED;case k.OUT_OF_RANGE:return XA.OUT_OF_RANGE;case k.UNIMPLEMENTED:return XA.UNIMPLEMENTED;case k.DATA_LOSS:return XA.DATA_LOSS;default:return UA()}}(l=k||(k={}))[l.OK=0]="OK",l[l.CANCELLED=1]="CANCELLED",l[l.UNKNOWN=2]="UNKNOWN",l[l.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",l[l.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",l[l.NOT_FOUND=5]="NOT_FOUND",l[l.ALREADY_EXISTS=6]="ALREADY_EXISTS",l[l.PERMISSION_DENIED=7]="PERMISSION_DENIED",l[l.UNAUTHENTICATED=16]="UNAUTHENTICATED",l[l.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",l[l.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",l[l.ABORTED=10]="ABORTED",l[l.OUT_OF_RANGE=11]="OUT_OF_RANGE",l[l.UNIMPLEMENTED=12]="UNIMPLEMENTED",l[l.INTERNAL=13]="INTERNAL",l[l.UNAVAILABLE=14]="UNAVAILABLE",l[l.DATA_LOSS=15]="DATA_LOSS";class PH{constructor(QH,RH){this.comparator=QH,this.root=RH||pI.EMPTY}insert(SH,TH){return new PH(this.comparator,this.root.insert(SH,TH,this.comparator).copy(null,null,pI.BLACK,null,null))}remove(UH){return new PH(this.comparator,this.root.remove(UH,this.comparator).copy(null,null,pI.BLACK,null,null))}get(VH){let WH=this.root;for(;!WH.isEmpty();){const XH=this.comparator(VH,WH.key);if(0===XH)return WH.value;XH<0?WH=WH.left:XH>0&&(WH=WH.right)}return null}indexOf(YH){let ZH=0,$H=this.root;for(;!$H.isEmpty();){const _H=this.comparator(YH,$H.key);if(0===_H)return ZH+$H.left.size;_H<0?$H=$H.left:(ZH+=$H.left.size+1,$H=$H.right)}return -1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(aI){return this.root.inorderTraversal(aI)}forEach(bI){this.inorderTraversal((a,b)=>(bI(a,b),!1))}toString(){const cI=[];return this.inorderTraversal((a,b)=>(cI.push(`${a}:${b}`),!1)),`{${cI.join(", ")}}`}reverseTraversal(dI){return this.root.reverseTraversal(dI)}getIterator(){return new gI(this.root,null,this.comparator,!1)}getIteratorFrom(eI){return new gI(this.root,eI,this.comparator,!1)}getReverseIterator(){return new gI(this.root,null,this.comparator,!0)}getReverseIteratorFrom(fI){return new gI(this.root,fI,this.comparator,!0)}}class gI{constructor(hI,iI,jI,kI){this.isReverse=kI,this.nodeStack=[];let lI=1;for(;!hI.isEmpty();)if(lI=iI?jI(hI.key,iI):1,kI&&(lI*=-1),lI<0)hI=this.isReverse?hI.left:hI.right;else{if(0===lI){this.nodeStack.push(hI);break}this.nodeStack.push(hI),hI=this.isReverse?hI.right:hI.left}}getNext(){let mI=this.nodeStack.pop();const nI={key:mI.key,value:mI.value};if(this.isReverse)for(mI=mI.left;!mI.isEmpty();)this.nodeStack.push(mI),mI=mI.right;else for(mI=mI.right;!mI.isEmpty();)this.nodeStack.push(mI),mI=mI.left;return nI}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const oI=this.nodeStack[this.nodeStack.length-1];return{key:oI.key,value:oI.value}}}class pI{constructor(qI,rI,sI,tI,uI){this.key=qI,this.value=rI,this.color=null!=sI?sI:pI.RED,this.left=null!=tI?tI:pI.EMPTY,this.right=null!=uI?uI:pI.EMPTY,this.size=this.left.size+1+this.right.size}copy(vI,wI,xI,yI,zI){return new pI(null!=vI?vI:this.key,null!=wI?wI:this.value,null!=xI?xI:this.color,null!=yI?yI:this.left,null!=zI?zI:this.right)}isEmpty(){return!1}inorderTraversal(AI){return this.left.inorderTraversal(AI)||AI(this.key,this.value)||this.right.inorderTraversal(AI)}reverseTraversal(BI){return this.right.reverseTraversal(BI)||BI(this.key,this.value)||this.left.reverseTraversal(BI)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(CI,DI,EI){let FI=this;const GI=EI(CI,FI.key);return(FI=GI<0?FI.copy(null,null,null,FI.left.insert(CI,DI,EI),null):0===GI?FI.copy(null,DI,null,null,null):FI.copy(null,null,null,null,FI.right.insert(CI,DI,EI))).fixUp()}removeMin(){if(this.left.isEmpty())return pI.EMPTY;let HI=this;return HI.left.isRed()||HI.left.left.isRed()||(HI=HI.moveRedLeft()),(HI=HI.copy(null,null,null,HI.left.removeMin(),null)).fixUp()}remove(II,JI){let KI,LI=this;if(0>JI(II,LI.key))LI.left.isEmpty()||LI.left.isRed()||LI.left.left.isRed()||(LI=LI.moveRedLeft()),LI=LI.copy(null,null,null,LI.left.remove(II,JI),null);else{if(LI.left.isRed()&&(LI=LI.rotateRight()),LI.right.isEmpty()||LI.right.isRed()||LI.right.left.isRed()||(LI=LI.moveRedRight()),0===JI(II,LI.key)){if(LI.right.isEmpty())return pI.EMPTY;KI=LI.right.min(),LI=LI.copy(KI.key,KI.value,null,null,LI.right.removeMin())}LI=LI.copy(null,null,null,null,LI.right.remove(II,JI))}return LI.fixUp()}isRed(){return this.color}fixUp(){let MI=this;return MI.right.isRed()&&!MI.left.isRed()&&(MI=MI.rotateLeft()),MI.left.isRed()&&MI.left.left.isRed()&&(MI=MI.rotateRight()),MI.left.isRed()&&MI.right.isRed()&&(MI=MI.colorFlip()),MI}moveRedLeft(){let NI=this.colorFlip();return NI.right.left.isRed()&&(NI=(NI=(NI=NI.copy(null,null,null,null,NI.right.rotateRight())).rotateLeft()).colorFlip()),NI}moveRedRight(){let OI=this.colorFlip();return OI.left.left.isRed()&&(OI=(OI=OI.rotateRight()).colorFlip()),OI}rotateLeft(){const PI=this.copy(null,null,pI.RED,null,this.right.left);return this.right.copy(null,null,this.color,PI,null)}rotateRight(){const QI=this.copy(null,null,pI.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,QI)}colorFlip(){const RI=this.left.copy(null,null,!this.left.color,null,null),SI=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,RI,SI)}checkMaxDepth(){const TI=this.check();return Math.pow(2,TI)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw UA();if(this.right.isRed())throw UA();const UI=this.left.check();if(UI!==this.right.check())throw UA();return UI+(this.isRed()?0:1)}}pI.EMPTY=null,pI.RED=!0,pI.BLACK=!1,pI.EMPTY=new class{constructor(){this.size=0}get key(){throw UA()}get value(){throw UA()}get color(){throw UA()}get left(){throw UA()}get right(){throw UA()}copy(VI,WI,XI,YI,ZI){return this}insert($I,_I,aJ){return new pI($I,_I)}remove(bJ,cJ){return this}isEmpty(){return!0}inorderTraversal(dJ){return!1}reverseTraversal(eJ){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class fJ{constructor(gJ){this.comparator=gJ,this.data=new PH(this.comparator)}has(hJ){return null!==this.data.get(hJ)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(iJ){return this.data.indexOf(iJ)}forEach(jJ){this.data.inorderTraversal((a,b)=>(jJ(a),!1))}forEachInRange(kJ,lJ){const mJ=this.data.getIteratorFrom(kJ[0]);for(;mJ.hasNext();){const nJ=mJ.getNext();if(this.comparator(nJ.key,kJ[1])>=0)return;lJ(nJ.key)}}forEachWhile(oJ,pJ){let qJ;for(qJ=void 0!==pJ?this.data.getIteratorFrom(pJ):this.data.getIterator();qJ.hasNext();)if(!oJ(qJ.getNext().key))return}firstAfterOrEqual(rJ){const sJ=this.data.getIteratorFrom(rJ);return sJ.hasNext()?sJ.getNext().key:null}getIterator(){return new HJ(this.data.getIterator())}getIteratorFrom(tJ){return new HJ(this.data.getIteratorFrom(tJ))}add(uJ){return this.copy(this.data.remove(uJ).insert(uJ,!0))}delete(vJ){return this.has(vJ)?this.copy(this.data.remove(vJ)):this}isEmpty(){return this.data.isEmpty()}unionWith(wJ){let xJ=this;return xJ.size<wJ.size&&(xJ=wJ,wJ=this),wJ.forEach(a=>{xJ=xJ.add(a)}),xJ}isEqual(yJ){if(!(yJ instanceof fJ))return!1;if(this.size!==yJ.size)return!1;const zJ=this.data.getIterator(),AJ=yJ.data.getIterator();for(;zJ.hasNext();){const BJ=zJ.getNext().key,CJ=AJ.getNext().key;if(0!==this.comparator(BJ,CJ))return!1}return!0}toArray(){const DJ=[];return this.forEach(a=>{DJ.push(a)}),DJ}toString(){const EJ=[];return this.forEach(a=>EJ.push(a)),"SortedSet("+EJ.toString()+")"}copy(FJ){const GJ=new fJ(this.comparator);return GJ.data=FJ,GJ}}class HJ{constructor(IJ){this.iter=IJ}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}const JJ=new PH(GD.comparator);function KJ(){return JJ}const LJ=new PH(GD.comparator);function MJ(){return LJ}const NJ=new PH(GD.comparator);function OJ(){return NJ}const PJ=new fJ(GD.comparator);function QJ(...a){let b=PJ;for(const c of a)b=b.add(c);return b}const RJ=new fJ(_B);function SJ(){return RJ}class TJ{constructor(UJ,VJ,WJ,XJ,YJ){this.snapshotVersion=UJ,this.targetChanges=VJ,this.targetMismatches=WJ,this.documentUpdates=XJ,this.resolvedLimboDocuments=YJ}static createSynthesizedRemoteEventForCurrentChange(ZJ,$J){const _J=new Map;return _J.set(ZJ,aK.createSynthesizedTargetChangeForCurrentChange(ZJ,$J)),new TJ(lC.min(),_J,SJ(),KJ(),QJ())}}class aK{constructor(bK,cK,dK,eK,fK){this.resumeToken=bK,this.current=cK,this.addedDocuments=dK,this.modifiedDocuments=eK,this.removedDocuments=fK}static createSynthesizedTargetChangeForCurrentChange(gK,hK){return new aK(nD.EMPTY_BYTE_STRING,hK,QJ(),QJ(),QJ())}}class iK{constructor(jK,kK,lK,mK){this.$=jK,this.removedTargetIds=kK,this.key=lK,this.O=mK}}class nK{constructor(oK,pK){this.targetId=oK,this.M=pK}}class qK{constructor(rK,sK,tK=nD.EMPTY_BYTE_STRING,uK=null){this.state=rK,this.targetIds=sK,this.resumeToken=tK,this.cause=uK}}class vK{constructor(){this.F=0,this.L=qL(),this.B=nD.EMPTY_BYTE_STRING,this.U=!1,this.q=!0}get current(){return this.U}get resumeToken(){return this.B}get K(){return 0!==this.F}get j(){return this.q}W(wK){wK.approximateByteSize()>0&&(this.q=!0,this.B=wK)}G(){let xK=QJ(),yK=QJ(),zK=QJ();return this.L.forEach((a,b)=>{switch(b){case 0:xK=xK.add(a);break;case 2:yK=yK.add(a);break;case 1:zK=zK.add(a);break;default:UA()}}),new aK(this.B,this.U,xK,yK,zK)}H(){this.q=!1,this.L=qL()}J(AK,BK){this.q=!0,this.L=this.L.insert(AK,BK)}Y(CK){this.q=!0,this.L=this.L.remove(CK)}X(){this.F+=1}Z(){this.F-=1}tt(){this.q=!0,this.U=!0}}class DK{constructor(EK){this.et=EK,this.nt=new Map,this.st=KJ(),this.it=pL(),this.rt=new fJ(_B)}ot(FK){for(const GK of FK.$)FK.O&&FK.O.isFoundDocument()?this.ct(GK,FK.O):this.at(GK,FK.key,FK.O);for(const HK of FK.removedTargetIds)this.at(HK,FK.key,FK.O)}ut(IK){this.forEachTarget(IK,a=>{const b=this.ht(a);switch(IK.state){case 0:this.lt(a)&&b.W(IK.resumeToken);break;case 1:b.Z(),b.K||b.H(),b.W(IK.resumeToken);break;case 2:b.Z(),b.K||this.removeTarget(a);break;case 3:this.lt(a)&&(b.tt(),b.W(IK.resumeToken));break;case 4:this.lt(a)&&(this.ft(a),b.W(IK.resumeToken));break;default:UA()}})}forEachTarget(JK,KK){JK.targetIds.length>0?JK.targetIds.forEach(KK):this.nt.forEach((a,b)=>{this.lt(b)&&KK(b)})}dt(LK){const MK=LK.targetId,NK=LK.M.count,OK=this.wt(MK);if(OK){const PK=OK.target;if(cF(PK))if(0===NK){const QK=new GD(PK.path);this.at(MK,QK,AE.newNoDocument(QK,lC.min()))}else VA(1===NK);else this._t(MK)!==NK&&(this.ft(MK),this.rt=this.rt.add(MK))}}gt(RK){const SK=new Map;this.nt.forEach((a,b)=>{const c=this.wt(b);if(c){if(a.current&&cF(c.target)){const d=new GD(c.target.path);null!==this.st.get(d)||this.yt(b,d)||this.at(b,d,AE.newNoDocument(d,RK))}a.j&&(SK.set(b,a.G()),a.H())}});let TK=QJ();this.it.forEach((a,b)=>{let c=!0;b.forEachWhile(a=>{const b=this.wt(a);return!b||2===b.purpose||(c=!1,!1)}),c&&(TK=TK.add(a))});const UK=new TJ(RK,SK,this.rt,this.st,TK);return this.st=KJ(),this.it=pL(),this.rt=new fJ(_B),UK}ct(VK,WK){if(this.lt(VK)){const XK=this.yt(VK,WK.key)?2:0;this.ht(VK).J(WK.key,XK),this.st=this.st.insert(WK.key,WK),this.it=this.it.insert(WK.key,this.Tt(WK.key).add(VK))}}at(YK,ZK,$K){if(this.lt(YK)){const _K=this.ht(YK);this.yt(YK,ZK)?_K.J(ZK,1):_K.Y(ZK),this.it=this.it.insert(ZK,this.Tt(ZK).delete(YK)),$K&&(this.st=this.st.insert(ZK,$K))}}removeTarget(aL){this.nt.delete(aL)}_t(bL){const cL=this.ht(bL).G();return this.et.getRemoteKeysForTarget(bL).size+cL.addedDocuments.size-cL.removedDocuments.size}X(dL){this.ht(dL).X()}ht(eL){let fL=this.nt.get(eL);return fL||(fL=new vK,this.nt.set(eL,fL)),fL}Tt(gL){let hL=this.it.get(gL);return hL||(hL=new fJ(_B),this.it=this.it.insert(gL,hL)),hL}lt(iL){const jL=null!==this.wt(iL);return jL||QA("WatchChangeAggregator","Detected inactive target",iL),jL}wt(kL){const lL=this.nt.get(kL);return lL&&lL.K?null:this.et.Et(kL)}ft(mL){this.nt.set(mL,new vK),this.et.getRemoteKeysForTarget(mL).forEach(a=>{this.at(mL,a,null)})}yt(nL,oL){return this.et.getRemoteKeysForTarget(nL).has(oL)}}function pL(){return new PH(GD.comparator)}function qL(){return new PH(GD.comparator)}const rL={asc:"ASCENDING",desc:"DESCENDING"},sL={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class tL{constructor(uL,vL){this.databaseId=uL,this.C=vL}}function wL(a,b){return a.C?`${new Date(1000*b.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+b.nanoseconds).slice(-9)}Z`:{seconds:""+b.seconds,nanos:b.nanoseconds}}function xL(a,b){return a.C?b.toBase64():b.toUint8Array()}function yL(a){return VA(!!a),lC.fromTimestamp(function(a){const b=xD(a);return new cC(b.seconds,b.nanos)}(a))}function zL(a,b){var c;return(c=a,new PC(["projects",c.projectId,"databases",c.database])).child("documents").child(b).canonicalString()}function AL(a){const b=PC.fromString(a);return VA(YL(b)),b}function BL(a,b){return zL(a.databaseId,b.path)}function CL(a,b){const c=AL(b);if(c.get(1)!==a.databaseId.projectId)throw new YA(XA.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+c.get(1)+" vs "+a.databaseId.projectId);if(c.get(3)!==a.databaseId.database)throw new YA(XA.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+c.get(3)+" vs "+a.databaseId.database);return new GD(GL(c))}function DL(a,b){return zL(a.databaseId,b)}function EL(a){const b=AL(a);return 4===b.length?PC.emptyPath():GL(b)}function FL(a){return new PC(["projects",a.databaseId.projectId,"databases",a.databaseId.database]).canonicalString()}function GL(a){return VA(a.length>4&&"documents"===a.get(4)),a.popFirst(5)}function HL(a,b,c){return{name:BL(a,b),fields:c.value.mapValue.fields}}function IL(a,b,c){const d=CL(a,b.name),e=yL(b.updateTime),f=new cE({mapValue:{fields:b.fields}}),g=AE.newFoundDocument(d,e,f);return c&&g.setHasCommittedMutations(),c?g.setHasCommittedMutations():g}function JL(a,b){var c,d;let e;if(b instanceof rH)e={update:HL(a,b.key,b.value)};else if(b instanceof FH)e={delete:BL(a,b.key)};else if(b instanceof wH)e={update:HL(a,b.key,b.data),updateMask:XL(b.fieldMask)};else{if(!(b instanceof IH))return UA();e={verify:BL(a,b.key)}}return b.fieldTransforms.length>0&&(e.updateTransforms=b.fieldTransforms.map(a=>(function(a,b){const c=b.transform;if(c instanceof OG)return{fieldPath:b.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof PG)return{fieldPath:b.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof SG)return{fieldPath:b.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof VG)return{fieldPath:b.field.canonicalString(),increment:c.N};throw UA()})(0,a))),b.precondition.isNone||(e.currentDocument=(c=a,void 0!==(d=b.precondition).updateTime?{updateTime:wL(c,d.updateTime.toTimestamp())}:void 0!==d.exists?{exists:d.exists}:UA())),e}function KL(a,b){var c;const d=b.currentDocument?void 0!==(c=b.currentDocument).updateTime?eH.updateTime(yL(c.updateTime)):void 0!==c.exists?eH.exists(c.exists):eH.none():eH.none(),e=b.updateTransforms?b.updateTransforms.map(b=>(function(a,b){let c=null;if("setToServerValue"in b)VA("REQUEST_TIME"===b.setToServerValue),c=new OG;else if("appendMissingElements"in b){const d=b.appendMissingElements.values||[];c=new PG(d)}else if("removeAllFromArray"in b){const e=b.removeAllFromArray.values||[];c=new SG(e)}else"increment"in b?c=new VG(a,b.increment):UA();const f=XC.fromServerFormat(b.fieldPath);return new $G(f,c)})(a,b)):[];if(b.update){b.update.name;const f=CL(a,b.update.name),g=new cE({mapValue:{fields:b.update.fields}});if(b.updateMask){const h=function(a){const b=a.fieldPaths||[];return new iD(b.map(a=>XC.fromServerFormat(a)))}(b.updateMask);return new wH(f,g,h,d,e)}return new rH(f,g,d,e)}if(b.delete){const i=CL(a,b.delete);return new FH(i,d)}if(b.verify){const j=CL(a,b.verify);return new IH(j,d)}return UA()}function LL(a,b){return{documents:[DL(a,b.path)]}}function ML(a,b){var c,d;const e={structuredQuery:{}},f=b.path;null!==b.collectionGroup?(e.parent=DL(a,f),e.structuredQuery.from=[{collectionId:b.collectionGroup,allDescendants:!0}]):(e.parent=DL(a,f.popLast()),e.structuredQuery.from=[{collectionId:f.lastSegment()}]);const g=function(a){if(0!==a.length){const b=a.map(a=>(function(a){if("=="===a.op){if(_D(a.value))return{unaryFilter:{field:TL(a.field),op:"IS_NAN"}};if($D(a.value))return{unaryFilter:{field:TL(a.field),op:"IS_NULL"}}}else if("!="===a.op){if(_D(a.value))return{unaryFilter:{field:TL(a.field),op:"IS_NOT_NAN"}};if($D(a.value))return{unaryFilter:{field:TL(a.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:TL(a.field),op:SL(a.op),value:a.value}}})(a));return 1===b.length?b[0]:{compositeFilter:{op:"AND",filters:b}}}}(b.filters);g&&(e.structuredQuery.where=g);const h=function(a){if(0!==a.length)return a.map(a=>{var b;return{field:TL((b=a).field),direction:RL(b.dir)}})}(b.orderBy);h&&(e.structuredQuery.orderBy=h);const i=(c=a,d=b.limit,c.C||DD(d)?d:{value:d});return null!==i&&(e.structuredQuery.limit=i),b.startAt&&(e.structuredQuery.startAt=PL(b.startAt)),b.endAt&&(e.structuredQuery.endAt=PL(b.endAt)),e}function NL(a){var b;let c=EL(a.parent);const d=a.structuredQuery,e=d.from?d.from.length:0;let f=null;if(e>0){VA(1===e);const g=d.from[0];g.allDescendants?f=g.collectionId:c=c.child(g.collectionId)}let h=[];d.where&&(h=OL(d.where));let i=[];d.orderBy&&(i=d.orderBy.map(a=>{var b;return b=a,new cG(UL(b.field),function(a){switch(a){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(b.direction))}));let j=null,k;d.limit&&(j=DD(k="object"==typeof(b=d.limit)?b.value:b)?null:k);let l=null;d.startAt&&(l=QL(d.startAt));let m=null;return d.endAt&&(m=QL(d.endAt)),rG(c,f,i,h,j,"F",l,m)}function OL(a){return a?void 0!==a.unaryFilter?[WL(a)]:void 0!==a.fieldFilter?[VL(a)]:void 0!==a.compositeFilter?a.compositeFilter.filters.map(a=>OL(a)).reduce((a,b)=>a.concat(b)):UA():[]}function PL(a){return{before:a.before,values:a.position}}function QL(a){const b=!!a.before,c=a.values||[];return new $F(c,b)}function RL(a){return rL[a]}function SL(a){return sL[a]}function TL(a){return{fieldPath:a.canonicalString()}}function UL(a){return XC.fromServerFormat(a.fieldPath)}function VL(a){return dF.create(UL(a.fieldFilter.field),function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return UA()}}(a.fieldFilter.op),a.fieldFilter.value)}function WL(a){switch(a.unaryFilter.op){case"IS_NAN":const b=UL(a.unaryFilter.field);return dF.create(b,"==",{doubleValue:NaN});case"IS_NULL":const c=UL(a.unaryFilter.field);return dF.create(c,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const d=UL(a.unaryFilter.field);return dF.create(d,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const e=UL(a.unaryFilter.field);return dF.create(e,"!=",{nullValue:"NULL_VALUE"});default:return UA()}}function XL(a){const b=[];return a.fields.forEach(a=>b.push(a.canonicalString())),{fieldPaths:b}}function YL(a){return a.length>=4&&"projects"===a.get(0)&&"databases"===a.get(2)}function ZL(a){let b="";for(let c=0;c<a.length;c++)b.length>0&&(b=_L(b)),b=$L(a.get(c),b);return _L(b)}function $L(a,b){let c=b;const d=a.length;for(let e=0;e<d;e++){const f=a.charAt(e);switch(f){case"\x00":c+="\x01\x10";break;case"\x01":c+="\x01\x11";break;default:c+=f}}return c}function _L(a){return a+"\x01\x01"}function aM(a){const b=a.length;if(VA(b>=2),2===b)return VA("\x01"===a.charAt(0)&&"\x01"===a.charAt(1)),PC.emptyPath();const c=[];let d="";for(let e=0;e<b;){const f=a.indexOf("\x01",e);switch((f<0||f>g)&&UA(),a.charAt(f+1)){case"\x01":const g=a.substring(e,f);let h;0===d.length?h=g:(h=d+=g,d=""),c.push(h);break;case"\x10":d+=a.substring(e,f),d+="\x00";break;case"\x11":d+=a.substring(e,f+1);break;default:UA()}e=f+2}return new PC(c)}class bM{constructor(cM,dM){this.seconds=cM,this.nanoseconds=dM}}class eM{constructor(fM,gM,hM){this.ownerId=fM,this.allowTabSynchronization=gM,this.leaseTimestampMs=hM}}eM.store="owner",eM.key="owner";class iM{constructor(jM,kM,lM){this.userId=jM,this.lastAcknowledgedBatchId=kM,this.lastStreamToken=lM}}iM.store="mutationQueues",iM.keyPath="userId";class mM{constructor(nM,oM,pM,qM,rM){this.userId=nM,this.batchId=oM,this.localWriteTimeMs=pM,this.baseMutations=qM,this.mutations=rM}}mM.store="mutations",mM.keyPath="batchId",mM.userMutationsIndex="userMutationsIndex",mM.userMutationsKeyPath=["userId","batchId"];class sM{constructor(){}static prefixForUser(tM){return[tM]}static prefixForPath(uM,vM){return[uM,ZL(vM)]}static key(wM,xM,yM){return[wM,ZL(xM),yM]}}sM.store="documentMutations",sM.PLACEHOLDER=new sM;class zM{constructor(AM,BM){this.path=AM,this.readTime=BM}}class CM{constructor(DM,EM){this.path=DM,this.version=EM}}class FM{constructor(GM,HM,IM,JM,KM,LM){this.unknownDocument=GM,this.noDocument=HM,this.document=IM,this.hasCommittedMutations=JM,this.readTime=KM,this.parentPath=LM}}FM.store="remoteDocuments",FM.readTimeIndex="readTimeIndex",FM.readTimeIndexPath="readTime",FM.collectionReadTimeIndex="collectionReadTimeIndex",FM.collectionReadTimeIndexPath=["parentPath","readTime"];class MM{constructor(NM){this.byteSize=NM}}MM.store="remoteDocumentGlobal",MM.key="remoteDocumentGlobalKey";class OM{constructor(PM,QM,RM,SM,TM,UM,VM){this.targetId=PM,this.canonicalId=QM,this.readTime=RM,this.resumeToken=SM,this.lastListenSequenceNumber=TM,this.lastLimboFreeSnapshotVersion=UM,this.query=VM}}OM.store="targets",OM.keyPath="targetId",OM.queryTargetsIndexName="queryTargetsIndex",OM.queryTargetsKeyPath=["canonicalId","targetId"];class WM{constructor(XM,YM,ZM){this.targetId=XM,this.path=YM,this.sequenceNumber=ZM}}WM.store="targetDocuments",WM.keyPath=["targetId","path"],WM.documentTargetsIndex="documentTargetsIndex",WM.documentTargetsKeyPath=["path","targetId"];class $M{constructor(_M,aN,bN,cN){this.highestTargetId=_M,this.highestListenSequenceNumber=aN,this.lastRemoteSnapshotVersion=bN,this.targetCount=cN}}$M.key="targetGlobalKey",$M.store="targetGlobal";class dN{constructor(eN,fN){this.collectionId=eN,this.parent=fN}}dN.store="collectionParents",dN.keyPath=["collectionId","parent"];class gN{constructor(hN,iN,jN,kN){this.clientId=hN,this.updateTimeMs=iN,this.networkEnabled=jN,this.inForeground=kN}}gN.store="clientMetadata",gN.keyPath="clientId";class lN{constructor(mN,nN,oN){this.bundleId=mN,this.createTime=nN,this.version=oN}}lN.store="bundles",lN.keyPath="bundleId";class pN{constructor(qN,rN,sN){this.name=qN,this.readTime=rN,this.bundledQuery=sN}}pN.store="namedQueries",pN.keyPath="name";const tN=[iM.store,mM.store,sM.store,FM.store,OM.store,eM.store,$M.store,WM.store,gN.store,MM.store,dN.store,lN.store,pN.store],uN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class vN{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(wN){this.onCommittedListeners.push(wN)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(a=>a())}}class xN{constructor(yN){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,yN(a=>{this.isDone=!0,this.result=a,this.nextCallback&&this.nextCallback(a)},a=>{this.isDone=!0,this.error=a,this.catchCallback&&this.catchCallback(a)})}catch(zN){return this.next(void 0,zN)}next(AN,BN){return this.callbackAttached&&UA(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(BN,this.error):this.wrapSuccess(AN,this.result):new xN((a,b)=>{this.nextCallback=c=>{this.wrapSuccess(AN,c).next(a,b)},this.catchCallback=c=>{this.wrapFailure(BN,c).next(a,b)}})}toPromise(){return new Promise((a,b)=>{this.next(a,b)})}wrapUserFunction(CN){try{const DN=CN();return DN instanceof xN?DN:xN.resolve(DN)}catch(EN){return xN.reject(EN)}}wrapSuccess(FN,GN){return FN?this.wrapUserFunction(()=>FN(GN)):xN.resolve(GN)}wrapFailure(HN,IN){return HN?this.wrapUserFunction(()=>HN(IN)):xN.reject(IN)}static resolve(JN){return new xN((a,b)=>{a(JN)})}static reject(KN){return new xN((a,b)=>{b(KN)})}static waitFor(LN){return new xN((a,b)=>{let c=0,d=0,e=!1;LN.forEach(f=>{++c,f.next(()=>{++d,e&&d===c&&a()},a=>b(a))}),e=!0,d===c&&a()})}static or(MN){let NN=xN.resolve(!1);for(const ON of MN)NN=NN.next(a=>a?xN.resolve(a):ON());return NN}static forEach(PN,QN){const RN=[];return PN.forEach((a,b)=>{RN.push(QN.call(this,a,b))}),this.waitFor(RN)}}class SN{constructor(TN,UN){this.action=TN,this.transaction=UN,this.aborted=!1,this.It=new _A,this.transaction.oncomplete=()=>{this.It.resolve()},this.transaction.onabort=()=>{UN.error?this.It.reject(new KO(TN,UN.error)):this.It.resolve()},this.transaction.onerror=a=>{const b=tP(a.target.error);this.It.reject(new KO(TN,b))}}static open(VN,WN,XN,YN){try{return new SN(WN,VN.transaction(YN,XN))}catch(ZN){throw new KO(WN,ZN)}}get At(){return this.It.promise}abort($N){$N&&this.It.reject($N),this.aborted||(QA("SimpleDb","Aborting transaction:",$N?$N.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}store(_N){const aO=this.transaction.objectStore(_N);return new OO(aO)}}class bO{constructor(cO,dO,eO){this.name=cO,this.version=dO,this.Rt=eO,12.2===bO.bt(B())&&RA("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(fO){return QA("SimpleDb","Removing database:",fO),rP(window.indexedDB.deleteDatabase(fO)).toPromise()}static Pt(){if(!H())return!1;if(bO.vt())return!0;const gO=B(),hO=bO.bt(gO),iO=0<hO&&hO<10,jO=bO.Vt(gO),kO=0<jO&&jO<4.5;return!(gO.indexOf("MSIE ")>0||gO.indexOf("Trident/")>0||gO.indexOf("Edge/")>0||iO||kO)}static vt(){var lO;return void 0!==IA&&"YES"===(null===(lO=IA.env)|| void 0===lO?void 0:lO.St)}static Dt(mO,nO){return mO.store(nO)}static bt(oO){const pO=oO.match(/i(?:phone|pad|pod) os ([\d_]+)/i),qO=pO?pO[1].split("_").slice(0,2).join("."):"-1";return Number(qO)}static Vt(rO){const sO=rO.match(/Android ([\d.]+)/i),tO=sO?sO[1].split(".").slice(0,2).join("."):"-1";return Number(tO)}async Ct(uO){return this.db||(QA("SimpleDb","Opening database:",this.name),this.db=await new Promise((a,b)=>{const c=indexedDB.open(this.name,this.version);c.onsuccess=b=>{const c=b.target.result;a(c)},c.onblocked=()=>{b(new KO(uO,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},c.onerror=a=>{const c=a.target.error;"VersionError"===c.name?b(new YA(XA.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===c.name?b(new YA(XA.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+c)):b(new KO(uO,c))},c.onupgradeneeded=a=>{QA("SimpleDb","Database \""+this.name+"\" requires upgrade from version:",a.oldVersion);const b=a.target.result;this.Rt.Nt(b,c.transaction,a.oldVersion,this.version).next(()=>{QA("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.kt&&(this.db.onversionchange=a=>this.kt(a)),this.db}xt(vO){this.kt=vO,this.db&&(this.db.onversionchange=a=>vO(a))}async runTransaction(wO,xO,yO,zO){const AO="readonly"===xO;let BO=0;for(;;){++BO;try{this.db=await this.Ct(wO);const CO=SN.open(this.db,wO,AO?"readonly":"readwrite",yO),DO=zO(CO).catch(a=>(CO.abort(a),xN.reject(a))).toPromise();return DO.catch(()=>{}),await CO.At,DO}catch(EO){const FO="FirebaseError"!==EO.name&&BO<3;if(QA("SimpleDb","Transaction failed with error:",EO.message,"Retrying:",FO),this.close(),!FO)return Promise.reject(EO)}}}close(){this.db&&this.db.close(),this.db=void 0}}class GO{constructor(HO){this.$t=HO,this.Ot=!1,this.Mt=null}get isDone(){return this.Ot}get Ft(){return this.Mt}set cursor(IO){this.$t=IO}done(){this.Ot=!0}Lt(JO){this.Mt=JO}delete(){return rP(this.$t.delete())}}class KO extends YA{constructor(LO,MO){super(XA.UNAVAILABLE,`IndexedDB transaction '${LO}' failed: ${MO}`),this.name="IndexedDbTransactionError"}}function NO(a){return"IndexedDbTransactionError"===a.name}class OO{constructor(PO){this.store=PO}put(QO,RO){let SO;return void 0!==RO?(QA("SimpleDb","PUT",this.store.name,QO,RO),SO=this.store.put(RO,QO)):(QA("SimpleDb","PUT",this.store.name,"<auto-key>",QO),SO=this.store.put(QO)),rP(SO)}add(TO){return QA("SimpleDb","ADD",this.store.name,TO,TO),rP(this.store.add(TO))}get(UO){return rP(this.store.get(UO)).next(a=>(void 0===a&&(a=null),QA("SimpleDb","GET",this.store.name,UO,a),a))}delete(VO){return QA("SimpleDb","DELETE",this.store.name,VO),rP(this.store.delete(VO))}count(){return QA("SimpleDb","COUNT",this.store.name),rP(this.store.count())}Bt(WO,XO){const YO=this.cursor(this.options(WO,XO)),ZO=[];return this.Ut(YO,(a,b)=>{ZO.push(b)}).next(()=>ZO)}qt($O,_O){QA("SimpleDb","DELETE ALL",this.store.name);const aP=this.options($O,_O);aP.Kt=!1;const bP=this.cursor(aP);return this.Ut(bP,(a,b,c)=>c.delete())}jt(cP,dP){let eP;dP?eP=cP:(eP={},dP=cP);const fP=this.cursor(eP);return this.Ut(fP,dP)}Qt(gP){const hP=this.cursor({});return new xN((a,b)=>{hP.onerror=a=>{const c=tP(a.target.error);b(c)},hP.onsuccess=b=>{const c=b.target.result;c?gP(c.primaryKey,c.value).next(b=>{b?c.continue():a()}):a()}})}Ut(iP,jP){const kP=[];return new xN((a,b)=>{iP.onerror=a=>{b(a.target.error)},iP.onsuccess=b=>{const c=b.target.result;if(!c)return void a();const d=new GO(c),e=jP(c.primaryKey,c.value,d);if(e instanceof xN){const f=e.catch(a=>(d.done(),xN.reject(a)));kP.push(f)}d.isDone?a():null===d.Ft?c.continue():c.continue(d.Ft)}}).next(()=>xN.waitFor(kP))}options(lP,mP){let nP;return void 0!==lP&&("string"==typeof lP?nP=lP:mP=lP),{index:nP,range:mP}}cursor(oP){let pP="next";if(oP.reverse&&(pP="prev"),oP.index){const qP=this.store.index(oP.index);return oP.Kt?qP.openKeyCursor(oP.range,pP):qP.openCursor(oP.range,pP)}return this.store.openCursor(oP.range,pP)}}function rP(a){return new xN((b,c)=>{a.onsuccess=a=>{const c=a.target.result;b(c)},a.onerror=a=>{const b=tP(a.target.error);c(b)}})}let sP=!1;function tP(a){const b=bO.bt(B());if(b>=12.2&&b<13){const c="An internal error was encountered in the Indexed Database server";if(a.message.indexOf(c)>=0){const d=new YA("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${c}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return sP||(sP=!0,setTimeout(()=>{throw d},0)),d}}return a}class uP extends vN{constructor(vP,wP){super(),this.Wt=vP,this.currentSequenceNumber=wP}}function xP(a,b){const c=WA(a);return bO.Dt(c.Wt,b)}class yP{constructor(zP,AP,BP,CP){this.batchId=zP,this.localWriteTime=AP,this.baseMutations=BP,this.mutations=CP}applyToRemoteDocument(DP,EP){const FP=EP.mutationResults;for(let GP=0;GP<this.mutations.length;GP++){const HP=this.mutations[GP];HP.key.isEqual(DP.key)&&mH(HP,DP,FP[GP])}}applyToLocalView(IP){for(const JP of this.baseMutations)JP.key.isEqual(IP.key)&&nH(JP,IP,this.localWriteTime);for(const KP of this.mutations)KP.key.isEqual(IP.key)&&nH(KP,IP,this.localWriteTime)}applyToLocalDocumentSet(LP){this.mutations.forEach(a=>{const b=LP.get(a.key),c=b;this.applyToLocalView(c),b.isValidDocument()||c.convertToNoDocument(lC.min())})}keys(){return this.mutations.reduce((a,b)=>a.add(b.key),QJ())}isEqual(MP){return this.batchId===MP.batchId&&aC(this.mutations,MP.mutations,(a,b)=>pH(a,b))&&aC(this.baseMutations,MP.baseMutations,(a,b)=>pH(a,b))}}class NP{constructor(OP,PP,QP,RP){this.batch=OP,this.commitVersion=PP,this.mutationResults=QP,this.docVersions=RP}static from(SP,TP,UP){VA(SP.mutations.length===UP.length);let VP=OJ();const WP=SP.mutations;for(let XP=0;XP<WP.length;XP++)VP=VP.insert(WP[XP].key,UP[XP].version);return new NP(SP,TP,UP,VP)}}class YP{constructor(ZP,$P,_P,aQ,bQ=lC.min(),cQ=lC.min(),dQ=nD.EMPTY_BYTE_STRING){this.target=ZP,this.targetId=$P,this.purpose=_P,this.sequenceNumber=aQ,this.snapshotVersion=bQ,this.lastLimboFreeSnapshotVersion=cQ,this.resumeToken=dQ}withSequenceNumber(eQ){return new YP(this.target,this.targetId,this.purpose,eQ,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(fQ,gQ){return new YP(this.target,this.targetId,this.purpose,this.sequenceNumber,gQ,this.lastLimboFreeSnapshotVersion,fQ)}withLastLimboFreeSnapshotVersion(hQ){return new YP(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,hQ,this.resumeToken)}}class iQ{constructor(jQ){this.Gt=jQ}}function kQ(a,b){if(b.document)return IL(a.Gt,b.document,!!b.hasCommittedMutations);if(b.noDocument){const c=GD.fromSegments(b.noDocument.path),d=pQ(b.noDocument.readTime),e=AE.newNoDocument(c,d);return b.hasCommittedMutations?e.setHasCommittedMutations():e}if(b.unknownDocument){const f=GD.fromSegments(b.unknownDocument.path),g=pQ(b.unknownDocument.version);return AE.newUnknownDocument(f,g)}return UA()}function lQ(a,b,c){const d=mQ(c),e=b.key.path.popLast().toArray();if(b.isFoundDocument()){var f,g;const h={name:BL(f=a.Gt,(g=b).key),fields:g.data.value.mapValue.fields,updateTime:wL(f,g.version.toTimestamp())},i=b.hasCommittedMutations;return new FM(null,null,h,i,d,e)}if(b.isNoDocument()){const j=b.key.path.toArray(),k=oQ(b.version),l=b.hasCommittedMutations;return new FM(null,new zM(j,k),null,l,d,e)}if(b.isUnknownDocument()){const m=b.key.path.toArray(),n=oQ(b.version);return new FM(new CM(m,n),null,null,!0,d,e)}return UA()}function mQ(a){const b=a.toTimestamp();return[b.seconds,b.nanoseconds]}function nQ(a){const b=new cC(a[0],a[1]);return lC.fromTimestamp(b)}function oQ(a){const b=a.toTimestamp();return new bM(b.seconds,b.nanoseconds)}function pQ(a){const b=new cC(a.seconds,a.nanoseconds);return lC.fromTimestamp(b)}function qQ(a,b){const c=(b.baseMutations||[]).map(b=>KL(a.Gt,b));for(let d=0;d<b.mutations.length-1;++d){const e=b.mutations[d];if(d+1<b.mutations.length&& void 0!==b.mutations[d+1].transform){const f=b.mutations[d+1];e.updateTransforms=f.transform.fieldTransforms,b.mutations.splice(d+1,1),++d}}const g=b.mutations.map(b=>KL(a.Gt,b)),h=cC.fromMillis(b.localWriteTimeMs);return new yP(b.batchId,h,c,g)}function rQ(a){var b;const c=pQ(a.readTime),d=void 0!==a.lastLimboFreeSnapshotVersion?pQ(a.lastLimboFreeSnapshotVersion):lC.min();let e;return void 0!==a.query.documents?(VA(1===(b=a.query).documents.length),e=zG(sG(EL(b.documents[0])))):e=zG(NL(a.query)),new YP(e,a.targetId,0,a.lastListenSequenceNumber,c,d,nD.fromBase64String(a.resumeToken))}function sQ(a,b){const c=oQ(b.snapshotVersion),d=oQ(b.lastLimboFreeSnapshotVersion);let e;e=cF(b.target)?LL(a.Gt,b.target):ML(a.Gt,b.target);const f=b.resumeToken.toBase64();return new OM(b.targetId,aF(b.target),c,f,b.sequenceNumber,d,e)}function tQ(a){const b=NL({parent:a.parent,structuredQuery:a.structuredQuery});return"LAST"===a.limitType?AG(b,b.limit,"L"):b}function uQ(a){return xP(a,lN.store)}function vQ(a){return xP(a,pN.store)}class wQ{constructor(){this.index={}}add(xQ){const yQ=xQ.lastSegment(),zQ=xQ.popLast(),AQ=this.index[yQ]||new fJ(PC.comparator),BQ=!AQ.has(zQ);return this.index[yQ]=AQ.add(zQ),BQ}has(CQ){const DQ=CQ.lastSegment(),EQ=CQ.popLast(),FQ=this.index[DQ];return FQ&&FQ.has(EQ)}getEntries(GQ){return(this.index[GQ]||new fJ(PC.comparator)).toArray()}}function HQ(a){return xP(a,dN.store)}const IQ={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class JQ{constructor(KQ,LQ,MQ){this.cacheSizeCollectionThreshold=KQ,this.percentileToCollect=LQ,this.maximumSequenceNumbersToCollect=MQ}static withCacheSize(NQ){return new JQ(NQ,JQ.DEFAULT_COLLECTION_PERCENTILE,JQ.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function OQ(a,b,c){const d=a.store(mM.store),e=a.store(sM.store),f=[],g=IDBKeyRange.only(c.batchId);let h=0;const i=d.jt({range:g},(a,b,c)=>(h++,c.delete()));f.push(i.next(()=>{VA(1===h)}));const j=[];for(const k of c.mutations){const l=sM.key(b,k.key.path,c.batchId);f.push(e.delete(l)),j.push(k.key)}return xN.waitFor(f).next(()=>j)}function PQ(a){if(!a)return 0;let b;if(a.document)b=a.document;else if(a.unknownDocument)b=a.unknownDocument;else{if(!a.noDocument)throw UA();b=a.noDocument}return JSON.stringify(b).length}JQ.DEFAULT_COLLECTION_PERCENTILE=10,JQ.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1000,JQ.DEFAULT=new JQ(41943040,JQ.DEFAULT_COLLECTION_PERCENTILE,JQ.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),JQ.DISABLED=new JQ(-1,0,0);class QQ{constructor(RQ,SQ,TQ,UQ){this.userId=RQ,this.k=SQ,this.Jt=TQ,this.referenceDelegate=UQ,this.Yt={}}static Xt(VQ,WQ,XQ,YQ){VA(""!==VQ.uid);const ZQ=VQ.isAuthenticated()?VQ.uid:"";return new QQ(ZQ,WQ,XQ,YQ)}checkEmpty($Q){let _Q=!0;const aR=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return XR($Q).jt({index:mM.userMutationsIndex,range:aR},(a,b,c)=>{_Q=!1,c.done()}).next(()=>_Q)}addMutationBatch(bR,cR,dR,eR){const fR=YR(bR),gR=XR(bR);return gR.add({}).next(a=>{VA("number"==typeof a);const b=new yP(a,cR,dR,eR),c=function(a,b,c){const d=c.baseMutations.map(b=>JL(a.Gt,b)),e=c.mutations.map(b=>JL(a.Gt,b));return new mM(b,c.batchId,c.localWriteTime.toMillis(),d,e)}(this.k,this.userId,b),d=[];let e=new fJ((a,b)=>_B(a.canonicalString(),b.canonicalString()));for(const f of eR){const g=sM.key(this.userId,f.key.path,a);e=e.add(f.key.path.popLast()),d.push(gR.put(c)),d.push(fR.put(g,sM.PLACEHOLDER))}return e.forEach(a=>{d.push(this.Jt.addToCollectionParentIndex(bR,a))}),bR.addOnCommittedListener(()=>{this.Yt[a]=b.keys()}),xN.waitFor(d).next(()=>b)})}lookupMutationBatch(hR,iR){return XR(hR).get(iR).next(a=>a?(VA(a.userId===this.userId),qQ(this.k,a)):null)}Zt(jR,kR){return this.Yt[kR]?xN.resolve(this.Yt[kR]):this.lookupMutationBatch(jR,kR).next(a=>{if(a){const b=a.keys();return this.Yt[kR]=b,b}return null})}getNextMutationBatchAfterBatchId(lR,mR){const nR=mR+1,oR=IDBKeyRange.lowerBound([this.userId,nR]);let pR=null;return XR(lR).jt({index:mM.userMutationsIndex,range:oR},(a,b,c)=>{b.userId===this.userId&&(VA(b.batchId>=nR),pR=qQ(this.k,b)),c.done()}).next(()=>pR)}getHighestUnacknowledgedBatchId(qR){const rR=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let sR=-1;return XR(qR).jt({index:mM.userMutationsIndex,range:rR,reverse:!0},(a,b,c)=>{sR=b.batchId,c.done()}).next(()=>sR)}getAllMutationBatches(tR){const uR=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return XR(tR).Bt(mM.userMutationsIndex,uR).next(a=>a.map(a=>qQ(this.k,a)))}getAllMutationBatchesAffectingDocumentKey(vR,wR){const xR=sM.prefixForPath(this.userId,wR.path),yR=IDBKeyRange.lowerBound(xR),zR=[];return YR(vR).jt({range:yR},(a,b,c)=>{const[d,e,f]=a,g=aM(e);if(d===this.userId&&wR.path.isEqual(g))return XR(vR).get(f).next(a=>{if(!a)throw UA();VA(a.userId===this.userId),zR.push(qQ(this.k,a))});c.done()}).next(()=>zR)}getAllMutationBatchesAffectingDocumentKeys(AR,BR){let CR=new fJ(_B);const DR=[];return BR.forEach(a=>{const b=sM.prefixForPath(this.userId,a.path),c=IDBKeyRange.lowerBound(b),d=YR(AR).jt({range:c},(b,c,d)=>{const[e,f,g]=b,h=aM(f);e===this.userId&&a.path.isEqual(h)?CR=CR.add(g):d.done()});DR.push(d)}),xN.waitFor(DR).next(()=>this.te(AR,CR))}getAllMutationBatchesAffectingQuery(ER,FR){const GR=FR.path,HR=GR.length+1,IR=sM.prefixForPath(this.userId,GR),JR=IDBKeyRange.lowerBound(IR);let KR=new fJ(_B);return YR(ER).jt({range:JR},(a,b,c)=>{const[d,e,f]=a,g=aM(e);d===this.userId&&GR.isPrefixOf(g)?g.length===HR&&(KR=KR.add(f)):c.done()}).next(()=>this.te(ER,KR))}te(LR,MR){const NR=[],OR=[];return MR.forEach(a=>{OR.push(XR(LR).get(a).next(a=>{if(null===a)throw UA();VA(a.userId===this.userId),NR.push(qQ(this.k,a))}))}),xN.waitFor(OR).next(()=>NR)}removeMutationBatch(PR,QR){return OQ(PR.Wt,this.userId,QR).next(a=>(PR.addOnCommittedListener(()=>{this.ee(QR.batchId)}),xN.forEach(a,a=>this.referenceDelegate.markPotentiallyOrphaned(PR,a))))}ee(RR){delete this.Yt[RR]}performConsistencyCheck(SR){return this.checkEmpty(SR).next(a=>{if(!a)return xN.resolve();const b=IDBKeyRange.lowerBound(sM.prefixForUser(this.userId)),c=[];return YR(SR).jt({range:b},(a,b,d)=>{if(a[0]===this.userId){const e=aM(a[1]);c.push(e)}else d.done()}).next(()=>{VA(0===c.length)})})}containsKey(TR,UR){return WR(TR,this.userId,UR)}ne(VR){return ZR(VR).get(this.userId).next(a=>a||new iM(this.userId,-1,""))}}function WR(a,b,c){const d=sM.prefixForPath(b,c.path),e=d[1],f=IDBKeyRange.lowerBound(d);let g=!1;return YR(a).jt({range:f,Kt:!0},(a,c,d)=>{const[f,h,i]=a;f===b&&h===e&&(g=!0),d.done()}).next(()=>g)}function XR(a){return xP(a,mM.store)}function YR(a){return xP(a,sM.store)}function ZR(a){return xP(a,iM.store)}class $R{constructor(_R){this.se=_R}next(){return this.se+=2,this.se}static ie(){return new $R(0)}static re(){return new $R(-1)}}function aS(a){return xP(a,OM.store)}function bS(a){return xP(a,$M.store)}function cS(a){return xP(a,WM.store)}async function dS(a){if(a.code!==XA.FAILED_PRECONDITION||a.message!==uN)throw a;QA("LocalStore","Unexpectedly lost primary lease")}function eS([a,b],[c,d]){const e=_B(a,c);return 0===e?_B(b,d):e}class fS{constructor(gS){this.he=gS,this.buffer=new fJ(eS),this.le=0}fe(){return++this.le}de(hS){const iS=[hS,this.fe()];if(this.buffer.size<this.he)this.buffer=this.buffer.add(iS);else{const jS=this.buffer.last();0>eS(iS,jS)&&(this.buffer=this.buffer.delete(jS).add(iS))}}get maxValue(){return this.buffer.last()[0]}}class kS{constructor(lS,mS){this.garbageCollector=lS,this.asyncQueue=mS,this.we=!1,this._e=null}start(nS){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.me(nS)}stop(){this._e&&(this._e.cancel(),this._e=null)}get started(){return null!==this._e}me(oS){const pS=this.we?30e4:60e3;QA("LruGarbageCollector",`Garbage collection scheduled in ${pS}ms`),this._e=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",pS,async()=>{this._e=null,this.we=!0;try{await oS.collectGarbage(this.garbageCollector)}catch(a){NO(a)?QA("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",a):await dS(a)}await this.me(oS)})}}function qS(a,b){var c,d;return cS(a).put((c=b,d=a.currentSequenceNumber,new WM(0,ZL(c.path),d)))}class rS{constructor(sS,tS){this.mapKeyFn=sS,this.equalsFn=tS,this.inner={}}get(uS){const vS=this.mapKeyFn(uS),wS=this.inner[vS];if(void 0!==wS){for(const[xS,yS]of wS)if(this.equalsFn(xS,uS))return yS}}has(zS){return void 0!==this.get(zS)}set(AS,BS){const CS=this.mapKeyFn(AS),DS=this.inner[CS];if(void 0!==DS){for(let ES=0;ES<DS.length;ES++)if(this.equalsFn(DS[ES][0],AS))return void(DS[ES]=[AS,BS]);DS.push([AS,BS])}else this.inner[CS]=[[AS,BS]]}delete(FS){const GS=this.mapKeyFn(FS),HS=this.inner[GS];if(void 0===HS)return!1;for(let IS=0;IS<HS.length;IS++)if(this.equalsFn(HS[IS][0],FS))return 1===HS.length?delete this.inner[GS]:HS.splice(IS,1),!0;return!1}forEach(JS){rC(this.inner,(a,b)=>{for(const[c,d]of b)JS(c,d)})}isEmpty(){return sC(this.inner)}}class KS{constructor(){this.changes=new rS(a=>a.toString(),(a,b)=>a.isEqual(b)),this.changesApplied=!1}getReadTime(LS){const MS=this.changes.get(LS);return MS?MS.readTime:lC.min()}addEntry(NS,OS){this.assertNotApplied(),this.changes.set(NS.key,{document:NS,readTime:OS})}removeEntry(PS,QS=null){this.assertNotApplied(),this.changes.set(PS,{document:AE.newInvalidDocument(PS),readTime:QS})}getEntry(RS,SS){this.assertNotApplied();const TS=this.changes.get(SS);return void 0!==TS?xN.resolve(TS.document):this.getFromCache(RS,SS)}getEntries(US,VS){return this.getAllFromCache(US,VS)}apply(WS){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(WS)}assertNotApplied(){}}class XS extends KS{constructor(YS,ZS){super(),this.De=YS,this.trackRemovals=ZS,this.Ce=new rS(a=>a.toString(),(a,b)=>a.isEqual(b))}applyChanges($S){const _S=[];let aT=0,bT=new fJ((a,b)=>_B(a.canonicalString(),b.canonicalString()));return this.changes.forEach((a,b)=>{const c=this.Ce.get(a);if(b.document.isValidDocument()){const d=lQ(this.De.k,b.document,this.getReadTime(a));bT=bT.add(a.path.popLast());const e=PQ(d);aT+=e-c,_S.push(this.De.addEntry($S,a,d))}else if(aT-=c,this.trackRemovals){const f=lQ(this.De.k,AE.newNoDocument(a,lC.min()),this.getReadTime(a));_S.push(this.De.addEntry($S,a,f))}else _S.push(this.De.removeEntry($S,a))}),bT.forEach(a=>{_S.push(this.De.Jt.addToCollectionParentIndex($S,a))}),_S.push(this.De.updateMetadata($S,aT)),xN.waitFor(_S)}getFromCache(cT,dT){return this.De.Pe(cT,dT).next(a=>(this.Ce.set(dT,a.size),a.document))}getAllFromCache(eT,fT){return this.De.Ve(eT,fT).next(({documents:a,Se:b})=>(b.forEach((a,b)=>{this.Ce.set(a,b)}),a))}}function gT(a){return xP(a,MM.store)}function hT(a){return xP(a,FM.store)}function iT(a){return a.path.toArray()}function jT(a){a.createObjectStore(WM.store,{keyPath:WM.keyPath}).createIndex(WM.documentTargetsIndex,WM.documentTargetsKeyPath,{unique:!0}),a.createObjectStore(OM.store,{keyPath:OM.keyPath}).createIndex(OM.queryTargetsIndexName,OM.queryTargetsKeyPath,{unique:!0}),a.createObjectStore($M.store)}const kT="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class lT{constructor(mT,nT,oT,pT,qT,rT,sT,tT,uT,vT){var wT,xT;if(this.allowTabSynchronization=mT,this.persistenceKey=nT,this.clientId=oT,this.Me=qT,this.window=rT,this.document=sT,this.Fe=uT,this.Le=vT,this.Be=null,this.Ue=!1,this.isPrimary=!1,this.networkEnabled=!0,this.qe=null,this.inForeground=!1,this.Ke=null,this.je=null,this.Qe=Number.NEGATIVE_INFINITY,this.We=a=>Promise.resolve(),!lT.Pt())throw new YA(XA.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new class{constructor(yT,zT){var AT,BT;this.db=yT,AT=this,BT=zT,this.garbageCollector=new class{constructor(CT,DT){this.ge=CT,this.params=DT}calculateTargetCount(ET,FT){return this.ge.ye(ET).next(a=>Math.floor(FT/100*a))}nthSequenceNumber(GT,HT){if(0===HT)return xN.resolve(PB.I);const IT=new fS(HT);return this.ge.forEachTarget(GT,a=>IT.de(a.sequenceNumber)).next(()=>this.ge.pe(GT,a=>IT.de(a))).next(()=>IT.maxValue)}removeTargets(JT,KT,LT){return this.ge.removeTargets(JT,KT,LT)}removeOrphanedDocuments(MT,NT){return this.ge.removeOrphanedDocuments(MT,NT)}collect(OT,PT){return -1===this.params.cacheSizeCollectionThreshold?(QA("LruGarbageCollector","Garbage collection skipped; disabled"),xN.resolve(IQ)):this.getCacheSize(OT).next(a=>a<this.params.cacheSizeCollectionThreshold?(QA("LruGarbageCollector",`Garbage collection skipped; Cache size ${a} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),IQ):this.Te(OT,PT))}getCacheSize(QT){return this.ge.getCacheSize(QT)}Te(RT,ST){let TT,UT,VT,WT,XT,YT,ZT;const $T=Date.now();return this.calculateTargetCount(RT,this.params.percentileToCollect).next(a=>(a>this.params.maximumSequenceNumbersToCollect?(QA("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${a}`),UT=this.params.maximumSequenceNumbersToCollect):UT=a,WT=Date.now(),this.nthSequenceNumber(RT,UT))).next(a=>(TT=a,XT=Date.now(),this.removeTargets(RT,TT,ST))).next(a=>(VT=a,YT=Date.now(),this.removeOrphanedDocuments(RT,TT))).next(a=>(ZT=Date.now(),PA()<=ow.DEBUG&&QA("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${WT-$T}ms\n\tDetermined least recently used ${UT} in `+(XT-WT)+"ms\n"+`\tRemoved ${VT} targets in `+(YT-XT)+"ms\n"+`\tRemoved ${a} documents in `+(ZT-YT)+"ms\n"+`Total Duration: ${ZT-$T}ms`),xN.resolve({didRun:!0,sequenceNumbersCollected:UT,targetsRemoved:VT,documentsRemoved:a})))}}(AT,BT)}ye(_T){const aU=this.Ee(_T);return this.db.getTargetCache().getTargetCount(_T).next(a=>aU.next(b=>a+b))}Ee(bU){let cU=0;return this.pe(bU,a=>{cU++}).next(()=>cU)}forEachTarget(dU,eU){return this.db.getTargetCache().forEachTarget(dU,eU)}pe(fU,gU){return this.Ie(fU,(a,b)=>gU(b))}addReference(hU,iU,jU){return qS(hU,jU)}removeReference(kU,lU,mU){return qS(kU,mU)}removeTargets(nU,oU,pU){return this.db.getTargetCache().removeTargets(nU,oU,pU)}markPotentiallyOrphaned(qU,rU){return qS(qU,rU)}Ae(sU,tU){var uU,vU;let wU;return uU=sU,vU=tU,wU=!1,ZR(uU).Qt(a=>WR(uU,a,vU).next(a=>(a&&(wU=!0),xN.resolve(!a)))).next(()=>wU)}removeOrphanedDocuments(xU,yU){const zU=this.db.getRemoteDocumentCache().newChangeBuffer(),AU=[];let BU=0;return this.Ie(xU,(a,b)=>{if(b<=yU){const c=this.Ae(xU,a).next(b=>{if(!b)return BU++,zU.getEntry(xU,a).next(()=>(zU.removeEntry(a),cS(xU).delete([0,ZL(a.path)])))});AU.push(c)}}).next(()=>xN.waitFor(AU)).next(()=>zU.apply(xU)).next(()=>BU)}removeTarget(CU,DU){const EU=DU.withSequenceNumber(CU.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(CU,EU)}updateLimboDocument(FU,GU){return qS(FU,GU)}Ie(HU,IU){const JU=cS(HU);let KU,LU=PB.I;return JU.jt({index:WM.documentTargetsIndex},([a,b],{path:c,sequenceNumber:d})=>{0===a?(LU!==PB.I&&IU(new GD(aM(KU)),LU),LU=d,KU=c):LU=PB.I}).next(()=>{LU!==PB.I&&IU(new GD(aM(KU)),LU)})}getCacheSize(MU){return this.db.getRemoteDocumentCache().getSize(MU)}}(this,pT),this.Ge=nT+"main",this.k=new iQ(tT),this.ze=new bO(this.Ge,11,new class{constructor(NU){this.k=NU}Nt(OU,PU,QU,RU){var SU,TU;VA(QU<RU&&QU>=0&&RU<=11);const UU=new SN("createOrUpgrade",PU);QU<1&&RU>=1&&((function(a){a.createObjectStore(eM.store)})(OU),(SU=OU).createObjectStore(iM.store,{keyPath:iM.keyPath}),SU.createObjectStore(mM.store,{keyPath:mM.keyPath,autoIncrement:!0}).createIndex(mM.userMutationsIndex,mM.userMutationsKeyPath,{unique:!0}),SU.createObjectStore(sM.store),jT(OU),(function(a){a.createObjectStore(FM.store)})(OU));let VU=xN.resolve();return QU<3&&RU>=3&&(0!==QU&&((TU=OU).deleteObjectStore(WM.store),TU.deleteObjectStore(OM.store),TU.deleteObjectStore($M.store),jT(OU)),VU=VU.next(()=>(function(a){const b=a.store($M.store),c=new $M(0,0,lC.min().toTimestamp(),0);return b.put($M.key,c)})(UU))),QU<4&&RU>=4&&(0!==QU&&(VU=VU.next(()=>{var a,b;return a=OU,(b=UU).store(mM.store).Bt().next(c=>{a.deleteObjectStore(mM.store),a.createObjectStore(mM.store,{keyPath:mM.keyPath,autoIncrement:!0}).createIndex(mM.userMutationsIndex,mM.userMutationsKeyPath,{unique:!0});const d=b.store(mM.store),e=c.map(a=>d.put(a));return xN.waitFor(e)})})),VU=VU.next(()=>{!function(a){a.createObjectStore(gN.store,{keyPath:gN.keyPath})}(OU)})),QU<5&&RU>=5&&(VU=VU.next(()=>this.Ne(UU))),QU<6&&RU>=6&&(VU=VU.next(()=>((function(a){a.createObjectStore(MM.store)})(OU),this.ke(UU)))),QU<7&&RU>=7&&(VU=VU.next(()=>this.xe(UU))),QU<8&&RU>=8&&(VU=VU.next(()=>this.$e(OU,UU))),QU<9&&RU>=9&&(VU=VU.next(()=>{var a;(a=OU).objectStoreNames.contains("remoteDocumentChanges")&&a.deleteObjectStore("remoteDocumentChanges"),(function(a){const b=a.objectStore(FM.store);b.createIndex(FM.readTimeIndex,FM.readTimeIndexPath,{unique:!1}),b.createIndex(FM.collectionReadTimeIndex,FM.collectionReadTimeIndexPath,{unique:!1})})(PU)})),QU<10&&RU>=10&&(VU=VU.next(()=>this.Oe(UU))),QU<11&&RU>=11&&(VU=VU.next(()=>{(function(a){a.createObjectStore(lN.store,{keyPath:lN.keyPath})})(OU),(function(a){a.createObjectStore(pN.store,{keyPath:pN.keyPath})})(OU)})),VU}ke(WU){let XU=0;return WU.store(FM.store).jt((a,b)=>{XU+=PQ(b)}).next(()=>{const a=new MM(XU);return WU.store(MM.store).put(MM.key,a)})}Ne(YU){const ZU=YU.store(iM.store),$U=YU.store(mM.store);return ZU.Bt().next(a=>xN.forEach(a,a=>{const b=IDBKeyRange.bound([a.userId,-1],[a.userId,a.lastAcknowledgedBatchId]);return $U.Bt(mM.userMutationsIndex,b).next(b=>xN.forEach(b,b=>{VA(b.userId===a.userId);const c=qQ(this.k,b);return OQ(YU,a.userId,c).next(()=>{})}))}))}xe(_U){const aV=_U.store(WM.store),bV=_U.store(FM.store);return _U.store($M.store).get($M.key).next(a=>{const b=[];return bV.jt((c,d)=>{var e;const f=new PC(c),g=(e=f,[0,ZL(e)]);b.push(aV.get(g).next(b=>{var c;return b?xN.resolve():(c=f,aV.put(new WM(0,ZL(c),a.highestListenSequenceNumber)))}))}).next(()=>xN.waitFor(b))})}$e(cV,dV){cV.createObjectStore(dN.store,{keyPath:dN.keyPath});const eV=dV.store(dN.store),fV=new wQ,gV=a=>{if(fV.add(a)){const b=a.lastSegment(),c=a.popLast();return eV.put({collectionId:b,parent:ZL(c)})}};return dV.store(FM.store).jt({Kt:!0},(a,b)=>{const c=new PC(a);return gV(c.popLast())}).next(()=>dV.store(sM.store).jt({Kt:!0},([a,b,c],d)=>{const e=aM(b);return gV(e.popLast())}))}Oe(hV){const iV=hV.store(OM.store);return iV.jt((a,b)=>{const c=rQ(b),d=sQ(this.k,c);return iV.put(d)})}}(this.k)),this.He=new class{constructor(jV,kV){this.referenceDelegate=jV,this.k=kV}allocateTargetId(lV){return this.oe(lV).next(a=>{const b=new $R(a.highestTargetId);return a.highestTargetId=b.next(),this.ce(lV,a).next(()=>a.highestTargetId)})}getLastRemoteSnapshotVersion(mV){return this.oe(mV).next(a=>lC.fromTimestamp(new cC(a.lastRemoteSnapshotVersion.seconds,a.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(nV){return this.oe(nV).next(a=>a.highestListenSequenceNumber)}setTargetsMetadata(oV,pV,qV){return this.oe(oV).next(a=>(a.highestListenSequenceNumber=pV,qV&&(a.lastRemoteSnapshotVersion=qV.toTimestamp()),pV>a.highestListenSequenceNumber&&(a.highestListenSequenceNumber=pV),this.ce(oV,a)))}addTargetData(rV,sV){return this.ae(rV,sV).next(()=>this.oe(rV).next(a=>(a.targetCount+=1,this.ue(sV,a),this.ce(rV,a))))}updateTargetData(tV,uV){return this.ae(tV,uV)}removeTargetData(vV,wV){return this.removeMatchingKeysForTargetId(vV,wV.targetId).next(()=>aS(vV).delete(wV.targetId)).next(()=>this.oe(vV)).next(a=>(VA(a.targetCount>0),a.targetCount-=1,this.ce(vV,a)))}removeTargets(xV,yV,zV){let AV=0;const BV=[];return aS(xV).jt((a,b)=>{const c=rQ(b);c.sequenceNumber<=yV&&null===zV.get(c.targetId)&&(AV++,BV.push(this.removeTargetData(xV,c)))}).next(()=>xN.waitFor(BV)).next(()=>AV)}forEachTarget(CV,DV){return aS(CV).jt((a,b)=>{const c=rQ(b);DV(c)})}oe(EV){return bS(EV).get($M.key).next(a=>(VA(null!==a),a))}ce(FV,GV){return bS(FV).put($M.key,GV)}ae(HV,IV){return aS(HV).put(sQ(this.k,IV))}ue(JV,KV){let LV=!1;return JV.targetId>KV.highestTargetId&&(KV.highestTargetId=JV.targetId,LV=!0),JV.sequenceNumber>KV.highestListenSequenceNumber&&(KV.highestListenSequenceNumber=JV.sequenceNumber,LV=!0),LV}getTargetCount(MV){return this.oe(MV).next(a=>a.targetCount)}getTargetData(NV,OV){const PV=aF(OV),QV=IDBKeyRange.bound([PV,Number.NEGATIVE_INFINITY],[PV,Number.POSITIVE_INFINITY]);let RV=null;return aS(NV).jt({range:QV,index:OM.queryTargetsIndexName},(a,b,c)=>{const d=rQ(b);bF(OV,d.target)&&(RV=d,c.done())}).next(()=>RV)}addMatchingKeys(SV,TV,UV){const VV=[],WV=cS(SV);return TV.forEach(a=>{const b=ZL(a.path);VV.push(WV.put(new WM(UV,b))),VV.push(this.referenceDelegate.addReference(SV,UV,a))}),xN.waitFor(VV)}removeMatchingKeys(XV,YV,ZV){const $V=cS(XV);return xN.forEach(YV,a=>{const b=ZL(a.path);return xN.waitFor([$V.delete([ZV,b]),this.referenceDelegate.removeReference(XV,ZV,a)])})}removeMatchingKeysForTargetId(_V,aW){const bW=cS(_V),cW=IDBKeyRange.bound([aW],[aW+1],!1,!0);return bW.delete(cW)}getMatchingKeysForTargetId(dW,eW){const fW=IDBKeyRange.bound([eW],[eW+1],!1,!0),gW=cS(dW);let hW=QJ();return gW.jt({range:fW,Kt:!0},(a,b,c)=>{const d=aM(a[1]),e=new GD(d);hW=hW.add(e)}).next(()=>hW)}containsKey(iW,jW){const kW=ZL(jW.path),lW=IDBKeyRange.bound([kW],[bC(kW)],!1,!0);let mW=0;return cS(iW).jt({index:WM.documentTargetsIndex,Kt:!0,range:lW},([a,b],c,d)=>{0!==a&&(mW++,d.done())}).next(()=>mW>0)}Et(nW,oW){return aS(nW).get(oW).next(a=>a?rQ(a):null)}}(this.referenceDelegate,this.k),this.Jt=new class{constructor(){this.Ht=new wQ}addToCollectionParentIndex(pW,qW){if(!this.Ht.has(qW)){const rW=qW.lastSegment(),sW=qW.popLast();pW.addOnCommittedListener(()=>{this.Ht.add(qW)});const tW={collectionId:rW,parent:ZL(sW)};return HQ(pW).put(tW)}return xN.resolve()}getCollectionParents(uW,vW){const wW=[],xW=IDBKeyRange.bound([vW,""],[bC(vW),""],!1,!0);return HQ(uW).Bt(xW).next(a=>{for(const b of a){if(b.collectionId!==vW)break;wW.push(aM(b.parent))}return wW})}},wT=this.k,xT=this.Jt,this.Je=new class{constructor(yW,zW){this.k=yW,this.Jt=zW}addEntry(AW,BW,CW){return hT(AW).put(iT(BW),CW)}removeEntry(DW,EW){const FW=hT(DW),GW=iT(EW);return FW.delete(GW)}updateMetadata(HW,IW){return this.getMetadata(HW).next(a=>(a.byteSize+=IW,this.Re(HW,a)))}getEntry(JW,KW){return hT(JW).get(iT(KW)).next(a=>this.be(KW,a))}Pe(LW,MW){return hT(LW).get(iT(MW)).next(a=>({document:this.be(MW,a),size:PQ(a)}))}getEntries(NW,OW){let PW=KJ();return this.ve(NW,OW,(a,b)=>{const c=this.be(a,b);PW=PW.insert(a,c)}).next(()=>PW)}Ve(QW,RW){let SW=KJ(),TW=new PH(GD.comparator);return this.ve(QW,RW,(a,b)=>{const c=this.be(a,b);SW=SW.insert(a,c),TW=TW.insert(a,PQ(b))}).next(()=>({documents:SW,Se:TW}))}ve(UW,VW,WW){if(VW.isEmpty())return xN.resolve();const XW=IDBKeyRange.bound(VW.first().path.toArray(),VW.last().path.toArray()),YW=VW.getIterator();let ZW=YW.getNext();return hT(UW).jt({range:XW},(a,b,c)=>{const d=GD.fromSegments(a);for(;ZW&&0>GD.comparator(ZW,d);)WW(ZW,null),ZW=YW.getNext();ZW&&ZW.isEqual(d)&&(WW(ZW,b),ZW=YW.hasNext()?YW.getNext():null),ZW?c.Lt(ZW.path.toArray()):c.done()}).next(()=>{for(;ZW;)WW(ZW,null),ZW=YW.hasNext()?YW.getNext():null})}getDocumentsMatchingQuery($W,_W,aX){let bX=KJ();const cX=_W.path.length+1,dX={};if(aX.isEqual(lC.min())){const eX=_W.path.toArray();dX.range=IDBKeyRange.lowerBound(eX)}else{const fX=_W.path.toArray(),gX=mQ(aX);dX.range=IDBKeyRange.lowerBound([fX,gX],!0),dX.index=FM.collectionReadTimeIndex}return hT($W).jt(dX,(a,b,c)=>{if(a.length===cX){const d=kQ(this.k,b);_W.path.isPrefixOf(d.key.path)?EG(_W,d)&&(bX=bX.insert(d.key,d)):c.done()}}).next(()=>bX)}newChangeBuffer(hX){return new XS(this,!!hX&&hX.trackRemovals)}getSize(iX){return this.getMetadata(iX).next(a=>a.byteSize)}getMetadata(jX){return gT(jX).get(MM.key).next(a=>(VA(!!a),a))}Re(kX,lX){return gT(kX).put(MM.key,lX)}be(mX,nX){if(nX){const oX=kQ(this.k,nX);if(!(oX.isNoDocument()&&oX.version.isEqual(lC.min())))return oX}return AE.newInvalidDocument(mX)}}(wT,xT),this.Ye=new class{getBundleMetadata(pX,qX){return uQ(pX).get(qX).next(a=>{var b;if(a)return{id:(b=a).bundleId,createTime:pQ(b.createTime),version:b.version}})}saveBundleMetadata(rX,sX){var tX;return uQ(rX).put({bundleId:(tX=sX).id,createTime:oQ(yL(tX.createTime)),version:tX.version})}getNamedQuery(uX,vX){return vQ(uX).get(vX).next(a=>{var b;if(a)return{name:(b=a).name,query:tQ(b.bundledQuery),readTime:pQ(b.readTime)}})}saveNamedQuery(wX,xX){var yX;return vQ(wX).put({name:(yX=xX).name,readTime:oQ(yL(yX.readTime)),bundledQuery:yX.bundledQuery})}},this.window&&this.window.localStorage?this.Xe=this.window.localStorage:(this.Xe=null,!1===vT&&RA("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ze().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new YA(XA.FAILED_PRECONDITION,kT);return this.tn(),this.en(),this.nn(),this.runTransaction("getHighestListenSequenceNumber","readonly",a=>this.He.getHighestSequenceNumber(a))}).then(a=>{this.Be=new PB(a,this.Fe)}).then(()=>{this.Ue=!0}).catch(a=>(this.ze&&this.ze.close(),Promise.reject(a)))}sn(zX){return this.We=async a=>{if(this.started)return zX(a)},zX(this.isPrimary)}setDatabaseDeletedListener(AX){this.ze.xt(async a=>{null===a.newVersion&&await AX()})}setNetworkEnabled(BX){this.networkEnabled!==BX&&(this.networkEnabled=BX,this.Me.enqueueAndForget(async()=>{this.started&&await this.Ze()}))}Ze(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",a=>eY(a).put(new gN(this.clientId,Date.now(),this.networkEnabled,this.inForeground)).next(()=>{if(this.isPrimary)return this.rn(a).next(a=>{a||(this.isPrimary=!1,this.Me.enqueueRetryable(()=>this.We(!1)))})}).next(()=>this.on(a)).next(b=>this.isPrimary&&!b?this.cn(a).next(()=>!1):!!b&&this.an(a).next(()=>!0))).catch(a=>{if(NO(a))return QA("IndexedDbPersistence","Failed to extend owner lease: ",a),this.isPrimary;if(!this.allowTabSynchronization)throw a;return QA("IndexedDbPersistence","Releasing owner lease after error during lease refresh",a),!1}).then(a=>{this.isPrimary!==a&&this.Me.enqueueRetryable(()=>this.We(a)),this.isPrimary=a})}rn(CX){return dY(CX).get(eM.key).next(a=>xN.resolve(this.un(a)))}hn(DX){return eY(DX).delete(this.clientId)}async ln(){if(this.isPrimary&&!this.fn(this.Qe,180e4)){this.Qe=Date.now();const EX=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",a=>{const b=xP(a,gN.store);return b.Bt().next(a=>{const c=this.dn(a,180e4),d=a.filter(a=>-1===c.indexOf(a));return xN.forEach(d,a=>b.delete(a.clientId)).next(()=>d)})}).catch(()=>[]);if(this.Xe)for(const FX of EX)this.Xe.removeItem(this.wn(FX.clientId))}}nn(){this.je=this.Me.enqueueAfterDelay("client_metadata_refresh",4000,()=>this.Ze().then(()=>this.ln()).then(()=>this.nn()))}un(GX){return!!GX&&GX.ownerId===this.clientId}on(HX){return this.Le?xN.resolve(!0):dY(HX).get(eM.key).next(a=>{if(null!==a&&this.fn(a.leaseTimestampMs,5000)&&!this._n(a.ownerId)){if(this.un(a)&&this.networkEnabled)return!0;if(!this.un(a)){if(!a.allowTabSynchronization)throw new YA(XA.FAILED_PRECONDITION,kT);return!1}}return!(!this.networkEnabled||!this.inForeground)||eY(HX).Bt().next(a=>void 0===this.dn(a,5000).find(a=>{if(this.clientId!==a.clientId){const b=!this.networkEnabled&&a.networkEnabled,c=!this.inForeground&&a.inForeground,d=this.networkEnabled===a.networkEnabled;if(b||c&&d)return!0}return!1}))}).next(a=>(this.isPrimary!==a&&QA("IndexedDbPersistence",`Client ${a?"is":"is not"} eligible for a primary lease.`),a))}async shutdown(){this.Ue=!1,this.mn(),this.je&&(this.je.cancel(),this.je=null),this.gn(),this.yn(),await this.ze.runTransaction("shutdown","readwrite",[eM.store,gN.store],a=>{const b=new uP(a,PB.I);return this.cn(b).next(()=>this.hn(b))}),this.ze.close(),this.pn()}dn(IX,JX){return IX.filter(a=>this.fn(a.updateTimeMs,JX)&&!this._n(a.clientId))}Tn(){return this.runTransaction("getActiveClients","readonly",a=>eY(a).Bt().next(a=>this.dn(a,180e4).map(a=>a.clientId)))}get started(){return this.Ue}getMutationQueue(KX){return QQ.Xt(KX,this.k,this.Jt,this.referenceDelegate)}getTargetCache(){return this.He}getRemoteDocumentCache(){return this.Je}getIndexManager(){return this.Jt}getBundleCache(){return this.Ye}runTransaction(LX,MX,NX){QA("IndexedDbPersistence","Starting transaction:",LX);let OX;return this.ze.runTransaction(LX,"readonly"===MX?"readonly":"readwrite",tN,a=>(OX=new uP(a,this.Be?this.Be.next():PB.I),"readwrite-primary"===MX?this.rn(OX).next(a=>!!a||this.on(OX)).next(a=>{if(!a)throw RA(`Failed to obtain primary lease for action '${LX}'.`),this.isPrimary=!1,this.Me.enqueueRetryable(()=>this.We(!1)),new YA(XA.FAILED_PRECONDITION,uN);return NX(OX)}).next(a=>this.an(OX).next(()=>a)):this.En(OX).next(()=>NX(OX)))).then(a=>(OX.raiseOnCommittedEvent(),a))}En(PX){return dY(PX).get(eM.key).next(a=>{if(null!==a&&this.fn(a.leaseTimestampMs,5000)&&!this._n(a.ownerId)&&!this.un(a)&&!(this.Le||this.allowTabSynchronization&&a.allowTabSynchronization))throw new YA(XA.FAILED_PRECONDITION,kT)})}an(QX){const RX=new eM(this.clientId,this.allowTabSynchronization,Date.now());return dY(QX).put(eM.key,RX)}static Pt(){return bO.Pt()}cn(SX){const TX=dY(SX);return TX.get(eM.key).next(a=>this.un(a)?(QA("IndexedDbPersistence","Releasing primary lease."),TX.delete(eM.key)):xN.resolve())}fn(UX,VX){const WX=Date.now();return!(UX<WX-VX)&&(!(UX>WX)||(RA(`Detected an update time that is in the future: ${UX} > ${WX}`),!1))}tn(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ke=()=>{this.Me.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.Ze()))},this.document.addEventListener("visibilitychange",this.Ke),this.inForeground="visible"===this.document.visibilityState)}gn(){this.Ke&&(this.document.removeEventListener("visibilitychange",this.Ke),this.Ke=null)}en(){var XX;"function"==typeof(null===(XX=this.window)|| void 0===XX?void 0:XX.addEventListener)&&(this.qe=()=>{this.mn(),!D()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")&&navigator.appVersion.match(/Version\/1[45]/)&&this.Me.enterRestrictedMode(!0),this.Me.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.qe))}yn(){this.qe&&(this.window.removeEventListener("pagehide",this.qe),this.qe=null)}_n(YX){var ZX;try{const $X=null!==(null===(ZX=this.Xe)|| void 0===ZX?void 0:ZX.getItem(this.wn(YX)));return QA("IndexedDbPersistence",`Client '${YX}' ${$X?"is":"is not"} zombied in LocalStorage`),$X}catch(_X){return RA("IndexedDbPersistence","Failed to get zombied client id.",_X),!1}}mn(){if(this.Xe)try{this.Xe.setItem(this.wn(this.clientId),String(Date.now()))}catch(aY){RA("Failed to set zombie client id.",aY)}}pn(){if(this.Xe)try{this.Xe.removeItem(this.wn(this.clientId))}catch(bY){}}wn(cY){return`firestore_zombie_${this.persistenceKey}_${cY}`}}function dY(a){return xP(a,eM.store)}function eY(a){return xP(a,gN.store)}function fY(a,b){let c=a.projectId;return a.isDefaultDatabase||(c+="."+a.database),"firestore/"+b+"/"+c+"/"}class gY{constructor(hY,iY){this.progress=hY,this.In=iY}}class jY{constructor(kY,lY,mY){this.Je=kY,this.An=lY,this.Jt=mY}Rn(nY,oY){return this.An.getAllMutationBatchesAffectingDocumentKey(nY,oY).next(a=>this.bn(nY,oY,a))}bn(pY,qY,rY){return this.Je.getEntry(pY,qY).next(a=>{for(const b of rY)b.applyToLocalView(a);return a})}Pn(sY,tY){sY.forEach((a,b)=>{for(const c of tY)c.applyToLocalView(b)})}vn(uY,vY){return this.Je.getEntries(uY,vY).next(a=>this.Vn(uY,a).next(()=>a))}Vn(wY,xY){return this.An.getAllMutationBatchesAffectingDocumentKeys(wY,xY).next(a=>this.Pn(xY,a))}getDocumentsMatchingQuery(yY,zY,AY){var BY;return(BY=zY,GD.isDocumentKey(BY.path)&&null===BY.collectionGroup&&0===BY.filters.length)?this.Sn(yY,zY.path):xG(zY)?this.Dn(yY,zY,AY):this.Cn(yY,zY,AY)}Sn(CY,DY){return this.Rn(CY,new GD(DY)).next(a=>{let b=MJ();return a.isFoundDocument()&&(b=b.insert(a.key,a)),b})}Dn(EY,FY,GY){const HY=FY.collectionGroup;let IY=MJ();return this.Jt.getCollectionParents(EY,HY).next(a=>xN.forEach(a,a=>{var b,c;const d=(b=FY,c=a.child(HY),new iG(c,null,b.explicitOrderBy.slice(),b.filters.slice(),b.limit,b.limitType,b.startAt,b.endAt));return this.Cn(EY,d,GY).next(a=>{a.forEach((a,b)=>{IY=IY.insert(a,b)})})}).next(()=>IY))}Cn(JY,KY,LY){let MY,NY;return this.Je.getDocumentsMatchingQuery(JY,KY,LY).next(a=>(MY=a,this.An.getAllMutationBatchesAffectingQuery(JY,KY))).next(a=>(NY=a,this.Nn(JY,NY,MY).next(a=>{for(const b of(MY=a,NY))for(const c of b.mutations){const d=c.key;let e=MY.get(d);null==e&&(e=AE.newInvalidDocument(d),MY=MY.insert(d,e)),nH(c,e,b.localWriteTime),e.isFoundDocument()||(MY=MY.remove(d))}}))).next(()=>(MY.forEach((a,b)=>{EG(KY,b)||(MY=MY.remove(a))}),MY))}Nn(OY,PY,QY){let RY=QJ();for(const SY of PY)for(const TY of SY.mutations)TY instanceof wH&&null===QY.get(TY.key)&&(RY=RY.add(TY.key));let UY=QY;return this.Je.getEntries(OY,RY).next(a=>(a.forEach((a,b)=>{b.isFoundDocument()&&(UY=UY.insert(a,b))}),UY))}}class VY{constructor(WY,XY,YY,ZY){this.targetId=WY,this.fromCache=XY,this.kn=YY,this.xn=ZY}static $n($Y,_Y){let aZ=QJ(),bZ=QJ();for(const cZ of _Y.docChanges)switch(cZ.type){case 0:aZ=aZ.add(cZ.doc.key);break;case 1:bZ=bZ.add(cZ.doc.key)}return new VY($Y,_Y.fromCache,aZ,bZ)}}class dZ{On(eZ){this.Mn=eZ}getDocumentsMatchingQuery(fZ,gZ,hZ,iZ){var jZ;return 0===(jZ=gZ).filters.length&&null===jZ.limit&&null==jZ.startAt&&null==jZ.endAt&&(0===jZ.explicitOrderBy.length||1===jZ.explicitOrderBy.length&&jZ.explicitOrderBy[0].field.isKeyField())||hZ.isEqual(lC.min())?this.Fn(fZ,gZ):this.Mn.vn(fZ,iZ).next(a=>{const b=this.Ln(gZ,a);return(tG(gZ)||uG(gZ))&&this.Bn(gZ.limitType,b,iZ,hZ)?this.Fn(fZ,gZ):(PA()<=ow.DEBUG&&QA("QueryEngine","Re-using previous result from %s to execute query: %s",hZ.toString(),DG(gZ)),this.Mn.getDocumentsMatchingQuery(fZ,gZ,hZ).next(a=>(b.forEach(b=>{a=a.insert(b.key,b)}),a)))})}Ln(kZ,lZ){let mZ=new fJ(FG(kZ));return lZ.forEach((a,b)=>{EG(kZ,b)&&(mZ=mZ.add(b))}),mZ}Bn(nZ,oZ,pZ,qZ){if(pZ.size!==oZ.size)return!0;const rZ="F"===nZ?oZ.last():oZ.first();return!!rZ&&(rZ.hasPendingWrites||rZ.version.compareTo(qZ)>0)}Fn(sZ,tZ){return PA()<=ow.DEBUG&&QA("QueryEngine","Using full collection scan to execute query:",DG(tZ)),this.Mn.getDocumentsMatchingQuery(sZ,tZ,lC.min())}}class uZ{constructor(vZ,wZ,xZ,yZ){this.persistence=vZ,this.Un=wZ,this.k=yZ,this.qn=new PH(_B),this.Kn=new rS(a=>aF(a),bF),this.jn=lC.min(),this.An=vZ.getMutationQueue(xZ),this.Qn=vZ.getRemoteDocumentCache(),this.He=vZ.getTargetCache(),this.Wn=new jY(this.Qn,this.An,this.persistence.getIndexManager()),this.Ye=vZ.getBundleCache(),this.Un.On(this.Wn)}collectGarbage(zZ){return this.persistence.runTransaction("Collect garbage","readwrite-primary",a=>zZ.collect(a,this.qn))}}function AZ(a,b,c,d){return new uZ(a,b,c,d)}async function BZ(a,b){const c=WA(a);let d=c.An,e=c.Wn;const f=await c.persistence.runTransaction("Handle user change","readonly",a=>{let f;return c.An.getAllMutationBatches(a).next(g=>(f=g,d=c.persistence.getMutationQueue(b),e=new jY(c.Qn,d,c.persistence.getIndexManager()),d.getAllMutationBatches(a))).next(b=>{const c=[],d=[];let g=QJ();for(const h of f)for(const i of(c.push(h.batchId),h.mutations))g=g.add(i.key);for(const j of b)for(const k of(d.push(j.batchId),j.mutations))g=g.add(k.key);return e.vn(a,g).next(a=>({Gn:a,removedBatchIds:c,addedBatchIds:d}))})});return c.An=d,c.Wn=e,c.Un.On(c.Wn),f}function CZ(a){const b=WA(a);return b.persistence.runTransaction("Get last remote snapshot version","readonly",a=>b.He.getLastRemoteSnapshotVersion(a))}function DZ(a,b,c,d,e){let f=QJ();return c.forEach(a=>f=f.add(a)),b.getEntries(a,f).next(a=>{let f=KJ();return c.forEach((c,g)=>{const h=a.get(c),i=(null==e?void 0:e.get(c))||d;g.isNoDocument()&&g.version.isEqual(lC.min())?(b.removeEntry(c,i),f=f.insert(c,g)):!h.isValidDocument()||g.version.compareTo(h.version)>0||0===g.version.compareTo(h.version)&&h.hasPendingWrites?(b.addEntry(g,i),f=f.insert(c,g)):QA("LocalStore","Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",g.version)}),f})}function EZ(a,b){const c=WA(a);return c.persistence.runTransaction("Get next mutation batch","readonly",a=>(void 0===b&&(b=-1),c.An.getNextMutationBatchAfterBatchId(a,b)))}function FZ(a,b){const c=WA(a);return c.persistence.runTransaction("Allocate target","readwrite",a=>{let d;return c.He.getTargetData(a,b).next(e=>e?(d=e,xN.resolve(d)):c.He.allocateTargetId(a).next(e=>(d=new YP(b,e,0,a.currentSequenceNumber),c.He.addTargetData(a,d).next(()=>d))))}).then(a=>{const d=c.qn.get(a.targetId);return(null===d||a.snapshotVersion.compareTo(d.snapshotVersion)>0)&&(c.qn=c.qn.insert(a.targetId,a),c.Kn.set(b,a.targetId)),a})}async function GZ(a,b,c){const d=WA(a),e=d.qn.get(b);try{c||await d.persistence.runTransaction("Release target",c?"readwrite":"readwrite-primary",a=>d.persistence.referenceDelegate.removeTarget(a,e))}catch(f){if(!NO(f))throw f;QA("LocalStore",`Failed to update sequence numbers for target ${b}: ${f}`)}d.qn=d.qn.remove(b),d.Kn.delete(e.target)}function HZ(a,b,c){const d=WA(a);let e=lC.min(),f=QJ();return d.persistence.runTransaction("Execute query","readonly",a=>(function(a,b,c){const d=WA(a),e=d.Kn.get(c);return void 0!==e?xN.resolve(d.qn.get(e)):d.He.getTargetData(b,c)})(d,a,zG(b)).next(b=>{if(b)return e=b.lastLimboFreeSnapshotVersion,d.He.getMatchingKeysForTargetId(a,b.targetId).next(a=>{f=a})}).next(()=>d.Un.getDocumentsMatchingQuery(a,b,c?e:lC.min(),c?f:QJ())).next(a=>({documents:a,zn:f})))}function IZ(a,b){const c=WA(a),d=WA(c.He),e=c.qn.get(b);return e?Promise.resolve(e.target):c.persistence.runTransaction("Get target data","readonly",a=>d.Et(a,b).next(a=>a?a.target:null))}function JZ(a){const b=WA(a);return b.persistence.runTransaction("Get new document changes","readonly",a=>(function(a,b,c){const d=WA(a);let e=KJ(),f=mQ(c);const g=hT(b),h=IDBKeyRange.lowerBound(f,!0);return g.jt({index:FM.readTimeIndex,range:h},(a,b)=>{const c=kQ(d.k,b);e=e.insert(c.key,c),f=b.readTime}).next(()=>({In:e,readTime:nQ(f)}))})(b.Qn,a,b.jn)).then(({In:a,readTime:c})=>(b.jn=c,a))}async function KZ(a){const b=WA(a);return b.persistence.runTransaction("Synchronize last document change read time","readonly",a=>(function(a){const b=hT(a);let c=lC.min();return b.jt({index:FM.readTimeIndex,reverse:!0},(a,b,d)=>{b.readTime&&(c=nQ(b.readTime)),d.done()}).next(()=>c)})(a)).then(a=>{b.jn=a})}async function LZ(a,b,c,d){var e;const f=WA(a);let g=QJ(),h=KJ(),i=OJ();for(const j of c){const k=b.Hn(j.metadata.name);j.document&&(g=g.add(k)),h=h.insert(k,b.Jn(j)),i=i.insert(k,b.Yn(j.metadata.readTime))}const l=f.Qn.newChangeBuffer({trackRemovals:!0}),m=await FZ(f,(e=d,zG(sG(PC.fromString(`__bundle__/docs/${e}`)))));return f.persistence.runTransaction("Apply bundle documents","readwrite",a=>DZ(a,l,h,lC.min(),i).next(b=>(l.apply(a),b)).next(b=>f.He.removeMatchingKeysForTargetId(a,m.targetId).next(()=>f.He.addMatchingKeys(a,g,m.targetId)).next(()=>f.Wn.Vn(a,b)).next(()=>b)))}async function MZ(a,b,c=QJ()){const d=await FZ(a,zG(tQ(b.bundledQuery))),e=WA(a);return e.persistence.runTransaction("Save named query","readwrite",a=>{const f=yL(b.readTime);if(d.snapshotVersion.compareTo(f)>=0)return e.Ye.saveNamedQuery(a,b);const g=d.withResumeToken(nD.EMPTY_BYTE_STRING,f);return e.qn=e.qn.insert(g.targetId,g),e.He.updateTargetData(a,g).next(()=>e.He.removeMatchingKeysForTargetId(a,d.targetId)).next(()=>e.He.addMatchingKeys(a,c,d.targetId)).next(()=>e.Ye.saveNamedQuery(a,b))})}class NZ{constructor(){this.ts=new fJ(j$.es),this.ns=new fJ(j$.ss)}isEmpty(){return this.ts.isEmpty()}addReference(OZ,PZ){const QZ=new j$(OZ,PZ);this.ts=this.ts.add(QZ),this.ns=this.ns.add(QZ)}rs(RZ,SZ){RZ.forEach(a=>this.addReference(a,SZ))}removeReference(TZ,UZ){this.os(new j$(TZ,UZ))}cs(VZ,WZ){VZ.forEach(a=>this.removeReference(a,WZ))}us(XZ){const YZ=new GD(new PC([])),ZZ=new j$(YZ,XZ),$Z=new j$(YZ,XZ+1),_Z=[];return this.ns.forEachInRange([ZZ,$Z],a=>{this.os(a),_Z.push(a.key)}),_Z}hs(){this.ts.forEach(a=>this.os(a))}os(a$){this.ts=this.ts.delete(a$),this.ns=this.ns.delete(a$)}ls(b$){const c$=new GD(new PC([])),d$=new j$(c$,b$),e$=new j$(c$,b$+1);let f$=QJ();return this.ns.forEachInRange([d$,e$],a=>{f$=f$.add(a.key)}),f$}containsKey(g$){const h$=new j$(g$,0),i$=this.ts.firstAfterOrEqual(h$);return null!==i$&&g$.isEqual(i$.key)}}class j${constructor(k$,l$){this.key=k$,this.fs=l$}static es(m$,n$){return GD.comparator(m$.key,n$.key)||_B(m$.fs,n$.fs)}static ss(o$,p$){return _B(o$.fs,p$.fs)||GD.comparator(o$.key,p$.key)}}class q${constructor(r$,s$){this.Jt=r$,this.referenceDelegate=s$,this.An=[],this.ds=1,this.ws=new fJ(j$.es)}checkEmpty(t$){return xN.resolve(0===this.An.length)}addMutationBatch(u$,v$,w$,x$){const y$=this.ds;this.ds++,this.An.length>0&&this.An[this.An.length-1];const z$=new yP(y$,v$,w$,x$);for(const A$ of(this.An.push(z$),x$))this.ws=this.ws.add(new j$(A$.key,y$)),this.Jt.addToCollectionParentIndex(u$,A$.key.path.popLast());return xN.resolve(z$)}lookupMutationBatch(B$,C$){return xN.resolve(this._s(C$))}getNextMutationBatchAfterBatchId(D$,E$){const F$=this.gs(E$+1),G$=F$<0?0:F$;return xN.resolve(this.An.length>G$?this.An[G$]:null)}getHighestUnacknowledgedBatchId(){return xN.resolve(0===this.An.length?-1:this.ds-1)}getAllMutationBatches(H$){return xN.resolve(this.An.slice())}getAllMutationBatchesAffectingDocumentKey(I$,J$){const K$=new j$(J$,0),L$=new j$(J$,Number.POSITIVE_INFINITY),M$=[];return this.ws.forEachInRange([K$,L$],a=>{const b=this._s(a.fs);M$.push(b)}),xN.resolve(M$)}getAllMutationBatchesAffectingDocumentKeys(N$,O$){let P$=new fJ(_B);return O$.forEach(a=>{const b=new j$(a,0),c=new j$(a,Number.POSITIVE_INFINITY);this.ws.forEachInRange([b,c],a=>{P$=P$.add(a.fs)})}),xN.resolve(this.ys(P$))}getAllMutationBatchesAffectingQuery(Q$,R$){const S$=R$.path,T$=S$.length+1;let U$=S$;GD.isDocumentKey(U$)||(U$=U$.child(""));const V$=new j$(new GD(U$),0);let W$=new fJ(_B);return this.ws.forEachWhile(a=>{const b=a.key.path;return!!S$.isPrefixOf(b)&&(b.length===T$&&(W$=W$.add(a.fs)),!0)},V$),xN.resolve(this.ys(W$))}ys(X$){const Y$=[];return X$.forEach(a=>{const b=this._s(a);null!==b&&Y$.push(b)}),Y$}removeMutationBatch(Z$,$$){VA(0===this.ps($$.batchId,"removed")),this.An.shift();let _$=this.ws;return xN.forEach($$.mutations,a=>{const b=new j$(a.key,$$.batchId);return _$=_$.delete(b),this.referenceDelegate.markPotentiallyOrphaned(Z$,a.key)}).next(()=>{this.ws=_$})}ee(a_){}containsKey(b_,c_){const d_=new j$(c_,0),e_=this.ws.firstAfterOrEqual(d_);return xN.resolve(c_.isEqual(e_&&e_.key))}performConsistencyCheck(f_){return this.An.length,xN.resolve()}ps(g_,h_){return this.gs(g_)}gs(i_){return 0===this.An.length?0:i_-this.An[0].batchId}_s(j_){const k_=this.gs(j_);return k_<0||k_>=this.An.length?null:this.An[k_]}}class l_{constructor(m_,n_){this.Jt=m_,this.Ts=n_,this.docs=new PH(GD.comparator),this.size=0}addEntry(o_,p_,q_){const r_=p_.key,s_=this.docs.get(r_),t_=s_?s_.size:0,u_=this.Ts(p_);return this.docs=this.docs.insert(r_,{document:p_.mutableCopy(),size:u_,readTime:q_}),this.size+=u_-t_,this.Jt.addToCollectionParentIndex(o_,r_.path.popLast())}removeEntry(v_){const w_=this.docs.get(v_);w_&&(this.docs=this.docs.remove(v_),this.size-=w_.size)}getEntry(x_,y_){const z_=this.docs.get(y_);return xN.resolve(z_?z_.document.mutableCopy():AE.newInvalidDocument(y_))}getEntries(A_,B_){let C_=KJ();return B_.forEach(a=>{const b=this.docs.get(a);C_=C_.insert(a,b?b.document.mutableCopy():AE.newInvalidDocument(a))}),xN.resolve(C_)}getDocumentsMatchingQuery(D_,E_,F_){let G_=KJ();const H_=new GD(E_.path.child("")),I_=this.docs.getIteratorFrom(H_);for(;I_.hasNext();){const{key:J_,value:{document:K_,readTime:L_}}=I_.getNext();if(!E_.path.isPrefixOf(J_.path))break;0>=L_.compareTo(F_)||EG(E_,K_)&&(G_=G_.insert(K_.key,K_.mutableCopy()))}return xN.resolve(G_)}Es(M_,N_){return xN.forEach(this.docs,a=>N_(a))}newChangeBuffer(O_){return new Q_(this)}getSize(P_){return xN.resolve(this.size)}}class Q_ extends KS{constructor(R_){super(),this.De=R_}applyChanges(S_){const T_=[];return this.changes.forEach((a,b)=>{b.document.isValidDocument()?T_.push(this.De.addEntry(S_,b.document,this.getReadTime(a))):this.De.removeEntry(a)}),xN.waitFor(T_)}getFromCache(U_,V_){return this.De.getEntry(U_,V_)}getAllFromCache(W_,X_){return this.De.getEntries(W_,X_)}}class Y_{constructor(Z_,$_){this.Ps={},this.Be=new PB(0),this.Ue=!1,this.Ue=!0,this.referenceDelegate=Z_(this),this.He=new class{constructor(__){this.persistence=__,this.Is=new rS(a=>aF(a),bF),this.lastRemoteSnapshotVersion=lC.min(),this.highestTargetId=0,this.As=0,this.Rs=new NZ,this.targetCount=0,this.bs=$R.ie()}forEachTarget(a0,b0){return this.Is.forEach((a,b)=>b0(b)),xN.resolve()}getLastRemoteSnapshotVersion(c0){return xN.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(d0){return xN.resolve(this.As)}allocateTargetId(e0){return this.highestTargetId=this.bs.next(),xN.resolve(this.highestTargetId)}setTargetsMetadata(f0,g0,h0){return h0&&(this.lastRemoteSnapshotVersion=h0),g0>this.As&&(this.As=g0),xN.resolve()}ae(i0){this.Is.set(i0.target,i0);const j0=i0.targetId;j0>this.highestTargetId&&(this.bs=new $R(j0),this.highestTargetId=j0),i0.sequenceNumber>this.As&&(this.As=i0.sequenceNumber)}addTargetData(k0,l0){return this.ae(l0),this.targetCount+=1,xN.resolve()}updateTargetData(m0,n0){return this.ae(n0),xN.resolve()}removeTargetData(o0,p0){return this.Is.delete(p0.target),this.Rs.us(p0.targetId),this.targetCount-=1,xN.resolve()}removeTargets(q0,r0,s0){let t0=0;const u0=[];return this.Is.forEach((a,b)=>{b.sequenceNumber<=r0&&null===s0.get(b.targetId)&&(this.Is.delete(a),u0.push(this.removeMatchingKeysForTargetId(q0,b.targetId)),t0++)}),xN.waitFor(u0).next(()=>t0)}getTargetCount(v0){return xN.resolve(this.targetCount)}getTargetData(w0,x0){const y0=this.Is.get(x0)||null;return xN.resolve(y0)}addMatchingKeys(z0,A0,B0){return this.Rs.rs(A0,B0),xN.resolve()}removeMatchingKeys(C0,D0,E0){this.Rs.cs(D0,E0);const F0=this.persistence.referenceDelegate,G0=[];return F0&&D0.forEach(a=>{G0.push(F0.markPotentiallyOrphaned(C0,a))}),xN.waitFor(G0)}removeMatchingKeysForTargetId(H0,I0){return this.Rs.us(I0),xN.resolve()}getMatchingKeysForTargetId(J0,K0){const L0=this.Rs.ls(K0);return xN.resolve(L0)}containsKey(M0,N0){return xN.resolve(this.Rs.containsKey(N0))}}(this),this.Jt=new class{constructor(){this.zt=new wQ}addToCollectionParentIndex(O0,P0){return this.zt.add(P0),xN.resolve()}getCollectionParents(Q0,R0){return xN.resolve(this.zt.getEntries(R0))}},this.Je=(function(a,b){return new l_(a,b)})(this.Jt,a=>this.referenceDelegate.vs(a)),this.k=new iQ($_),this.Ye=new class{constructor(S0){this.k=S0,this.Xn=new Map,this.Zn=new Map}getBundleMetadata(T0,U0){return xN.resolve(this.Xn.get(U0))}saveBundleMetadata(V0,W0){var X0;return this.Xn.set(W0.id,{id:(X0=W0).id,version:X0.version,createTime:yL(X0.createTime)}),xN.resolve()}getNamedQuery(Y0,Z0){return xN.resolve(this.Zn.get(Z0))}saveNamedQuery($0,_0){var a1;return this.Zn.set(_0.name,{name:(a1=_0).name,query:tQ(a1.bundledQuery),readTime:yL(a1.readTime)}),xN.resolve()}}(this.k)}start(){return Promise.resolve()}shutdown(){return this.Ue=!1,Promise.resolve()}get started(){return this.Ue}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(){return this.Jt}getMutationQueue(b1){let c1=this.Ps[b1.toKey()];return c1||(c1=new q$(this.Jt,this.referenceDelegate),this.Ps[b1.toKey()]=c1),c1}getTargetCache(){return this.He}getRemoteDocumentCache(){return this.Je}getBundleCache(){return this.Ye}runTransaction(d1,e1,f1){QA("MemoryPersistence","Starting transaction:",d1);const g1=new j1(this.Be.next());return this.referenceDelegate.Vs(),f1(g1).next(a=>this.referenceDelegate.Ss(g1).next(()=>a)).toPromise().then(a=>(g1.raiseOnCommittedEvent(),a))}Ds(h1,i1){return xN.or(Object.values(this.Ps).map(a=>()=>a.containsKey(h1,i1)))}}class j1 extends vN{constructor(k1){super(),this.currentSequenceNumber=k1}}class l1{constructor(m1){this.persistence=m1,this.Cs=new NZ,this.Ns=null}static ks(n1){return new l1(n1)}get xs(){if(this.Ns)return this.Ns;throw UA()}addReference(o1,p1,q1){return this.Cs.addReference(q1,p1),this.xs.delete(q1.toString()),xN.resolve()}removeReference(r1,s1,t1){return this.Cs.removeReference(t1,s1),this.xs.add(t1.toString()),xN.resolve()}markPotentiallyOrphaned(u1,v1){return this.xs.add(v1.toString()),xN.resolve()}removeTarget(w1,x1){this.Cs.us(x1.targetId).forEach(a=>this.xs.add(a.toString()));const y1=this.persistence.getTargetCache();return y1.getMatchingKeysForTargetId(w1,x1.targetId).next(a=>{a.forEach(a=>this.xs.add(a.toString()))}).next(()=>y1.removeTargetData(w1,x1))}Vs(){this.Ns=new Set}Ss(z1){const A1=this.persistence.getRemoteDocumentCache().newChangeBuffer();return xN.forEach(this.xs,a=>{const b=GD.fromPath(a);return this.$s(z1,b).next(a=>{a||A1.removeEntry(b)})}).next(()=>(this.Ns=null,A1.apply(z1)))}updateLimboDocument(B1,C1){return this.$s(B1,C1).next(a=>{a?this.xs.delete(C1.toString()):this.xs.add(C1.toString())})}vs(D1){return 0}$s(E1,F1){return xN.or([()=>xN.resolve(this.Cs.containsKey(F1)),()=>this.persistence.getTargetCache().containsKey(E1,F1),()=>this.persistence.Ds(E1,F1)])}}function G1(a,b){return`firestore_clients_${a}_${b}`}function H1(a,b,c){let d=`firestore_mutations_${a}_${c}`;return b.isAuthenticated()&&(d+=`_${b.uid}`),d}function I1(a,b){return`firestore_targets_${a}_${b}`}class J1{constructor(K1,L1,M1,N1){this.user=K1,this.batchId=L1,this.state=M1,this.error=N1}static Os(O1,P1,Q1){const R1=JSON.parse(Q1);let S1,T1="object"==typeof R1&& -1!==["pending","acknowledged","rejected"].indexOf(R1.state)&&(void 0===R1.error||"object"==typeof R1.error);return T1&&R1.error&&(T1="string"==typeof R1.error.message&&"string"==typeof R1.error.code)&&(S1=new YA(R1.error.code,R1.error.message)),T1?new J1(O1,P1,R1.state,S1):(RA("SharedClientState",`Failed to parse mutation state for ID '${P1}': ${Q1}`),null)}Ms(){const U1={state:this.state,updateTimeMs:Date.now()};return this.error&&(U1.error={code:this.error.code,message:this.error.message}),JSON.stringify(U1)}}class V1{constructor(W1,X1,Y1){this.targetId=W1,this.state=X1,this.error=Y1}static Os(Z1,$1){const _1=JSON.parse($1);let a2,b2="object"==typeof _1&& -1!==["not-current","current","rejected"].indexOf(_1.state)&&(void 0===_1.error||"object"==typeof _1.error);return b2&&_1.error&&(b2="string"==typeof _1.error.message&&"string"==typeof _1.error.code)&&(a2=new YA(_1.error.code,_1.error.message)),b2?new V1(Z1,_1.state,a2):(RA("SharedClientState",`Failed to parse target state for ID '${Z1}': ${$1}`),null)}Ms(){const c2={state:this.state,updateTimeMs:Date.now()};return this.error&&(c2.error={code:this.error.code,message:this.error.message}),JSON.stringify(c2)}}class d2{constructor(e2,f2){this.clientId=e2,this.activeTargetIds=f2}static Os(g2,h2){const i2=JSON.parse(h2);let j2="object"==typeof i2&&i2.activeTargetIds instanceof Array,k2=SJ();for(let l2=0;j2&&l2<i2.activeTargetIds.length;++l2)j2=FD(i2.activeTargetIds[l2]),k2=k2.add(i2.activeTargetIds[l2]);return j2?new d2(g2,k2):(RA("SharedClientState",`Failed to parse client data for instance '${g2}': ${h2}`),null)}}class m2{constructor(n2,o2){this.clientId=n2,this.onlineState=o2}static Os(p2){const q2=JSON.parse(p2);return"object"==typeof q2&& -1!==["Unknown","Online","Offline"].indexOf(q2.onlineState)&&"string"==typeof q2.clientId?new m2(q2.clientId,q2.onlineState):(RA("SharedClientState",`Failed to parse online state: ${p2}`),null)}}class r2{constructor(){this.activeTargetIds=SJ()}Fs(s2){this.activeTargetIds=this.activeTargetIds.add(s2)}Ls(t2){this.activeTargetIds=this.activeTargetIds.delete(t2)}Ms(){const u2={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(u2)}}class v2{constructor(w2,x2,y2,z2,A2){var B2,C2,D2;this.window=w2,this.Me=x2,this.persistenceKey=y2,this.Bs=z2,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Us=this.qs.bind(this),this.Ks=new PH(_B),this.started=!1,this.js=[];const E2=y2.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=A2,this.Qs=G1(this.persistenceKey,this.Bs),B2=this.persistenceKey,this.Ws=`firestore_sequence_number_${B2}`,this.Ks=this.Ks.insert(this.Bs,new r2),this.Gs=new RegExp(`^firestore_clients_${E2}_([^_]*)$`),this.zs=new RegExp(`^firestore_mutations_${E2}_(\\d+)(?:_(.*))?$`),this.Hs=new RegExp(`^firestore_targets_${E2}_(\\d+)$`),C2=this.persistenceKey,this.Js=`firestore_online_state_${C2}`,D2=this.persistenceKey,this.Ys=`firestore_bundle_loaded_${D2}`,this.window.addEventListener("storage",this.Us)}static Pt(F2){return!(!F2||!F2.localStorage)}async start(){const G2=await this.syncEngine.Tn();for(const H2 of G2)if(H2!==this.Bs){const I2=this.getItem(G1(this.persistenceKey,H2));if(I2){const J2=d2.Os(H2,I2);J2&&(this.Ks=this.Ks.insert(J2.clientId,J2))}}this.Xs();const K2=this.storage.getItem(this.Js);if(K2){const L2=this.Zs(K2);L2&&this.ti(L2)}for(const M2 of this.js)this.qs(M2);this.js=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(N2){this.setItem(this.Ws,JSON.stringify(N2))}getAllActiveQueryTargets(){return this.ei(this.Ks)}isActiveQueryTarget(O2){let P2=!1;return this.Ks.forEach((a,b)=>{b.activeTargetIds.has(O2)&&(P2=!0)}),P2}addPendingMutation(Q2){this.ni(Q2,"pending")}updateMutationState(R2,S2,T2){this.ni(R2,S2,T2),this.si(R2)}addLocalQueryTarget(U2){let V2="not-current";if(this.isActiveQueryTarget(U2)){const W2=this.storage.getItem(I1(this.persistenceKey,U2));if(W2){const X2=V1.Os(U2,W2);X2&&(V2=X2.state)}}return this.ii.Fs(U2),this.Xs(),V2}removeLocalQueryTarget(Y2){this.ii.Ls(Y2),this.Xs()}isLocalQueryTarget(Z2){return this.ii.activeTargetIds.has(Z2)}clearQueryState($2){this.removeItem(I1(this.persistenceKey,$2))}updateQueryState(_2,a3,b3){this.ri(_2,a3,b3)}handleUserChange(c3,d3,e3){d3.forEach(a=>{this.si(a)}),this.currentUser=c3,e3.forEach(a=>{this.addPendingMutation(a)})}setOnlineState(f3){this.oi(f3)}notifyBundleLoaded(){this.ci()}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Us),this.removeItem(this.Qs),this.started=!1)}getItem(g3){const h3=this.storage.getItem(g3);return QA("SharedClientState","READ",g3,h3),h3}setItem(i3,j3){QA("SharedClientState","SET",i3,j3),this.storage.setItem(i3,j3)}removeItem(k3){QA("SharedClientState","REMOVE",k3),this.storage.removeItem(k3)}qs(l3){const m3=l3;if(m3.storageArea===this.storage){if(QA("SharedClientState","EVENT",m3.key,m3.newValue),m3.key===this.Qs)return void RA("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Me.enqueueRetryable(async()=>{if(this.started){if(null!==m3.key){if(this.Gs.test(m3.key)){if(null==m3.newValue){const a=this.ai(m3.key);return this.ui(a,null)}{const b=this.hi(m3.key,m3.newValue);if(b)return this.ui(b.clientId,b)}}else if(this.zs.test(m3.key)){if(null!==m3.newValue){const c=this.li(m3.key,m3.newValue);if(c)return this.fi(c)}}else if(this.Hs.test(m3.key)){if(null!==m3.newValue){const d=this.di(m3.key,m3.newValue);if(d)return this.wi(d)}}else if(m3.key===this.Js){if(null!==m3.newValue){const e=this.Zs(m3.newValue);if(e)return this.ti(e)}}else if(m3.key===this.Ws){const f=function(a){let b=PB.I;if(null!=a)try{const c=JSON.parse(a);VA("number"==typeof c),b=c}catch(d){RA("SharedClientState","Failed to read sequence number from WebStorage",d)}return b}(m3.newValue);f!==PB.I&&this.sequenceNumberHandler(f)}else if(m3.key===this.Ys)return this.syncEngine._i()}}else this.js.push(m3)})}}get ii(){return this.Ks.get(this.Bs)}Xs(){this.setItem(this.Qs,this.ii.Ms())}ni(n3,o3,p3){const q3=new J1(this.currentUser,n3,o3,p3),r3=H1(this.persistenceKey,this.currentUser,n3);this.setItem(r3,q3.Ms())}si(s3){const t3=H1(this.persistenceKey,this.currentUser,s3);this.removeItem(t3)}oi(u3){const v3={clientId:this.Bs,onlineState:u3};this.storage.setItem(this.Js,JSON.stringify(v3))}ri(w3,x3,y3){const z3=I1(this.persistenceKey,w3),A3=new V1(w3,x3,y3);this.setItem(z3,A3.Ms())}ci(){this.setItem(this.Ys,"value-not-used")}ai(B3){const C3=this.Gs.exec(B3);return C3?C3[1]:null}hi(D3,E3){const F3=this.ai(D3);return d2.Os(F3,E3)}li(G3,H3){const I3=this.zs.exec(G3),J3=Number(I3[1]),K3=void 0!==I3[2]?I3[2]:null;return J1.Os(new KA(K3),J3,H3)}di(L3,M3){const N3=this.Hs.exec(L3),O3=Number(N3[1]);return V1.Os(O3,M3)}Zs(P3){return m2.Os(P3)}async fi(Q3){if(Q3.user.uid===this.currentUser.uid)return this.syncEngine.mi(Q3.batchId,Q3.state,Q3.error);QA("SharedClientState",`Ignoring mutation for non-active user ${Q3.user.uid}`)}wi(R3){return this.syncEngine.gi(R3.targetId,R3.state,R3.error)}ui(S3,T3){const U3=T3?this.Ks.insert(S3,T3):this.Ks.remove(S3),V3=this.ei(this.Ks),W3=this.ei(U3),X3=[],Y3=[];return W3.forEach(a=>{V3.has(a)||X3.push(a)}),V3.forEach(a=>{W3.has(a)||Y3.push(a)}),this.syncEngine.yi(X3,Y3).then(()=>{this.Ks=U3})}ti(Z3){this.Ks.get(Z3.clientId)&&this.onlineStateHandler(Z3.onlineState)}ei($3){let _3=SJ();return $3.forEach((a,b)=>{_3=_3.unionWith(b.activeTargetIds)}),_3}}class a4{constructor(){this.pi=new r2,this.Ti={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(b4){}updateMutationState(c4,d4,e4){}addLocalQueryTarget(f4){return this.pi.Fs(f4),this.Ti[f4]||"not-current"}updateQueryState(g4,h4,i4){this.Ti[g4]=h4}removeLocalQueryTarget(j4){this.pi.Ls(j4)}isLocalQueryTarget(k4){return this.pi.activeTargetIds.has(k4)}clearQueryState(l4){delete this.Ti[l4]}getAllActiveQueryTargets(){return this.pi.activeTargetIds}isActiveQueryTarget(m4){return this.pi.activeTargetIds.has(m4)}start(){return this.pi=new r2,Promise.resolve()}handleUserChange(n4,o4,p4){}setOnlineState(q4){}shutdown(){}writeSequenceNumber(r4){}notifyBundleLoaded(){}}class s4{Ei(t4){}shutdown(){}}class u4{constructor(){this.Ii=()=>this.Ai(),this.Ri=()=>this.bi(),this.Pi=[],this.vi()}Ei(v4){this.Pi.push(v4)}shutdown(){window.removeEventListener("online",this.Ii),window.removeEventListener("offline",this.Ri)}vi(){window.addEventListener("online",this.Ii),window.addEventListener("offline",this.Ri)}Ai(){for(const w4 of(QA("ConnectivityMonitor","Network connectivity changed: AVAILABLE"),this.Pi))w4(0)}bi(){for(const x4 of(QA("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE"),this.Pi))x4(1)}static Pt(){return"undefined"!=typeof window&& void 0!==window.addEventListener&& void 0!==window.removeEventListener}}const y4={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class z4{constructor(A4){this.Vi=A4.Vi,this.Si=A4.Si}Di(B4){this.Ci=B4}Ni(C4){this.ki=C4}onMessage(D4){this.xi=D4}close(){this.Si()}send(E4){this.Vi(E4)}$i(){this.Ci()}Oi(F4){this.ki(F4)}Mi(G4){this.xi(G4)}}class H4 extends class{constructor($4){this.databaseInfo=$4,this.databaseId=$4.databaseId;const _4=$4.ssl?"https":"http";this.Fi=_4+"://"+$4.host,this.Li="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}Bi(a5,b5,c5,d5,e5){const f5=this.Ui(a5,b5);QA("RestConnection","Sending: ",f5,c5);const g5={};return this.qi(g5,d5,e5),this.Ki(a5,f5,g5,c5).then(a=>(QA("RestConnection","Received: ",a),a),a=>{throw SA("RestConnection",`${a5} failed with error: `,a,"url: ",f5,"request:",c5),a})}ji(h5,i5,j5,k5,l5){return this.Bi(h5,i5,j5,k5,l5)}qi(m5,n5,o5){m5["X-Goog-Api-Client"]="gl-js/ fire/"+NA,m5["Content-Type"]="text/plain",this.databaseInfo.appId&&(m5["X-Firebase-GMPID"]=this.databaseInfo.appId),n5&&n5.headers.forEach((a,b)=>m5[b]=a),o5&&o5.headers.forEach((a,b)=>m5[b]=a)}Ui(p5,q5){const r5=y4[p5];return`${this.Fi}/v1/${q5}:${r5}`}}{constructor(I4){super(I4),this.forceLongPolling=I4.forceLongPolling,this.autoDetectLongPolling=I4.autoDetectLongPolling,this.useFetchStreams=I4.useFetchStreams}Ki(J4,K4,L4,M4){return new Promise((a,b)=>{const c=new HA;c.listenOnce(CA.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case BA.NO_ERROR:const d=c.getResponseJson();QA("Connection","XHR received:",JSON.stringify(d)),a(d);break;case BA.TIMEOUT:QA("Connection","RPC \""+J4+"\" timed out"),b(new YA(XA.DEADLINE_EXCEEDED,"Request time out"));break;case BA.HTTP_ERROR:const e=c.getStatus();if(QA("Connection","RPC \""+J4+"\" failed with status:",e,"response text:",c.getResponseText()),e>0){const f=c.getResponseJson().error;if(f&&f.status&&f.message){const g=function(a){const b=a.toLowerCase().replace(/_/g,"-");return Object.values(XA).indexOf(b)>=0?b:XA.UNKNOWN}(f.status);b(new YA(g,f.message))}else b(new YA(XA.UNKNOWN,"Server responded with status "+c.getStatus()))}else b(new YA(XA.UNAVAILABLE,"Connection failed."));break;default:UA()}}finally{QA("Connection","RPC \""+J4+"\" completed.")}});const d=JSON.stringify(M4);c.send(K4,"POST",d,L4,15)})}Qi(N4,O4,P4){const Q4=[this.Fi,"/","google.firestore.v1.Firestore","/",N4,"/channel"],R4=zA(),S4=AA(),T4={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:60e4},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(T4.xmlHttpFactory=new FA({})),this.qi(T4.initMessageHeaders,O4,P4),C()||F()||B().indexOf("Electron/")>=0||G()||B().indexOf("MSAppHost/")>=0||E()||(T4.httpHeadersOverwriteParam="$httpHeaders");const U4=Q4.join("");QA("Connection","Creating WebChannel: "+U4,T4);const V4=R4.createWebChannel(U4,T4);let W4=!1,X4=!1;const Y4=new z4({Vi:a=>{X4?QA("Connection","Not sending because WebChannel is closed:",a):(W4||(QA("Connection","Opening WebChannel transport."),V4.open(),W4=!0),QA("Connection","WebChannel sending:",a),V4.send(a))},Si:()=>V4.close()}),Z4=(a,b,c)=>{a.listen(b,a=>{try{c(a)}catch(b){setTimeout(()=>{throw b},0)}})};return Z4(V4,GA.EventType.OPEN,()=>{X4||QA("Connection","WebChannel transport opened.")}),Z4(V4,GA.EventType.CLOSE,()=>{X4||(X4=!0,QA("Connection","WebChannel transport closed"),Y4.Oi())}),Z4(V4,GA.EventType.ERROR,a=>{X4||(X4=!0,SA("Connection","WebChannel transport errored:",a),Y4.Oi(new YA(XA.UNAVAILABLE,"The operation could not be completed")))}),Z4(V4,GA.EventType.MESSAGE,a=>{var b;if(!X4){const c=a.data[0];VA(!!c);const d=c,e=d.error||(null===(b=d[0])|| void 0===b?void 0:b.error);if(e){QA("Connection","WebChannel received error:",e);const f=e.status;let g=function(a){const b=k[a];if(void 0!==b)return OH(b)}(f),h=e.message;void 0===g&&(g=XA.INTERNAL,h="Unknown error status: "+f+" with message "+e.message),X4=!0,Y4.Oi(new YA(g,h)),V4.close()}else QA("Connection","WebChannel received:",c),Y4.Mi(c)}}),Z4(S4,DA.STAT_EVENT,a=>{a.stat===EA.PROXY?QA("Connection","Detected buffering proxy"):a.stat===EA.NOPROXY&&QA("Connection","Detected no buffering proxy")}),setTimeout(()=>{Y4.$i()},0),Y4}}function s5(){return"undefined"!=typeof window?window:null}function t5(){return"undefined"!=typeof document?document:null}function u5(a){return new tL(a,!0)}class v5{constructor(w5,x5,y5=1000,z5=1.5,A5=60e3){this.Me=w5,this.timerId=x5,this.Wi=y5,this.Gi=z5,this.zi=A5,this.Hi=0,this.Ji=null,this.Yi=Date.now(),this.reset()}reset(){this.Hi=0}Xi(){this.Hi=this.zi}Zi(B5){this.cancel();const C5=Math.floor(this.Hi+this.tr()),D5=Math.max(0,Date.now()-this.Yi),E5=Math.max(0,C5-D5);E5>0&&QA("ExponentialBackoff",`Backing off for ${E5} ms (base delay: ${this.Hi} ms, delay with jitter: ${C5} ms, last attempt: ${D5} ms ago)`),this.Ji=this.Me.enqueueAfterDelay(this.timerId,E5,()=>(this.Yi=Date.now(),B5())),this.Hi*=this.Gi,this.Hi<this.Wi&&(this.Hi=this.Wi),this.Hi>this.zi&&(this.Hi=this.zi)}er(){null!==this.Ji&&(this.Ji.skipDelay(),this.Ji=null)}cancel(){null!==this.Ji&&(this.Ji.cancel(),this.Ji=null)}tr(){return(Math.random()-0.5)*this.Hi}}class F5{constructor(G5,H5,I5,J5,K5,L5,M5,N5){this.Me=G5,this.nr=I5,this.sr=J5,this.ir=K5,this.authCredentialsProvider=L5,this.appCheckCredentialsProvider=M5,this.listener=N5,this.state=0,this.rr=0,this.cr=null,this.ar=null,this.stream=null,this.ur=new v5(G5,H5)}hr(){return 1===this.state||5===this.state||this.lr()}lr(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.dr()}async stop(){this.hr()&&await this.close(0)}wr(){this.state=0,this.ur.reset()}_r(){this.lr()&&null===this.cr&&(this.cr=this.Me.enqueueAfterDelay(this.nr,60e3,()=>this.mr()))}gr(O5){this.yr(),this.stream.send(O5)}async mr(){if(this.lr())return this.close(0)}yr(){this.cr&&(this.cr.cancel(),this.cr=null)}pr(){this.ar&&(this.ar.cancel(),this.ar=null)}async close(P5,Q5){this.yr(),this.pr(),this.ur.cancel(),this.rr++,4!==P5?this.ur.reset():Q5&&Q5.code===XA.RESOURCE_EXHAUSTED?(RA(Q5.toString()),RA("Using maximum backoff delay to prevent overloading the backend."),this.ur.Xi()):Q5&&Q5.code===XA.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Tr(),this.stream.close(),this.stream=null),this.state=P5,await this.listener.Ni(Q5)}Tr(){}auth(){this.state=1;const R5=this.Er(this.rr),S5=this.rr;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([a,b])=>{this.rr===S5&&this.Ir(a,b)},a=>{R5(()=>{const b=new YA(XA.UNKNOWN,"Fetching auth token failed: "+a.message);return this.Ar(b)})})}Ir(T5,U5){const V5=this.Er(this.rr);this.stream=this.Rr(T5,U5),this.stream.Di(()=>{V5(()=>(this.state=2,this.ar=this.Me.enqueueAfterDelay(this.sr,10e3,()=>(this.lr()&&(this.state=3),Promise.resolve())),this.listener.Di()))}),this.stream.Ni(a=>{V5(()=>this.Ar(a))}),this.stream.onMessage(a=>{V5(()=>this.onMessage(a))})}dr(){this.state=5,this.ur.Zi(async()=>{this.state=0,this.start()})}Ar(W5){return QA("PersistentStream",`close with error: ${W5}`),this.stream=null,this.close(4,W5)}Er(X5){return a=>{this.Me.enqueueAndForget(()=>this.rr===X5?a():(QA("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Y5 extends F5{constructor(Z5,$5,_5,a6,b6,c6){super(Z5,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",$5,_5,a6,c6),this.k=b6}Rr(d6,e6){return this.ir.Qi("Listen",d6,e6)}onMessage(f6){this.ur.reset();const g6=function(a,b){let c;if("targetChange"in b){var d,e,f;b.targetChange;const g="NO_CHANGE"===(d=b.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===d?1:"REMOVE"===d?2:"CURRENT"===d?3:"RESET"===d?4:UA(),h=b.targetChange.targetIds||[],i=(e=a,f=b.targetChange.resumeToken,e.C?(VA(void 0===f||"string"==typeof f),nD.fromBase64String(f||"")):(VA(void 0===f||f instanceof Uint8Array),nD.fromUint8Array(f||new Uint8Array))),j=b.targetChange.cause,k=j&&function(a){const b=void 0===a.code?XA.UNKNOWN:OH(a.code);return new YA(b,a.message||"")}(j);c=new qK(g,h,i,k||null)}else if("documentChange"in b){b.documentChange;const l=b.documentChange;l.document,l.document.name,l.document.updateTime;const m=CL(a,l.document.name),n=yL(l.document.updateTime),o=new cE({mapValue:{fields:l.document.fields}}),p=AE.newFoundDocument(m,n,o),q=l.targetIds||[],r=l.removedTargetIds||[];c=new iK(q,r,p.key,p)}else if("documentDelete"in b){b.documentDelete;const s=b.documentDelete;s.document;const t=CL(a,s.document),u=s.readTime?yL(s.readTime):lC.min(),v=AE.newNoDocument(t,u),w=s.removedTargetIds||[];c=new iK([],w,v.key,v)}else if("documentRemove"in b){b.documentRemove;const x=b.documentRemove;x.document;const y=CL(a,x.document),z=x.removedTargetIds||[];c=new iK([],z,y,null)}else{if(!("filter"in b))return UA();{b.filter;const A=b.filter;A.targetId;const B=A.count||0,C=new LH(B),D=A.targetId;c=new nK(D,C)}}return c}(this.k,f6),h6=function(a){if(!("targetChange"in a))return lC.min();const b=a.targetChange;return b.targetIds&&b.targetIds.length?lC.min():b.readTime?yL(b.readTime):lC.min()}(f6);return this.listener.br(g6,h6)}Pr(i6){const j6={};j6.database=FL(this.k),j6.addTarget=(function(a,b){let c;const d=b.target;return(c=cF(d)?{documents:LL(a,d)}:{query:ML(a,d)}).targetId=b.targetId,b.resumeToken.approximateByteSize()>0?c.resumeToken=xL(a,b.resumeToken):b.snapshotVersion.compareTo(lC.min())>0&&(c.readTime=wL(a,b.snapshotVersion.toTimestamp())),c})(this.k,i6);const k6=function(a,b){const c=function(a,b){switch(b){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return UA()}}(0,b.purpose);return null==c?null:{"goog-listen-tags":c}}(this.k,i6);k6&&(j6.labels=k6),this.gr(j6)}vr(l6){const m6={};m6.database=FL(this.k),m6.removeTarget=l6,this.gr(m6)}}class n6 extends F5{constructor(o6,p6,q6,r6,s6,t6){super(o6,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",p6,q6,r6,t6),this.k=s6,this.Vr=!1}get Sr(){return this.Vr}start(){this.Vr=!1,this.lastStreamToken=void 0,super.start()}Tr(){this.Vr&&this.Dr([])}Rr(u6,v6){return this.ir.Qi("Write",u6,v6)}onMessage(w6){if(VA(!!w6.streamToken),this.lastStreamToken=w6.streamToken,this.Vr){var x6,y6;this.ur.reset();const z6=(x6=w6.writeResults,y6=w6.commitTime,x6&&x6.length>0?(VA(void 0!==y6),x6.map(a=>{var b,c;let d;return b=a,c=y6,(d=b.updateTime?yL(b.updateTime):yL(c)).isEqual(lC.min())&&(d=yL(c)),new bH(d,b.transformResults||[])})):[]),A6=yL(w6.commitTime);return this.listener.Cr(A6,z6)}return VA(!w6.writeResults||0===w6.writeResults.length),this.Vr=!0,this.listener.Nr()}kr(){const B6={};B6.database=FL(this.k),this.gr(B6)}Dr(C6){const D6={streamToken:this.lastStreamToken,writes:C6.map(a=>JL(this.k,a))};this.gr(D6)}}class E6 extends class{}{constructor(F6,G6,H6,I6){super(),this.authCredentials=F6,this.appCheckCredentials=G6,this.ir=H6,this.k=I6,this.$r=!1}Or(){if(this.$r)throw new YA(XA.FAILED_PRECONDITION,"The client has already been terminated.")}Bi(J6,K6,L6){return this.Or(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,b])=>this.ir.Bi(J6,K6,L6,a,b)).catch(a=>{throw"FirebaseError"===a.name?(a.code===XA.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new YA(XA.UNKNOWN,a.toString())})}ji(M6,N6,O6){return this.Or(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,b])=>this.ir.ji(M6,N6,O6,a,b)).catch(a=>{throw"FirebaseError"===a.name?(a.code===XA.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new YA(XA.UNKNOWN,a.toString())})}terminate(){this.$r=!0}}class P6{constructor(Q6,R6,S6,T6,U6){this.localStore=Q6,this.datastore=R6,this.asyncQueue=S6,this.remoteSyncer={},this.Qr=[],this.Wr=new Map,this.Gr=new Set,this.zr=[],this.Hr=U6,this.Hr.Ei(a=>{S6.enqueueAndForget(async()=>{i7(this)&&(QA("RemoteStore","Restarting streams for network reachability change."),await async function(a){const b=WA(a);b.Gr.add(4),await b7(b),b.Jr.set("Unknown"),b.Gr.delete(4),await a7(b)}(this))})}),this.Jr=new class{constructor(V6,W6){this.asyncQueue=V6,this.onlineStateHandler=W6,this.state="Unknown",this.Mr=0,this.Fr=null,this.Lr=!0}Br(){0===this.Mr&&(this.Ur("Unknown"),this.Fr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",10e3,()=>(this.Fr=null,this.qr("Backend didn't respond within 10 seconds."),this.Ur("Offline"),Promise.resolve())))}Kr(X6){"Online"===this.state?this.Ur("Unknown"):(this.Mr++,this.Mr>=1&&(this.jr(),this.qr(`Connection failed 1 times. Most recent error: ${X6.toString()}`),this.Ur("Offline")))}set(Y6){this.jr(),this.Mr=0,"Online"===Y6&&(this.Lr=!1),this.Ur(Y6)}Ur(Z6){Z6!==this.state&&(this.state=Z6,this.onlineStateHandler(Z6))}qr($6){const _6=`Could not reach Cloud Firestore backend. ${$6}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.Lr?(RA(_6),this.Lr=!1):QA("OnlineStateTracker",_6)}jr(){null!==this.Fr&&(this.Fr.cancel(),this.Fr=null)}}(S6,T6)}}async function a7(a){if(i7(a))for(const b of a.zr)await b(!0)}async function b7(a){for(const b of a.zr)await b(!1)}function c7(a,b){const c=WA(a);c.Wr.has(b.targetId)||(c.Wr.set(b.targetId,b),h7(c)?g7(c):z7(c).lr()&&e7(c,b))}function d7(a,b){const c=WA(a),d=z7(c);c.Wr.delete(b),d.lr()&&f7(c,b),0===c.Wr.size&&(d.lr()?d._r():i7(c)&&c.Jr.set("Unknown"))}function e7(a,b){a.Yr.X(b.targetId),z7(a).Pr(b)}function f7(a,b){a.Yr.X(b),z7(a).vr(b)}function g7(a){a.Yr=new DK({getRemoteKeysForTarget:b=>a.remoteSyncer.getRemoteKeysForTarget(b),Et:b=>a.Wr.get(b)||null}),z7(a).start(),a.Jr.Br()}function h7(a){return i7(a)&&!z7(a).hr()&&a.Wr.size>0}function i7(a){return 0===WA(a).Gr.size}function j7(a){a.Yr=void 0}async function k7(a){a.Wr.forEach((b,c)=>{e7(a,b)})}async function l7(a,b){j7(a),h7(a)?(a.Jr.Kr(b),g7(a)):a.Jr.set("Unknown")}async function m7(a,b,c){if(a.Jr.set("Online"),b instanceof qK&&2===b.state&&b.cause)try{await async function(a,b){const c=b.cause;for(const d of b.targetIds)a.Wr.has(d)&&(await a.remoteSyncer.rejectListen(d,c),a.Wr.delete(d),a.Yr.removeTarget(d))}(a,b)}catch(d){QA("RemoteStore","Failed to remove targets %s: %s ",b.targetIds.join(","),d),await n7(a,d)}else if(b instanceof iK?a.Yr.ot(b):b instanceof nK?a.Yr.dt(b):a.Yr.ut(b),!c.isEqual(lC.min()))try{const e=await CZ(a.localStore);c.compareTo(e)>=0&&await function(a,b){const c=a.Yr.gt(b);return c.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){const e=a.Wr.get(d);e&&a.Wr.set(d,e.withResumeToken(c.resumeToken,b))}}),c.targetMismatches.forEach(b=>{const c=a.Wr.get(b);if(c){a.Wr.set(b,c.withResumeToken(nD.EMPTY_BYTE_STRING,c.snapshotVersion)),f7(a,b);const d=new YP(c.target,b,1,c.sequenceNumber);e7(a,d)}}),a.remoteSyncer.applyRemoteEvent(c)}(a,c)}catch(f){QA("RemoteStore","Failed to raise snapshot:",f),await n7(a,f)}}async function n7(a,b,c){if(!NO(b))throw b;a.Gr.add(1),await b7(a),a.Jr.set("Offline"),c||(c=()=>CZ(a.localStore)),a.asyncQueue.enqueueRetryable(async()=>{QA("RemoteStore","Retrying IndexedDB access"),await c(),a.Gr.delete(1),await a7(a)})}function o7(a,b){return b().catch(c=>n7(a,c,b))}async function p7(a){const b=WA(a),c=A7(b);let d=b.Qr.length>0?b.Qr[b.Qr.length-1].batchId:-1;for(;q7(b);)try{const e=await EZ(b.localStore,d);if(null===e){0===b.Qr.length&&c._r();break}d=e.batchId,r7(b,e)}catch(f){await n7(b,f)}s7(b)&&t7(b)}function q7(a){return i7(a)&&a.Qr.length<10}function r7(a,b){a.Qr.push(b);const c=A7(a);c.lr()&&c.Sr&&c.Dr(b.mutations)}function s7(a){return i7(a)&&!A7(a).hr()&&a.Qr.length>0}function t7(a){A7(a).start()}async function u7(a){A7(a).kr()}async function v7(a){const b=A7(a);for(const c of a.Qr)b.Dr(c.mutations)}async function w7(a,b,c){const d=a.Qr.shift(),e=NP.from(d,b,c);await o7(a,()=>a.remoteSyncer.applySuccessfulWrite(e)),await p7(a)}async function x7(a,b){b&&A7(a).Sr&&await async function(a,b){var c;if(NH(c=b.code)&&c!==XA.ABORTED){const d=a.Qr.shift();A7(a).wr(),await o7(a,()=>a.remoteSyncer.rejectFailedWrite(d.batchId,b)),await p7(a)}}(a,b),s7(a)&&t7(a)}async function y7(a,b){const c=WA(a);b?(c.Gr.delete(2),await a7(c)):b||(c.Gr.add(2),await b7(c),c.Jr.set("Unknown"))}function z7(a){return a.Xr||(a.Xr=(function(a,b,c){const d=WA(a);return d.Or(),new Y5(b,d.ir,d.authCredentials,d.appCheckCredentials,d.k,c)})(a.datastore,a.asyncQueue,{Di:k7.bind(null,a),Ni:l7.bind(null,a),br:m7.bind(null,a)}),a.zr.push(async b=>{b?(a.Xr.wr(),h7(a)?g7(a):a.Jr.set("Unknown")):(await a.Xr.stop(),j7(a))})),a.Xr}function A7(a){return a.Zr||(a.Zr=(function(a,b,c){const d=WA(a);return d.Or(),new n6(b,d.ir,d.authCredentials,d.appCheckCredentials,d.k,c)})(a.datastore,a.asyncQueue,{Di:u7.bind(null,a),Ni:x7.bind(null,a),Nr:v7.bind(null,a),Cr:w7.bind(null,a)}),a.zr.push(async b=>{b?(a.Zr.wr(),await p7(a)):(await a.Zr.stop(),a.Qr.length>0&&(QA("RemoteStore",`Stopping write stream with ${a.Qr.length} pending writes`),a.Qr=[]))})),a.Zr}class B7{constructor(C7,D7,E7,F7,G7){this.asyncQueue=C7,this.timerId=D7,this.targetTimeMs=E7,this.op=F7,this.removalCallback=G7,this.deferred=new _A,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}static createAndSchedule(H7,I7,J7,K7,L7){const M7=Date.now()+J7,N7=new B7(H7,I7,M7,K7,L7);return N7.start(J7),N7}start(O7){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),O7)}skipDelay(){return this.handleDelayElapsed()}cancel(P7){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new YA(XA.CANCELLED,"Operation cancelled"+(P7?": "+P7:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(a=>this.deferred.resolve(a))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Q7(a,b){if(RA("AsyncQueue",`${b}: ${a}`),NO(a))return new YA(XA.UNAVAILABLE,`${b}: ${a}`);throw a}class R7{constructor(S7){this.comparator=S7?(a,b)=>S7(a,b)||GD.comparator(a.key,b.key):(a,b)=>GD.comparator(a.key,b.key),this.keyedMap=MJ(),this.sortedSet=new PH(this.comparator)}static emptySet(T7){return new R7(T7.comparator)}has(U7){return null!=this.keyedMap.get(U7)}get(V7){return this.keyedMap.get(V7)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(W7){const X7=this.keyedMap.get(W7);return X7?this.sortedSet.indexOf(X7):-1}get size(){return this.sortedSet.size}forEach(Y7){this.sortedSet.inorderTraversal((a,b)=>(Y7(a),!1))}add(Z7){const $7=this.delete(Z7.key);return $7.copy($7.keyedMap.insert(Z7.key,Z7),$7.sortedSet.insert(Z7,null))}delete(_7){const a8=this.get(_7);return a8?this.copy(this.keyedMap.remove(_7),this.sortedSet.remove(a8)):this}isEqual(b8){if(!(b8 instanceof R7))return!1;if(this.size!==b8.size)return!1;const c8=this.sortedSet.getIterator(),d8=b8.sortedSet.getIterator();for(;c8.hasNext();){const e8=c8.getNext().key,f8=d8.getNext().key;if(!e8.isEqual(f8))return!1}return!0}toString(){const g8=[];return this.forEach(a=>{g8.push(a.toString())}),0===g8.length?"DocumentSet ()":"DocumentSet (\n  "+g8.join("  \n")+"\n)"}copy(h8,i8){const j8=new R7;return j8.comparator=this.comparator,j8.keyedMap=h8,j8.sortedSet=i8,j8}}class k8{constructor(){this.eo=new PH(GD.comparator)}track(l8){const m8=l8.doc.key,n8=this.eo.get(m8);n8?0!==l8.type&&3===n8.type?this.eo=this.eo.insert(m8,l8):3===l8.type&&1!==n8.type?this.eo=this.eo.insert(m8,{type:n8.type,doc:l8.doc}):2===l8.type&&2===n8.type?this.eo=this.eo.insert(m8,{type:2,doc:l8.doc}):2===l8.type&&0===n8.type?this.eo=this.eo.insert(m8,{type:0,doc:l8.doc}):1===l8.type&&0===n8.type?this.eo=this.eo.remove(m8):1===l8.type&&2===n8.type?this.eo=this.eo.insert(m8,{type:1,doc:n8.doc}):0===l8.type&&1===n8.type?this.eo=this.eo.insert(m8,{type:2,doc:l8.doc}):UA():this.eo=this.eo.insert(m8,l8)}no(){const o8=[];return this.eo.inorderTraversal((a,b)=>{o8.push(b)}),o8}}class p8{constructor(q8,r8,s8,t8,u8,v8,w8,x8){this.query=q8,this.docs=r8,this.oldDocs=s8,this.docChanges=t8,this.mutatedKeys=u8,this.fromCache=v8,this.syncStateChanged=w8,this.excludesMetadataChanges=x8}static fromInitialDocuments(y8,z8,A8,B8){const C8=[];return z8.forEach(a=>{C8.push({type:0,doc:a})}),new p8(y8,z8,R7.emptySet(z8),C8,A8,B8,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(D8){if(!(this.fromCache===D8.fromCache&&this.syncStateChanged===D8.syncStateChanged&&this.mutatedKeys.isEqual(D8.mutatedKeys)&&BG(this.query,D8.query)&&this.docs.isEqual(D8.docs)&&this.oldDocs.isEqual(D8.oldDocs)))return!1;const E8=this.docChanges,F8=D8.docChanges;if(E8.length!==F8.length)return!1;for(let G8=0;G8<E8.length;G8++)if(E8[G8].type!==F8[G8].type||!E8[G8].doc.isEqual(F8[G8].doc))return!1;return!0}}class H8{constructor(){this.so=void 0,this.listeners=[]}}class I8{constructor(){this.queries=new rS(a=>CG(a),BG),this.onlineState="Unknown",this.io=new Set}}async function J8(a,b){const c=WA(a),d=b.query;let e=!1,f=c.queries.get(d);if(f||(e=!0,f=new H8),e)try{f.so=await c.onListen(d)}catch(g){const h=Q7(g,`Initialization of query '${DG(b.query)}' failed`);return void b.onError(h)}c.queries.set(d,f),f.listeners.push(b),b.ro(c.onlineState),f.so&&b.oo(f.so)&&N8(c)}async function K8(a,b){const c=WA(a),d=b.query;let e=!1;const f=c.queries.get(d);if(f){const g=f.listeners.indexOf(b);g>=0&&(f.listeners.splice(g,1),e=0===f.listeners.length)}if(e)return c.queries.delete(d),c.onUnlisten(d)}function L8(a,b){const c=WA(a);let d=!1;for(const e of b){const f=e.query,g=c.queries.get(f);if(g){for(const h of g.listeners)h.oo(e)&&(d=!0);g.so=e}}d&&N8(c)}function M8(a,b,c){const d=WA(a),e=d.queries.get(b);if(e)for(const f of e.listeners)f.onError(c);d.queries.delete(b)}function N8(a){a.io.forEach(a=>{a.next()})}class O8{constructor(P8,Q8,R8){this.query=P8,this.co=Q8,this.ao=!1,this.uo=null,this.onlineState="Unknown",this.options=R8||{}}oo(S8){if(!this.options.includeMetadataChanges){const T8=[];for(const U8 of S8.docChanges)3!==U8.type&&T8.push(U8);S8=new p8(S8.query,S8.docs,S8.oldDocs,T8,S8.mutatedKeys,S8.fromCache,S8.syncStateChanged,!0)}let V8=!1;return this.ao?this.ho(S8)&&(this.co.next(S8),V8=!0):this.lo(S8,this.onlineState)&&(this.fo(S8),V8=!0),this.uo=S8,V8}onError(W8){this.co.error(W8)}ro(X8){this.onlineState=X8;let Y8=!1;return this.uo&&!this.ao&&this.lo(this.uo,X8)&&(this.fo(this.uo),Y8=!0),Y8}lo(Z8,$8){if(!Z8.fromCache)return!0;const _8="Offline"!==$8;return(!this.options.wo||!_8)&&(!Z8.docs.isEmpty()||"Offline"===$8)}ho(a9){if(a9.docChanges.length>0)return!0;const b9=this.uo&&this.uo.hasPendingWrites!==a9.hasPendingWrites;return!(!a9.syncStateChanged&&!b9)&& !0===this.options.includeMetadataChanges}fo(c9){c9=p8.fromInitialDocuments(c9.query,c9.docs,c9.mutatedKeys,c9.fromCache),this.ao=!0,this.co.next(c9)}}class d9{constructor(e9,f9){this.payload=e9,this.byteLength=f9}_o(){return"metadata"in this.payload}}class g9{constructor(h9){this.k=h9}Hn(i9){return CL(this.k,i9)}Jn(j9){return j9.metadata.exists?IL(this.k,j9.document,!1):AE.newNoDocument(this.Hn(j9.metadata.name),this.Yn(j9.metadata.readTime))}Yn(k9){return yL(k9)}}class l9{constructor(m9,n9,o9){this.mo=m9,this.localStore=n9,this.k=o9,this.queries=[],this.documents=[],this.progress=B9(m9)}yo(p9){this.progress.bytesLoaded+=p9.byteLength;let q9=this.progress.documentsLoaded;return p9.payload.namedQuery?this.queries.push(p9.payload.namedQuery):p9.payload.documentMetadata?(this.documents.push({metadata:p9.payload.documentMetadata}),p9.payload.documentMetadata.exists|| ++q9):p9.payload.document&&(this.documents[this.documents.length-1].document=p9.payload.document,++q9),q9!==this.progress.documentsLoaded?(this.progress.documentsLoaded=q9,Object.assign({},this.progress)):null}po(r9){const s9=new Map,t9=new g9(this.k);for(const u9 of r9)if(u9.metadata.queries){const v9=t9.Hn(u9.metadata.name);for(const w9 of u9.metadata.queries){const x9=(s9.get(w9)||QJ()).add(v9);s9.set(w9,x9)}}return s9}async complete(){const y9=await LZ(this.localStore,new g9(this.k),this.documents,this.mo.id),z9=this.po(this.documents);for(const A9 of this.queries)await MZ(this.localStore,A9,z9.get(A9.name));return this.progress.taskState="Success",new gY(Object.assign({},this.progress),y9)}}function B9(a){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:a.totalDocuments,totalBytes:a.totalBytes}}class C9{constructor(D9){this.key=D9}}class E9{constructor(F9){this.key=F9}}class G9{constructor(H9,I9){this.query=H9,this.To=I9,this.Eo=null,this.current=!1,this.Io=QJ(),this.mutatedKeys=QJ(),this.Ao=FG(H9),this.Ro=new R7(this.Ao)}get bo(){return this.To}Po(J9,K9){const L9=K9?K9.vo:new k8,M9=K9?K9.Ro:this.Ro;let N9=K9?K9.mutatedKeys:this.mutatedKeys,O9=M9,P9=!1;const Q9=tG(this.query)&&M9.size===this.query.limit?M9.last():null,R9=uG(this.query)&&M9.size===this.query.limit?M9.first():null;if(J9.inorderTraversal((a,b)=>{const c=M9.get(a),d=EG(this.query,b)?b:null,e=!!c&&this.mutatedKeys.has(c.key),f=!!d&&(d.hasLocalMutations||this.mutatedKeys.has(d.key)&&d.hasCommittedMutations);let g=!1;c&&d?c.data.isEqual(d.data)?e!==f&&(L9.track({type:3,doc:d}),g=!0):this.Vo(c,d)||(L9.track({type:2,doc:d}),g=!0,(Q9&&this.Ao(d,Q9)>0||R9&&0>this.Ao(d,R9))&&(P9=!0)):!c&&d?(L9.track({type:0,doc:d}),g=!0):c&&!d&&(L9.track({type:1,doc:c}),g=!0,(Q9||R9)&&(P9=!0)),g&&(d?(O9=O9.add(d),N9=f?N9.add(a):N9.delete(a)):(O9=O9.delete(a),N9=N9.delete(a)))}),tG(this.query)||uG(this.query))for(;O9.size>this.query.limit;){const S9=tG(this.query)?O9.last():O9.first();O9=O9.delete(S9.key),N9=N9.delete(S9.key),L9.track({type:1,doc:S9})}return{Ro:O9,vo:L9,Bn:P9,mutatedKeys:N9}}Vo(T9,U9){return T9.hasLocalMutations&&U9.hasCommittedMutations&&!U9.hasLocalMutations}applyChanges(V9,W9,X9){const Y9=this.Ro;this.Ro=V9.Ro,this.mutatedKeys=V9.mutatedKeys;const Z9=V9.vo.no();Z9.sort((a,b)=>(function(a,b){const c=a=>{switch(a){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return UA()}};return c(a)-c(b)})(a.type,b.type)||this.Ao(a.doc,b.doc)),this.So(X9);const $9=W9?this.Do():[],_9=0===this.Io.size&&this.current?1:0,aaa=_9!==this.Eo;return(this.Eo=_9,0!==Z9.length||aaa)?{snapshot:new p8(this.query,V9.Ro,Y9,Z9,V9.mutatedKeys,0===_9,aaa,!1),Co:$9}:{Co:$9}}ro(baa){return this.current&&"Offline"===baa?(this.current=!1,this.applyChanges({Ro:this.Ro,vo:new k8,mutatedKeys:this.mutatedKeys,Bn:!1},!1)):{Co:[]}}No(caa){return!this.To.has(caa)&& !!this.Ro.has(caa)&&!this.Ro.get(caa).hasLocalMutations}So(daa){daa&&(daa.addedDocuments.forEach(a=>this.To=this.To.add(a)),daa.modifiedDocuments.forEach(a=>{}),daa.removedDocuments.forEach(a=>this.To=this.To.delete(a)),this.current=daa.current)}Do(){if(!this.current)return[];const eaa=this.Io;this.Io=QJ(),this.Ro.forEach(a=>{this.No(a.key)&&(this.Io=this.Io.add(a.key))});const faa=[];return eaa.forEach(a=>{this.Io.has(a)||faa.push(new E9(a))}),this.Io.forEach(a=>{eaa.has(a)||faa.push(new C9(a))}),faa}ko(gaa){this.To=gaa.zn,this.Io=QJ();const haa=this.Po(gaa.documents);return this.applyChanges(haa,!0)}xo(){return p8.fromInitialDocuments(this.query,this.Ro,this.mutatedKeys,0===this.Eo)}}class iaa{constructor(jaa,kaa,laa){this.query=jaa,this.targetId=kaa,this.view=laa}}class maa{constructor(naa){this.key=naa,this.$o=!1}}class oaa{constructor(paa,qaa,raa,saa,taa,uaa){this.localStore=paa,this.remoteStore=qaa,this.eventManager=raa,this.sharedClientState=saa,this.currentUser=taa,this.maxConcurrentLimboResolutions=uaa,this.Oo={},this.Mo=new rS(a=>CG(a),BG),this.Fo=new Map,this.Lo=new Set,this.Bo=new PH(GD.comparator),this.Uo=new Map,this.qo=new NZ,this.Ko={},this.jo=new Map,this.Qo=$R.re(),this.onlineState="Unknown",this.Wo=void 0}get isPrimaryClient(){return!0===this.Wo}}async function vaa(a,b){const c=Yaa(a);let d,e;const f=c.Mo.get(b);if(f)d=f.targetId,c.sharedClientState.addLocalQueryTarget(d),e=f.view.xo();else{const g=await FZ(c.localStore,zG(b)),h=c.sharedClientState.addLocalQueryTarget(g.targetId);e=await waa(c,b,d=g.targetId,"current"===h),c.isPrimaryClient&&c7(c.remoteStore,g)}return e}async function waa(a,b,c,d){a.Go=(b,c,d)=>(async function(a,b,c,d){let e=b.view.Po(c);e.Bn&&(e=await HZ(a.localStore,b.query,!1).then(({documents:a})=>b.view.Po(a,e)));const f=d&&d.targetChanges.get(b.targetId),g=b.view.applyChanges(e,a.isPrimaryClient,f);return Jaa(a,b.targetId,g.Co),g.snapshot})(a,b,c,d);const e=await HZ(a.localStore,b,!0),f=new G9(b,e.zn),g=f.Po(e.documents),h=aK.createSynthesizedTargetChangeForCurrentChange(c,d&&"Offline"!==a.onlineState),i=f.applyChanges(g,a.isPrimaryClient,h);Jaa(a,c,i.Co);const j=new iaa(b,c,f);return a.Mo.set(b,j),a.Fo.has(c)?a.Fo.get(c).push(b):a.Fo.set(c,[b]),i.snapshot}async function xaa(a,b){const c=WA(a),d=c.Mo.get(b),e=c.Fo.get(d.targetId);if(e.length>1)return c.Fo.set(d.targetId,e.filter(a=>!BG(a,b))),void c.Mo.delete(b);c.isPrimaryClient?(c.sharedClientState.removeLocalQueryTarget(d.targetId),c.sharedClientState.isActiveQueryTarget(d.targetId)||await GZ(c.localStore,d.targetId,!1).then(()=>{c.sharedClientState.clearQueryState(d.targetId),d7(c.remoteStore,d.targetId),Haa(c,d.targetId)}).catch(dS)):(Haa(c,d.targetId),await GZ(c.localStore,d.targetId,!0))}async function yaa(a,b,c){const d=Zaa(a);try{var e,f,g;const h=await function(a,b){const c=WA(a),d=cC.now(),e=b.reduce((a,b)=>a.add(b.key),QJ());let f;return c.persistence.runTransaction("Locally write mutations","readwrite",a=>c.Wn.vn(a,e).next(e=>{f=e;const g=[];for(const h of b){const i=oH(h,f.get(h.key));null!=i&&g.push(new wH(h.key,i,zE(i.value.mapValue),eH.exists(!0)))}return c.An.addMutationBatch(a,d,g,b)})).then(a=>(a.applyToLocalDocumentSet(f),{batchId:a.batchId,changes:f}))}(d.localStore,b);let i;d.sharedClientState.addPendingMutation(h.batchId),e=d,f=h.batchId,g=c,(i=e.Ko[e.currentUser.toKey()])||(i=new PH(_B)),i=i.insert(f,g),e.Ko[e.currentUser.toKey()]=i,await Maa(d,h.changes),await p7(d.remoteStore)}catch(j){const k=Q7(j,"Failed to persist write");c.reject(k)}}async function zaa(a,b){const c=WA(a);try{const d=await function(a,b){const c=WA(a),d=b.snapshotVersion;let e=c.qn;return c.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const f=c.Qn.newChangeBuffer({trackRemovals:!0});e=c.qn;const g=[];b.targetChanges.forEach((f,h)=>{const i=e.get(h);if(i){var j,k,l;g.push(c.He.removeMatchingKeys(a,f.removedDocuments,h).next(()=>c.He.addMatchingKeys(a,f.addedDocuments,h)));let m=i.withSequenceNumber(a.currentSequenceNumber);b.targetMismatches.has(h)?m=m.withResumeToken(nD.EMPTY_BYTE_STRING,lC.min()).withLastLimboFreeSnapshotVersion(lC.min()):f.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(f.resumeToken,d)),e=e.insert(h,m),j=i,k=m,l=f,(0===j.resumeToken.approximateByteSize()?0:k.snapshotVersion.toMicroseconds()-j.snapshotVersion.toMicroseconds()>=30e7?0:!(l.addedDocuments.size+l.modifiedDocuments.size+l.removedDocuments.size>0))||g.push(c.He.updateTargetData(a,m))}});let h=KJ();if(b.documentUpdates.forEach((d,e)=>{b.resolvedLimboDocuments.has(d)&&g.push(c.persistence.referenceDelegate.updateLimboDocument(a,d))}),g.push(DZ(a,f,b.documentUpdates,d,void 0).next(a=>{h=a})),!d.isEqual(lC.min())){const i=c.He.getLastRemoteSnapshotVersion(a).next(b=>c.He.setTargetsMetadata(a,a.currentSequenceNumber,d));g.push(i)}return xN.waitFor(g).next(()=>f.apply(a)).next(()=>c.Wn.Vn(a,h)).next(()=>h)}).then(a=>(c.qn=e,a))}(c.localStore,b);b.targetChanges.forEach((a,b)=>{const d=c.Uo.get(b);d&&(VA(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1),a.addedDocuments.size>0?d.$o=!0:a.modifiedDocuments.size>0?VA(d.$o):a.removedDocuments.size>0&&(VA(d.$o),d.$o=!1))}),await Maa(c,d,b)}catch(e){await dS(e)}}function Aaa(a,b,c){const d=WA(a);if(d.isPrimaryClient&&0===c|| !d.isPrimaryClient&&1===c){const e=[];d.Mo.forEach((a,c)=>{const d=c.view.ro(b);d.snapshot&&e.push(d.snapshot)}),(function(a,b){const c=WA(a);c.onlineState=b;let d=!1;c.queries.forEach((a,c)=>{for(const e of c.listeners)e.ro(b)&&(d=!0)}),d&&N8(c)})(d.eventManager,b),e.length&&d.Oo.br(e),d.onlineState=b,d.isPrimaryClient&&d.sharedClientState.setOnlineState(b)}}async function Baa(a,b,c){const d=WA(a);d.sharedClientState.updateQueryState(b,"rejected",c);const e=d.Uo.get(b),f=e&&e.key;if(f){let g=new PH(GD.comparator);g=g.insert(f,AE.newNoDocument(f,lC.min()));const h=QJ().add(f),i=new TJ(lC.min(),new Map,new fJ(_B),g,h);await zaa(d,i),d.Bo=d.Bo.remove(f),d.Uo.delete(b),Laa(d)}else await GZ(d.localStore,b,!1).then(()=>Haa(d,b,c)).catch(dS)}async function Caa(a,b){const c=WA(a),d=b.batch.batchId;try{const e=await function(a,b){const c=WA(a);return c.persistence.runTransaction("Acknowledge batch","readwrite-primary",a=>{const d=b.batch.keys(),e=c.Qn.newChangeBuffer({trackRemovals:!0});return(function(a,b,c,d){const e=c.batch,f=e.keys();let g=xN.resolve();return f.forEach(a=>{g=g.next(()=>d.getEntry(b,a)).next(b=>{const f=c.docVersions.get(a);VA(null!==f),0>b.version.compareTo(f)&&(e.applyToRemoteDocument(b,c),b.isValidDocument()&&d.addEntry(b,c.commitVersion))})}),g.next(()=>a.An.removeMutationBatch(b,e))})(c,a,b,e).next(()=>e.apply(a)).next(()=>c.An.performConsistencyCheck(a)).next(()=>c.Wn.vn(a,d))})}(c.localStore,b);Gaa(c,d,null),Faa(c,d),c.sharedClientState.updateMutationState(d,"acknowledged"),await Maa(c,e)}catch(f){await dS(f)}}async function Daa(a,b,c){const d=WA(a);try{const e=await function(a,b){const c=WA(a);return c.persistence.runTransaction("Reject batch","readwrite-primary",a=>{let d;return c.An.lookupMutationBatch(a,b).next(b=>(VA(null!==b),d=b.keys(),c.An.removeMutationBatch(a,b))).next(()=>c.An.performConsistencyCheck(a)).next(()=>c.Wn.vn(a,d))})}(d.localStore,b);Gaa(d,b,c),Faa(d,b),d.sharedClientState.updateMutationState(b,"rejected",c),await Maa(d,e)}catch(f){await dS(f)}}async function Eaa(a,b){const c=WA(a);i7(c.remoteStore)||QA("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const d=await function(a){const b=WA(a);return b.persistence.runTransaction("Get highest unacknowledged batch id","readonly",a=>b.An.getHighestUnacknowledgedBatchId(a))}(c.localStore);if(-1===d)return void b.resolve();const e=c.jo.get(d)||[];e.push(b),c.jo.set(d,e)}catch(f){const g=Q7(f,"Initialization of waitForPendingWrites() operation failed");b.reject(g)}}function Faa(a,b){(a.jo.get(b)||[]).forEach(a=>{a.resolve()}),a.jo.delete(b)}function Gaa(a,b,c){const d=WA(a);let e=d.Ko[d.currentUser.toKey()];if(e){const f=e.get(b);f&&(c?f.reject(c):f.resolve(),e=e.remove(b)),d.Ko[d.currentUser.toKey()]=e}}function Haa(a,b,c=null){for(const d of(a.sharedClientState.removeLocalQueryTarget(b),a.Fo.get(b)))a.Mo.delete(d),c&&a.Oo.zo(d,c);a.Fo.delete(b),a.isPrimaryClient&&a.qo.us(b).forEach(b=>{a.qo.containsKey(b)||Iaa(a,b)})}function Iaa(a,b){a.Lo.delete(b.path.canonicalString());const c=a.Bo.get(b);null!==c&&(d7(a.remoteStore,c),a.Bo=a.Bo.remove(b),a.Uo.delete(c),Laa(a))}function Jaa(a,b,c){for(const d of c)d instanceof C9?(a.qo.addReference(d.key,b),Kaa(a,d)):d instanceof E9?(QA("SyncEngine","Document no longer in limbo: "+d.key),a.qo.removeReference(d.key,b),a.qo.containsKey(d.key)||Iaa(a,d.key)):UA()}function Kaa(a,b){const c=b.key,d=c.path.canonicalString();a.Bo.get(c)||a.Lo.has(d)||(QA("SyncEngine","New document in limbo: "+c),a.Lo.add(d),Laa(a))}function Laa(a){for(;a.Lo.size>0&&a.Bo.size<a.maxConcurrentLimboResolutions;){const b=a.Lo.values().next().value;a.Lo.delete(b);const c=new GD(PC.fromString(b)),d=a.Qo.next();a.Uo.set(d,new maa(c)),a.Bo=a.Bo.insert(c,d),c7(a.remoteStore,new YP(zG(sG(c.path)),d,2,PB.I))}}async function Maa(a,b,c){const d=WA(a),e=[],f=[],g=[];d.Mo.isEmpty()||(d.Mo.forEach((a,h)=>{g.push(d.Go(h,b,c).then(a=>{if(a){d.isPrimaryClient&&d.sharedClientState.updateQueryState(h.targetId,a.fromCache?"not-current":"current"),e.push(a);const b=VY.$n(h.targetId,a);f.push(b)}}))}),await Promise.all(g),d.Oo.br(e),await async function(a,b){const c=WA(a);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",a=>xN.forEach(b,b=>xN.forEach(b.kn,d=>c.persistence.referenceDelegate.addReference(a,b.targetId,d)).next(()=>xN.forEach(b.xn,d=>c.persistence.referenceDelegate.removeReference(a,b.targetId,d)))))}catch(d){if(!NO(d))throw d;QA("LocalStore","Failed to update sequence numbers: "+d)}for(const e of b){const f=e.targetId;if(!e.fromCache){const g=c.qn.get(f),h=g.snapshotVersion,i=g.withLastLimboFreeSnapshotVersion(h);c.qn=c.qn.insert(f,i)}}}(d.localStore,f))}async function Naa(a,b){const c=WA(a);if(!c.currentUser.isEqual(b)){var d,e;QA("SyncEngine","User change. New user:",b.toKey());const f=await BZ(c.localStore,b);c.currentUser=b,e="'waitForPendingWrites' promise is rejected due to a user change.",(d=c).jo.forEach(a=>{a.forEach(a=>{a.reject(new YA(XA.CANCELLED,e))})}),d.jo.clear(),c.sharedClientState.handleUserChange(b,f.removedBatchIds,f.addedBatchIds),await Maa(c,f.Gn)}}function Oaa(a,b){const c=WA(a),d=c.Uo.get(b);if(d&&d.$o)return QJ().add(d.key);{let e=QJ();const f=c.Fo.get(b);if(!f)return e;for(const g of f){const h=c.Mo.get(g);e=e.unionWith(h.view.bo)}return e}}async function Paa(a,b){const c=WA(a),d=await HZ(c.localStore,b.query,!0),e=b.view.ko(d);return c.isPrimaryClient&&Jaa(c,b.targetId,e.Co),e}async function Qaa(a){const b=WA(a);return JZ(b.localStore).then(a=>Maa(b,a))}async function Raa(a,b,c,d){const e=WA(a),f=await function(a,b){const c=WA(a),d=WA(c.An);return c.persistence.runTransaction("Lookup mutation documents","readonly",a=>d.Zt(a,b).next(b=>b?c.Wn.vn(a,b):xN.resolve(null)))}(e.localStore,b);null!==f?("pending"===c?await p7(e.remoteStore):"acknowledged"===c||"rejected"===c?(Gaa(e,b,d||null),Faa(e,b),(function(a,b){WA(WA(a).An).ee(b)})(e.localStore,b)):UA(),await Maa(e,f)):QA("SyncEngine","Cannot apply mutation batch with id: "+b)}async function Saa(a,b){const c=WA(a);if(Yaa(c),Zaa(c),!0===b&& !0!==c.Wo){const d=c.sharedClientState.getAllActiveQueryTargets(),e=await Taa(c,d.toArray());for(const f of(c.Wo=!0,await y7(c.remoteStore,!0),e))c7(c.remoteStore,f)}else if(!1===b&& !1!==c.Wo){const g=[];let h=Promise.resolve();c.Fo.forEach((a,b)=>{c.sharedClientState.isLocalQueryTarget(b)?g.push(b):h=h.then(()=>(Haa(c,b),GZ(c.localStore,b,!0))),d7(c.remoteStore,b)}),await h,await Taa(c,g),(function(a){const b=WA(a);b.Uo.forEach((a,c)=>{d7(b.remoteStore,c)}),b.qo.hs(),b.Uo=new Map,b.Bo=new PH(GD.comparator)})(c),c.Wo=!1,await y7(c.remoteStore,!1)}}async function Taa(a,b,c){const d=WA(a),e=[],f=[];for(const g of b){let h;const i=d.Fo.get(g);if(i&&0!==i.length)for(const j of(h=await FZ(d.localStore,zG(i[0])),i)){const k=d.Mo.get(j),l=await Paa(d,k);l.snapshot&&f.push(l.snapshot)}else{const m=await IZ(d.localStore,g);h=await FZ(d.localStore,m),await waa(d,Uaa(m),g,!1)}e.push(h)}return d.Oo.br(f),e}function Uaa(a){return rG(a.path,a.collectionGroup,a.orderBy,a.filters,a.limit,"F",a.startAt,a.endAt)}function Vaa(a){const b=WA(a);return WA(WA(b.localStore).persistence).Tn()}async function Waa(a,b,c,d){const e=WA(a);if(e.Wo)QA("SyncEngine","Ignoring unexpected query state notification.");else if(e.Fo.has(b))switch(c){case"current":case"not-current":{const f=await JZ(e.localStore),g=TJ.createSynthesizedRemoteEventForCurrentChange(b,"current"===c);await Maa(e,f,g);break}case"rejected":await GZ(e.localStore,b,!0),Haa(e,b,d);break;default:UA()}}async function Xaa(a,b,c){const d=Yaa(a);if(d.Wo){for(const e of b){if(d.Fo.has(e)){QA("SyncEngine","Adding an already active target "+e);continue}const f=await IZ(d.localStore,e),g=await FZ(d.localStore,f);await waa(d,Uaa(f),g.targetId,!1),c7(d.remoteStore,g)}for(const h of c)d.Fo.has(h)&&await GZ(d.localStore,h,!1).then(()=>{d7(d.remoteStore,h),Haa(d,h)}).catch(dS)}}function Yaa(a){const b=WA(a);return b.remoteStore.remoteSyncer.applyRemoteEvent=zaa.bind(null,b),b.remoteStore.remoteSyncer.getRemoteKeysForTarget=Oaa.bind(null,b),b.remoteStore.remoteSyncer.rejectListen=Baa.bind(null,b),b.Oo.br=L8.bind(null,b.eventManager),b.Oo.zo=M8.bind(null,b.eventManager),b}function Zaa(a){const b=WA(a);return b.remoteStore.remoteSyncer.applySuccessfulWrite=Caa.bind(null,b),b.remoteStore.remoteSyncer.rejectFailedWrite=Daa.bind(null,b),b}class $aa{constructor(){this.synchronizeTabs=!1}async initialize(_aa){this.k=u5(_aa.databaseInfo.databaseId),this.sharedClientState=this.Jo(_aa),this.persistence=this.Yo(_aa),await this.persistence.start(),this.gcScheduler=this.Xo(_aa),this.localStore=this.Zo(_aa)}Xo(aba){return null}Zo(bba){return AZ(this.persistence,new dZ,bba.initialUser,this.k)}Yo(cba){return new Y_(l1.ks,this.k)}Jo(dba){return new a4}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class eba extends $aa{constructor(fba,gba,hba){super(),this.tc=fba,this.cacheSizeBytes=gba,this.forceOwnership=hba,this.synchronizeTabs=!1}async initialize(iba){await super.initialize(iba),await KZ(this.localStore),await this.tc.initialize(this,iba),await Zaa(this.tc.syncEngine),await p7(this.tc.remoteStore),await this.persistence.sn(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(this.localStore),Promise.resolve()))}Zo(jba){return AZ(this.persistence,new dZ,jba.initialUser,this.k)}Xo(kba){const lba=this.persistence.referenceDelegate.garbageCollector;return new kS(lba,kba.asyncQueue)}Yo(mba){const nba=fY(mba.databaseInfo.databaseId,mba.databaseInfo.persistenceKey),oba=void 0!==this.cacheSizeBytes?JQ.withCacheSize(this.cacheSizeBytes):JQ.DEFAULT;return new lT(this.synchronizeTabs,nba,mba.clientId,oba,mba.asyncQueue,s5(),t5(),this.k,this.sharedClientState,!!this.forceOwnership)}Jo(pba){return new a4}}class qba extends eba{constructor(rba,sba){super(rba,sba,!1),this.tc=rba,this.cacheSizeBytes=sba,this.synchronizeTabs=!0}async initialize(tba){await super.initialize(tba);const uba=this.tc.syncEngine;this.sharedClientState instanceof v2&&(this.sharedClientState.syncEngine={mi:Raa.bind(null,uba),gi:Waa.bind(null,uba),yi:Xaa.bind(null,uba),Tn:Vaa.bind(null,uba),_i:Qaa.bind(null,uba)},await this.sharedClientState.start()),await this.persistence.sn(async a=>{await Saa(this.tc.syncEngine,a),this.gcScheduler&&(a&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):a||this.gcScheduler.stop())})}Jo(vba){const wba=s5();if(!v2.Pt(wba))throw new YA(XA.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const xba=fY(vba.databaseInfo.databaseId,vba.databaseInfo.persistenceKey);return new v2(wba,vba.asyncQueue,xba,vba.clientId,vba.initialUser)}}class yba{async initialize(zba,Aba){this.localStore||(this.localStore=zba.localStore,this.sharedClientState=zba.sharedClientState,this.datastore=this.createDatastore(Aba),this.remoteStore=this.createRemoteStore(Aba),this.eventManager=this.createEventManager(Aba),this.syncEngine=this.createSyncEngine(Aba,!zba.synchronizeTabs),this.sharedClientState.onlineStateHandler=a=>Aaa(this.syncEngine,a,1),this.remoteStore.remoteSyncer.handleCredentialChange=Naa.bind(null,this.syncEngine),await y7(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(Bba){return new I8}createDatastore(Cba){var Dba,Eba,Fba,Gba,Hba;const Iba=u5(Cba.databaseInfo.databaseId),Jba=(Dba=Cba.databaseInfo,new H4(Dba));return Eba=Cba.authCredentials,Fba=Cba.appCheckCredentials,Gba=Jba,Hba=Iba,new E6(Eba,Fba,Gba,Hba)}createRemoteStore(Kba){var Lba,Mba,Nba,Oba,Pba;return Lba=this.localStore,Mba=this.datastore,Nba=Kba.asyncQueue,Oba=a=>Aaa(this.syncEngine,a,0),Pba=u4.Pt()?new u4:new s4,new P6(Lba,Mba,Nba,Oba,Pba)}createSyncEngine(Qba,Rba){return(function(a,b,c,d,e,f,g){const h=new oaa(a,b,c,d,e,f);return g&&(h.Wo=!0),h})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,Qba.initialUser,Qba.maxConcurrentLimboResolutions,Rba)}terminate(){return(async function(a){const b=WA(a);QA("RemoteStore","RemoteStore shutting down."),b.Gr.add(5),await b7(b),b.Hr.shutdown(),b.Jr.set("Unknown")})(this.remoteStore)}}function Sba(a,b=10240){let c=0;return{async read(){if(c<a.byteLength){const d={value:a.slice(c,c+b),done:!1};return c+=b,d}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.reject("unimplemented")}}class Tba{constructor(Uba){this.observer=Uba,this.muted=!1}next(Vba){this.observer.next&&this.ec(this.observer.next,Vba)}error(Wba){this.observer.error?this.ec(this.observer.error,Wba):console.error("Uncaught Error in snapshot listener:",Wba)}nc(){this.muted=!0}ec(Xba,Yba){this.muted||setTimeout(()=>{this.muted||Xba(Yba)},0)}}class Zba{constructor($ba,_ba){this.sc=$ba,this.k=_ba,this.metadata=new _A,this.buffer=new Uint8Array,this.ic=new TextDecoder("utf-8"),this.rc().then(a=>{a&&a._o()?this.metadata.resolve(a.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==a?void 0:a.payload)}`))},a=>this.metadata.reject(a))}close(){return this.sc.cancel()}async getMetadata(){return this.metadata.promise}async Ho(){return await this.getMetadata(),this.rc()}async rc(){const aca=await this.oc();if(null===aca)return null;const bca=this.ic.decode(aca),cca=Number(bca);isNaN(cca)&&this.cc(`length string (${bca}) is not valid number`);const dca=await this.ac(cca);return new d9(JSON.parse(dca),aca.length+cca)}uc(){return this.buffer.findIndex(a=>123===a)}async oc(){for(;0>this.uc()&&!await this.hc(););if(0===this.buffer.length)return null;const eca=this.uc();eca<0&&this.cc("Reached the end of bundle when a length string is expected.");const fca=this.buffer.slice(0,eca);return this.buffer=this.buffer.slice(eca),fca}async ac(gca){for(;this.buffer.length<gca;)await this.hc()&&this.cc("Reached the end of bundle when more is expected.");const hca=this.ic.decode(this.buffer.slice(0,gca));return this.buffer=this.buffer.slice(gca),hca}cc(ica){throw this.sc.cancel(),new Error(`Invalid bundle format: ${ica}`)}async hc(){const jca=await this.sc.read();if(!jca.done){const kca=new Uint8Array(this.buffer.length+jca.value.length);kca.set(this.buffer),kca.set(jca.value,this.buffer.length),this.buffer=kca}return jca.done}}class lca{constructor(mca){this.datastore=mca,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(nca){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new YA(XA.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const oca=await async function(a,b){const c=WA(a),d=FL(c.k)+"/documents",e={documents:b.map(a=>BL(c.k,a))},f=await c.ji("BatchGetDocuments",d,e),g=new Map;f.forEach(a=>{var b,d;const e=(b=c.k,"found"in(d=a)?function(a,b){VA(!!b.found),b.found.name,b.found.updateTime;const c=CL(a,b.found.name),d=yL(b.found.updateTime),e=new cE({mapValue:{fields:b.found.fields}});return AE.newFoundDocument(c,d,e)}(b,d):"missing"in d?function(a,b){VA(!!b.missing),VA(!!b.readTime);const c=CL(a,b.missing),d=yL(b.readTime);return AE.newNoDocument(c,d)}(b,d):UA());g.set(e.key.toString(),e)});const h=[];return b.forEach(a=>{const b=g.get(a.toString());VA(!!b),h.push(b)}),h}(this.datastore,nca);return oca.forEach(a=>this.recordVersion(a)),oca}set(pca,qca){this.write(qca.toMutation(pca,this.precondition(pca))),this.writtenDocs.add(pca.toString())}update(rca,sca){try{this.write(sca.toMutation(rca,this.preconditionForUpdate(rca)))}catch(tca){this.lastWriteError=tca}this.writtenDocs.add(rca.toString())}delete(uca){this.write(new FH(uca,this.precondition(uca))),this.writtenDocs.add(uca.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const vca=this.readVersions;this.mutations.forEach(a=>{vca.delete(a.key.toString())}),vca.forEach((a,b)=>{const c=GD.fromPath(b);this.mutations.push(new IH(c,this.precondition(c)))}),await async function(a,b){const c=WA(a),d=FL(c.k)+"/documents",e={writes:b.map(a=>JL(c.k,a))};await c.Bi("Commit",d,e)}(this.datastore,this.mutations),this.committed=!0}recordVersion(wca){let xca;if(wca.isFoundDocument())xca=wca.version;else{if(!wca.isNoDocument())throw UA();xca=lC.min()}const yca=this.readVersions.get(wca.key.toString());if(yca){if(!xca.isEqual(yca))throw new YA(XA.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(wca.key.toString(),xca)}precondition(zca){const Aca=this.readVersions.get(zca.toString());return!this.writtenDocs.has(zca.toString())&&Aca?eH.updateTime(Aca):eH.none()}preconditionForUpdate(Bca){const Cca=this.readVersions.get(Bca.toString());if(!this.writtenDocs.has(Bca.toString())&&Cca){if(Cca.isEqual(lC.min()))throw new YA(XA.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return eH.updateTime(Cca)}return eH.exists(!0)}write(Dca){this.ensureCommitNotCalled(),this.mutations.push(Dca)}ensureCommitNotCalled(){}}class Eca{constructor(Fca,Gca,Hca,Ica){this.asyncQueue=Fca,this.datastore=Gca,this.updateFunction=Hca,this.deferred=Ica,this.lc=5,this.ur=new v5(this.asyncQueue,"transaction_retry")}run(){this.lc-=1,this.fc()}fc(){this.ur.Zi(async()=>{const a=new lca(this.datastore),b=this.dc(a);b&&b.then(b=>{this.asyncQueue.enqueueAndForget(()=>a.commit().then(()=>{this.deferred.resolve(b)}).catch(a=>{this.wc(a)}))}).catch(a=>{this.wc(a)})})}dc(Jca){try{const Kca=this.updateFunction(Jca);return!DD(Kca)&&Kca.catch&&Kca.then?Kca:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(Lca){return this.deferred.reject(Lca),null}}wc(Mca){this.lc>0&&this._c(Mca)?(this.lc-=1,this.asyncQueue.enqueueAndForget(()=>(this.fc(),Promise.resolve()))):this.deferred.reject(Mca)}_c(Nca){if("FirebaseError"===Nca.name){const Oca=Nca.code;return"aborted"===Oca||"failed-precondition"===Oca||!NH(Oca)}return!1}}class Pca{constructor(Qca,Rca,Sca,Tca){this.authCredentials=Qca,this.appCheckCredentials=Rca,this.asyncQueue=Sca,this.databaseInfo=Tca,this.user=KA.UNAUTHENTICATED,this.clientId=VB.A(),this.authCredentialListener=()=>Promise.resolve(),this.authCredentials.start(Sca,async a=>{QA("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(Sca,()=>Promise.resolve())}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(Uca){this.authCredentialListener=Uca}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new YA(XA.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const Vca=new _A;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),Vca.resolve()}catch(a){const b=Q7(a,"Failed to shutdown persistence");Vca.reject(b)}}),Vca.promise}}async function Wca(a,b){a.asyncQueue.verifyOperationInProgress(),QA("FirestoreClient","Initializing OfflineComponentProvider");const c=await a.getConfiguration();await b.initialize(c);let d=c.initialUser;a.setCredentialChangeListener(async a=>{d.isEqual(a)||(await BZ(b.localStore,a),d=a)}),b.persistence.setDatabaseDeletedListener(()=>a.terminate()),a.offlineComponents=b}async function Xca(a,b){a.asyncQueue.verifyOperationInProgress();const c=await Yca(a);QA("FirestoreClient","Initializing OnlineComponentProvider");const d=await a.getConfiguration();await b.initialize(c,d),a.setCredentialChangeListener(a=>(async function(a,b){const c=WA(a);c.asyncQueue.verifyOperationInProgress(),QA("RemoteStore","RemoteStore received new credentials");const d=i7(c);c.Gr.add(3),await b7(c),d&&c.Jr.set("Unknown"),await c.remoteSyncer.handleCredentialChange(b),c.Gr.delete(3),await a7(c)})(b.remoteStore,a)),a.onlineComponents=b}async function Yca(a){return a.offlineComponents||(QA("FirestoreClient","Using default OfflineComponentProvider"),await Wca(a,new $aa)),a.offlineComponents}async function Zca(a){return a.onlineComponents||(QA("FirestoreClient","Using default OnlineComponentProvider"),await Xca(a,new yba)),a.onlineComponents}function $ca(a){return Yca(a).then(a=>a.persistence)}function _ca(a){return Yca(a).then(a=>a.localStore)}function ada(a){return Zca(a).then(a=>a.remoteStore)}function bda(a){return Zca(a).then(a=>a.syncEngine)}async function cda(a){const b=await Zca(a),c=b.eventManager;return c.onListen=vaa.bind(null,b.syncEngine),c.onUnlisten=xaa.bind(null,b.syncEngine),c}function dda(a,b,c={}){const d=new _A;return a.asyncQueue.enqueueAndForget(async()=>(function(a,b,c,d,e){const f=new Tba({next:f=>{b.enqueueAndForget(()=>K8(a,g));const h=f.docs.has(c);!h&&f.fromCache?e.reject(new YA(XA.UNAVAILABLE,"Failed to get document because the client is offline.")):h&&f.fromCache&&d&&"server"===d.source?e.reject(new YA(XA.UNAVAILABLE,"Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to \"server\" to retrieve the cached document.)")):e.resolve(f)},error:a=>e.reject(a)}),g=new O8(sG(c.path),f,{includeMetadataChanges:!0,wo:!0});return J8(a,g)})(await cda(a),a.asyncQueue,b,c,d)),d.promise}function eda(a,b,c={}){const d=new _A;return a.asyncQueue.enqueueAndForget(async()=>(function(a,b,c,d,e){const f=new Tba({next:c=>{b.enqueueAndForget(()=>K8(a,g)),c.fromCache&&"server"===d.source?e.reject(new YA(XA.UNAVAILABLE,"Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to \"server\" to retrieve the cached documents.)")):e.resolve(c)},error:a=>e.reject(a)}),g=new O8(c,f,{includeMetadataChanges:!0,wo:!0});return J8(a,g)})(await cda(a),a.asyncQueue,b,c,d)),d.promise}class fda{constructor(gda,hda,ida,jda,kda,lda,mda,nda){this.databaseId=gda,this.appId=hda,this.persistenceKey=ida,this.host=jda,this.ssl=kda,this.forceLongPolling=lda,this.autoDetectLongPolling=mda,this.useFetchStreams=nda}}class oda{constructor(pda,qda){this.projectId=pda,this.database=qda||"(default)"}get isDefaultDatabase(){return"(default)"===this.database}isEqual(rda){return rda instanceof oda&&rda.projectId===this.projectId&&rda.database===this.database}}const sda=new Map;function tda(a,b,c){if(!c)throw new YA(XA.INVALID_ARGUMENT,`Function ${a}() cannot be called with an empty ${b}.`)}function uda(a,b,c,d){if(!0===b&& !0===d)throw new YA(XA.INVALID_ARGUMENT,`${a} and ${c} cannot be used together.`)}function vda(a){if(!GD.isDocumentKey(a))throw new YA(XA.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${a} has ${a.length}.`)}function wda(a){if(GD.isDocumentKey(a))throw new YA(XA.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${a} has ${a.length}.`)}function xda(a){if(void 0===a)return"undefined";if(null===a)return"null";if("string"==typeof a)return a.length>20&&(a=`${a.substring(0,20)}...`),JSON.stringify(a);if("number"==typeof a||"boolean"==typeof a)return""+a;if("object"==typeof a){if(a instanceof Array)return"an array";{var b;const c=(b=a).constructor?b.constructor.name:null;return c?`a custom ${c} object`:"an object"}}return"function"==typeof a?"a function":UA()}function yda(a,b){if("_delegate"in a&&(a=a._delegate),!(a instanceof b)){if(b.name===a.constructor.name)throw new YA(XA.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const c=xda(a);throw new YA(XA.INVALID_ARGUMENT,`Expected type '${b.name}', but it was: ${c}`)}}return a}function zda(a,b){if(b<=0)throw new YA(XA.INVALID_ARGUMENT,`Function ${a}() requires a positive number, but it was: ${b}.`)}class Ada{constructor(Bda){var Cda;if(void 0===Bda.host){if(void 0!==Bda.ssl)throw new YA(XA.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=Bda.host,this.ssl=null===(Cda=Bda.ssl)|| void 0===Cda||Cda;if(this.credentials=Bda.credentials,this.ignoreUndefinedProperties=!!Bda.ignoreUndefinedProperties,void 0===Bda.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==Bda.cacheSizeBytes&&Bda.cacheSizeBytes<1048576)throw new YA(XA.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=Bda.cacheSizeBytes}this.experimentalForceLongPolling=!!Bda.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!Bda.experimentalAutoDetectLongPolling,this.useFetchStreams=!!Bda.useFetchStreams,uda("experimentalForceLongPolling",Bda.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",Bda.experimentalAutoDetectLongPolling)}isEqual(Dda){return this.host===Dda.host&&this.ssl===Dda.ssl&&this.credentials===Dda.credentials&&this.cacheSizeBytes===Dda.cacheSizeBytes&&this.experimentalForceLongPolling===Dda.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===Dda.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===Dda.ignoreUndefinedProperties&&this.useFetchStreams===Dda.useFetchStreams}}class Eda{constructor(Fda,Gda,Hda){this._authCredentials=Gda,this._appCheckCredentials=Hda,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ada({}),this._settingsFrozen=!1,Fda instanceof oda?this._databaseId=Fda:(this._app=Fda,this._databaseId=(function(a){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new YA(XA.INVALID_ARGUMENT,"\"projectId\" not provided in firebase.initializeApp.");return new oda(a.options.projectId)})(Fda))}get app(){if(!this._app)throw new YA(XA.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(Ida){if(this._settingsFrozen)throw new YA(XA.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ada(Ida),void 0!==Ida.credentials&&(this._authCredentials=(function(a){if(!a)return new dB;switch(a.type){case"gapi":const b=a.client;return VA(!("object"!=typeof b||null===b||!b.auth||!b.auth.getAuthHeaderValueForFirstParty)),new BB(b,a.sessionIndex||"0",a.iamToken||null);case"provider":return a.client;default:throw new YA(XA.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(Ida.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(a){const b=sda.get(a);b&&(QA("ComponentProvider","Removing Datastore"),sda.delete(a),b.terminate())})(this),Promise.resolve()}}class Jda{constructor(Kda,Lda,Mda){this.converter=Lda,this._key=Mda,this.type="document",this.firestore=Kda}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Tda(this.firestore,this.converter,this._key.path.popLast())}withConverter(Nda){return new Jda(this.firestore,Nda,this._key)}}class Oda{constructor(Pda,Qda,Rda){this.converter=Qda,this._query=Rda,this.type="query",this.firestore=Pda}withConverter(Sda){return new Oda(this.firestore,Sda,this._query)}}class Tda extends Oda{constructor(Uda,Vda,Wda){super(Uda,Vda,sG(Wda)),this._path=Wda,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const Xda=this._path.popLast();return Xda.isEmpty()?null:new Jda(this.firestore,null,new GD(Xda))}withConverter(Yda){return new Tda(this.firestore,Yda,this._path)}}function Zda(a,b,...c){if(a=xa(a),tda("collection","path",b),a instanceof Eda){const d=PC.fromString(b,...c);return wda(d),new Tda(a,null,d)}{if(!(a instanceof Jda||a instanceof Tda))throw new YA(XA.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const e=a._path.child(PC.fromString(b,...c));return wda(e),new Tda(a.firestore,null,e)}}function $da(a,b,...c){if(a=xa(a),1===arguments.length&&(b=VB.A()),tda("doc","path",b),a instanceof Eda){const d=PC.fromString(b,...c);return vda(d),new Jda(a,null,new GD(d))}{if(!(a instanceof Jda||a instanceof Tda))throw new YA(XA.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const e=a._path.child(PC.fromString(b,...c));return vda(e),new Jda(a.firestore,a instanceof Tda?a.converter:null,new GD(e))}}function _da(a,b){return a=xa(a),b=xa(b),(a instanceof Jda||a instanceof Tda)&&(b instanceof Jda||b instanceof Tda)&&a.firestore===b.firestore&&a.path===b.path&&a.converter===b.converter}function aea(a,b){return a=xa(a),b=xa(b),a instanceof Oda&&b instanceof Oda&&a.firestore===b.firestore&&BG(a._query,b._query)&&a.converter===b.converter}function bea(a){return(function(a,b){if("object"!=typeof a||null===a)return!1;const c=a;for(const d of b)if(d in c&&"function"==typeof c[d])return!0;return!1})(a,["next","error","complete"])}class cea{constructor(){this._progressObserver={},this._taskCompletionResolver=new _A,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(dea,eea,fea){this._progressObserver={next:dea,error:eea,complete:fea}}catch(gea){return this._taskCompletionResolver.promise.catch(gea)}then(hea,iea){return this._taskCompletionResolver.promise.then(hea,iea)}_completeWith(jea){this._updateProgress(jea),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(jea)}_failWith(kea){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(kea),this._taskCompletionResolver.reject(kea)}_updateProgress(lea){this._lastProgress=lea,this._progressObserver.next&&this._progressObserver.next(lea)}}class mea extends Eda{constructor(nea,oea,pea){super(nea,oea,pea),this.type="firestore",this._queue=new class{constructor(){this.mc=Promise.resolve(),this.gc=[],this.yc=!1,this.Tc=[],this.Ec=null,this.Ic=!1,this.Ac=!1,this.Rc=[],this.ur=new v5(this,"async_queue_retry"),this.bc=()=>{const a=t5();a&&QA("AsyncQueue","Visibility state changed to "+a.visibilityState),this.ur.er()};const qea=t5();qea&&"function"==typeof qea.addEventListener&&qea.addEventListener("visibilitychange",this.bc)}get isShuttingDown(){return this.yc}enqueueAndForget(rea){this.enqueue(rea)}enqueueAndForgetEvenWhileRestricted(sea){this.Pc(),this.vc(sea)}enterRestrictedMode(tea){if(!this.yc){this.yc=!0,this.Ac=tea||!1;const uea=t5();uea&&"function"==typeof uea.removeEventListener&&uea.removeEventListener("visibilitychange",this.bc)}}enqueue(vea){if(this.Pc(),this.yc)return new Promise(()=>{});const wea=new _A;return this.vc(()=>this.yc&&this.Ac?Promise.resolve():(vea().then(wea.resolve,wea.reject),wea.promise)).then(()=>wea.promise)}enqueueRetryable(xea){this.enqueueAndForget(()=>(this.gc.push(xea),this.Vc()))}async Vc(){if(0!==this.gc.length){try{await this.gc[0](),this.gc.shift(),this.ur.reset()}catch(yea){if(!NO(yea))throw yea;QA("AsyncQueue","Operation failed with retryable error: "+yea)}this.gc.length>0&&this.ur.Zi(()=>this.Vc())}}vc(zea){const Aea=this.mc.then(()=>(this.Ic=!0,zea().catch(a=>{var b;this.Ec=a,this.Ic=!1;let c;const d=(c=(b=a).message||"",b.stack&&(c=b.stack.includes(b.message)?b.stack:b.message+"\n"+b.stack),c);throw RA("INTERNAL UNHANDLED ERROR: ",d),a}).then(a=>(this.Ic=!1,a))));return this.mc=Aea,Aea}enqueueAfterDelay(Bea,Cea,Dea){this.Pc(),this.Rc.indexOf(Bea)> -1&&(Cea=0);const Eea=B7.createAndSchedule(this,Bea,Cea,Dea,a=>this.Sc(a));return this.Tc.push(Eea),Eea}Pc(){this.Ec&&UA()}verifyOperationInProgress(){}async Dc(){let Fea;do await (Fea=this.mc);while(Fea!==this.mc)}Cc(Gea){for(const Hea of this.Tc)if(Hea.timerId===Gea)return!0;return!1}Nc(Iea){return this.Dc().then(()=>{for(const a of(this.Tc.sort((a,b)=>a.targetTimeMs-b.targetTimeMs),this.Tc))if(a.skipDelay(),"all"!==Iea&&a.timerId===Iea)break;return this.Dc()})}kc(Jea){this.Rc.push(Jea)}Sc(Kea){const Lea=this.Tc.indexOf(Kea);this.Tc.splice(Lea,1)}},this._persistenceKey="name"in nea?nea.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||Nea(this),this._firestoreClient.terminate()}}function Mea(a){return a._firestoreClient||Nea(a),a._firestoreClient.verifyNotTerminated(),a._firestoreClient}function Nea(a){var b,c,d,e,f;const g=a._freezeSettings(),h=(c=a._databaseId,d=(null===(b=a._app)|| void 0===b?void 0:b.options.appId)||"",e=a._persistenceKey,f=g,new fda(c,d,e,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,f.useFetchStreams));a._firestoreClient=new Pca(a._authCredentials,a._appCheckCredentials,a._queue,h)}function Oea(a,b,c){const d=new _A;return a.asyncQueue.enqueue(async()=>{try{await Wca(a,c),await Xca(a,b),d.resolve()}catch(e){var f;if("FirebaseError"===(f=e).name?f.code!==XA.FAILED_PRECONDITION&&f.code!==XA.UNIMPLEMENTED:"undefined"!=typeof DOMException&&f instanceof DOMException&&22!==f.code&&20!==f.code&&11!==f.code)throw e;console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),d.reject(e)}}).then(()=>d.promise)}function Pea(a){if(a._initialized||a._terminated)throw new YA(XA.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Qea{constructor(...Rea){for(let Sea=0;Sea<Rea.length;++Sea)if(0===Rea[Sea].length)throw new YA(XA.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new XC(Rea)}isEqual(Tea){return this._internalPath.isEqual(Tea._internalPath)}}class Uea{constructor(Vea){this._byteString=Vea}static fromBase64String(Wea){try{return new Uea(nD.fromBase64String(Wea))}catch(Xea){throw new YA(XA.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+Xea)}}static fromUint8Array(Yea){return new Uea(nD.fromUint8Array(Yea))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(Zea){return this._byteString.isEqual(Zea._byteString)}}class $ea{constructor(_ea){this._methodName=_ea}}class afa{constructor(bfa,cfa){if(!isFinite(bfa)||bfa< -90||bfa>90)throw new YA(XA.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+bfa);if(!isFinite(cfa)||cfa< -180||cfa>180)throw new YA(XA.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+cfa);this._lat=bfa,this._long=cfa}get latitude(){return this._lat}get longitude(){return this._long}isEqual(dfa){return this._lat===dfa._lat&&this._long===dfa._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(efa){return _B(this._lat,efa._lat)||_B(this._long,efa._long)}}const ffa=/^__.*__$/;class gfa{constructor(hfa,ifa,jfa){this.data=hfa,this.fieldMask=ifa,this.fieldTransforms=jfa}toMutation(kfa,lfa){return null!==this.fieldMask?new wH(kfa,this.data,this.fieldMask,lfa,this.fieldTransforms):new rH(kfa,this.data,lfa,this.fieldTransforms)}}class mfa{constructor(nfa,ofa,pfa){this.data=nfa,this.fieldMask=ofa,this.fieldTransforms=pfa}toMutation(qfa,rfa){return new wH(qfa,this.data,this.fieldMask,rfa,this.fieldTransforms)}}function sfa(a){switch(a){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw UA()}}class tfa{constructor(ufa,vfa,wfa,xfa,yfa,zfa){this.settings=ufa,this.databaseId=vfa,this.k=wfa,this.ignoreUndefinedProperties=xfa,void 0===yfa&&this.xc(),this.fieldTransforms=yfa||[],this.fieldMask=zfa||[]}get path(){return this.settings.path}get $c(){return this.settings.$c}Oc(Afa){return new tfa(Object.assign(Object.assign({},this.settings),Afa),this.databaseId,this.k,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mc(Bfa){var Cfa;const Dfa=null===(Cfa=this.path)|| void 0===Cfa?void 0:Cfa.child(Bfa),Efa=this.Oc({path:Dfa,Fc:!1});return Efa.Lc(Bfa),Efa}Bc(Ffa){var Gfa;const Hfa=null===(Gfa=this.path)|| void 0===Gfa?void 0:Gfa.child(Ffa),Ifa=this.Oc({path:Hfa,Fc:!1});return Ifa.xc(),Ifa}Uc(Jfa){return this.Oc({path:void 0,Fc:!0})}qc(Kfa){return Jga(Kfa,this.settings.methodName,this.settings.Kc||!1,this.path,this.settings.jc)}contains(Lfa){return void 0!==this.fieldMask.find(a=>Lfa.isPrefixOf(a))|| void 0!==this.fieldTransforms.find(a=>Lfa.isPrefixOf(a.field))}xc(){if(this.path)for(let Mfa=0;Mfa<this.path.length;Mfa++)this.Lc(this.path.get(Mfa))}Lc(Nfa){if(0===Nfa.length)throw this.qc("Document fields must not be empty");if(sfa(this.$c)&&ffa.test(Nfa))throw this.qc("Document fields cannot begin and end with \"__\"")}}class Ofa{constructor(Pfa,Qfa,Rfa){this.databaseId=Pfa,this.ignoreUndefinedProperties=Qfa,this.k=Rfa||u5(Pfa)}Qc(Sfa,Tfa,Ufa,Vfa=!1){return new tfa({$c:Sfa,methodName:Tfa,jc:Ufa,path:XC.emptyPath(),Fc:!1,Kc:Vfa},this.databaseId,this.k,this.ignoreUndefinedProperties)}}function Wfa(a){const b=a._freezeSettings(),c=u5(a._databaseId);return new Ofa(a._databaseId,!!b.ignoreUndefinedProperties,c)}function Xfa(a,b,c,d,e,f={}){const g=a.Qc(f.merge||f.mergeFields?2:0,b,c,e);Fga("Data must be an object, but it was:",g,d);const h=Dga(d,g);let i,j;if(f.merge)i=new iD(g.fieldMask),j=g.fieldTransforms;else if(f.mergeFields){const k=[];for(const l of f.mergeFields){const m=Gga(b,l,c);if(!g.contains(m))throw new YA(XA.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);Kga(k,m)||k.push(m)}i=new iD(k),j=g.fieldTransforms.filter(a=>i.covers(a.field))}else i=null,j=g.fieldTransforms;return new gfa(new cE(h),i,j)}class Yfa extends $ea{_toFieldTransform(Zfa){if(2!==Zfa.$c)throw 1===Zfa.$c?Zfa.qc(`${this._methodName}() can only appear at the top level of your update data`):Zfa.qc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return Zfa.fieldMask.push(Zfa.path),null}isEqual($fa){return $fa instanceof Yfa}}function _fa(a,b,c){return new tfa({$c:3,jc:b.settings.jc,methodName:a._methodName,Fc:c},b.databaseId,b.k,b.ignoreUndefinedProperties)}class aga extends $ea{_toFieldTransform(bga){return new $G(bga.path,new OG)}isEqual(cga){return cga instanceof aga}}class dga extends $ea{constructor(ega,fga){super(ega),this.Wc=fga}_toFieldTransform(gga){const hga=_fa(this,gga,!0),iga=this.Wc.map(a=>Cga(a,hga)),jga=new PG(iga);return new $G(gga.path,jga)}isEqual(kga){return this===kga}}class lga extends $ea{constructor(mga,nga){super(mga),this.Wc=nga}_toFieldTransform(oga){const pga=_fa(this,oga,!0),qga=this.Wc.map(a=>Cga(a,pga)),rga=new SG(qga);return new $G(oga.path,rga)}isEqual(sga){return this===sga}}class tga extends $ea{constructor(uga,vga){super(uga),this.Gc=vga}_toFieldTransform(wga){const xga=new VG(wga.k,JG(wga.k,this.Gc));return new $G(wga.path,xga)}isEqual(yga){return this===yga}}function zga(a,b,c,d){const e=a.Qc(1,b,c);Fga("Data must be an object, but it was:",e,d);const f=[],g=cE.empty();rC(d,(a,d)=>{const h=Iga(b,a,c);d=xa(d);const i=e.Bc(h);if(d instanceof Yfa)f.push(h);else{const j=Cga(d,i);null!=j&&(f.push(h),g.set(h,j))}});const h=new iD(f);return new mfa(g,h,e.fieldTransforms)}function Aga(a,b,c,d,e,f){const g=a.Qc(1,b,c),h=[Gga(b,d,c)],i=[e];if(f.length%2!=0)throw new YA(XA.INVALID_ARGUMENT,`Function ${b}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let j=0;j<f.length;j+=2)h.push(Gga(b,f[j])),i.push(f[j+1]);const k=[],l=cE.empty();for(let m=h.length-1;m>=0;--m)if(!Kga(k,h[m])){const n=h[m];let o=i[m];o=xa(o);const p=g.Bc(n);if(o instanceof Yfa)k.push(n);else{const q=Cga(o,p);null!=q&&(k.push(n),l.set(n,q))}}const r=new iD(k);return new mfa(l,r,g.fieldTransforms)}function Bga(a,b,c,d=!1){return Cga(c,a.Qc(d?4:3,b))}function Cga(a,b){if(Ega(a=xa(a)))return Fga("Unsupported field value:",b,a),Dga(a,b);if(a instanceof $ea)return(function(a,b){if(!sfa(b.$c))throw b.qc(`${a._methodName}() can only be used with update() and set()`);if(!b.path)throw b.qc(`${a._methodName}() is not currently supported inside arrays`);const c=a._toFieldTransform(b);c&&b.fieldTransforms.push(c)})(a,b),null;if(void 0===a&&b.ignoreUndefinedProperties)return null;if(b.path&&b.fieldMask.push(b.path),a instanceof Array){if(b.settings.Fc&&4!==b.$c)throw b.qc("Nested arrays are not supported");return(function(a,b){const c=[];let d=0;for(const e of a){let f=Cga(e,b.Uc(d));null==f&&(f={nullValue:"NULL_VALUE"}),c.push(f),d++}return{arrayValue:{values:c}}})(a,b)}return(function(a,b){if(null===(a=xa(a)))return{nullValue:"NULL_VALUE"};if("number"==typeof a)return JG(b.k,a);if("boolean"==typeof a)return{booleanValue:a};if("string"==typeof a)return{stringValue:a};if(a instanceof Date){const c=cC.fromDate(a);return{timestampValue:wL(b.k,c)}}if(a instanceof cC){const d=new cC(a.seconds,1000*Math.floor(a.nanoseconds/1000));return{timestampValue:wL(b.k,d)}}if(a instanceof afa)return{geoPointValue:{latitude:a.latitude,longitude:a.longitude}};if(a instanceof Uea)return{bytesValue:xL(b.k,a._byteString)};if(a instanceof Jda){const e=b.databaseId,f=a.firestore._databaseId;if(!f.isEqual(e))throw b.qc(`Document reference is for database ${f.projectId}/${f.database} but should be for database ${e.projectId}/${e.database}`);return{referenceValue:zL(a.firestore._databaseId||b.databaseId,a._key.path)}}throw b.qc(`Unsupported field value: ${xda(a)}`)})(a,b)}function Dga(a,b){const c={};return sC(a)?b.path&&b.path.length>0&&b.fieldMask.push(b.path):rC(a,(a,d)=>{const e=Cga(d,b.Mc(a));null!=e&&(c[a]=e)}),{mapValue:{fields:c}}}function Ega(a){return!("object"!=typeof a||null===a||a instanceof Array||a instanceof Date||a instanceof cC||a instanceof afa||a instanceof Uea||a instanceof Jda||a instanceof $ea)}function Fga(a,b,c){var d;if(!Ega(c)||"object"!=typeof(d=c)||null===d||Object.getPrototypeOf(d)!==Object.prototype&&null!==Object.getPrototypeOf(d)){const e=xda(c);throw"an object"===e?b.qc(a+" a custom object"):b.qc(a+" "+e)}}function Gga(a,b,c){if((b=xa(b))instanceof Qea)return b._internalPath;if("string"==typeof b)return Iga(a,b);throw Jga("Field path arguments must be of type string or ",a,!1,void 0,c)}const Hga=new RegExp("[~\\*/\\[\\]]");function Iga(a,b,c){if(b.search(Hga)>=0)throw Jga(`Invalid field path (${b}). Paths must not contain '~', '*', '/', '[', or ']'`,a,!1,void 0,c);try{return new Qea(...b.split("."))._internalPath}catch(d){throw Jga(`Invalid field path (${b}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,a,!1,void 0,c)}}function Jga(a,b,c,d,e){const f=d&&!d.isEmpty(),g=void 0!==e;let h=`Function ${b}() called with invalid data`;c&&(h+=" (via `toFirestore()`)"),h+=". ";let i="";return(f||g)&&(i+=" (found",f&&(i+=` in field ${d}`),g&&(i+=` in document ${e}`),i+=")"),new YA(XA.INVALID_ARGUMENT,h+a+i)}function Kga(a,b){return a.some(a=>a.isEqual(b))}class Lga{constructor(Mga,Nga,Oga,Pga,Qga){this._firestore=Mga,this._userDataWriter=Nga,this._key=Oga,this._document=Pga,this._converter=Qga}get id(){return this._key.path.lastSegment()}get ref(){return new Jda(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const Rga=new Uga(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(Rga)}return this._userDataWriter.convertValue(this._document.data.value)}}get(Sga){if(this._document){const Tga=this._document.data.field(Vga("DocumentSnapshot.get",Sga));if(null!==Tga)return this._userDataWriter.convertValue(Tga)}}}class Uga extends Lga{data(){return super.data()}}function Vga(a,b){return"string"==typeof b?Iga(a,b):b instanceof Qea?b._internalPath:b._delegate._internalPath}class Wga{constructor(Xga,Yga){this.hasPendingWrites=Xga,this.fromCache=Yga}isEqual(Zga){return this.hasPendingWrites===Zga.hasPendingWrites&&this.fromCache===Zga.fromCache}}class $ga extends Lga{constructor(_ga,aha,bha,cha,dha,eha){super(_ga,aha,bha,cha,eha),this._firestore=_ga,this._firestoreImpl=_ga,this.metadata=dha}exists(){return super.exists()}data(fha={}){if(this._document){if(this._converter){const gha=new kha(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(gha,fha)}return this._userDataWriter.convertValue(this._document.data.value,fha.serverTimestamps)}}get(hha,iha={}){if(this._document){const jha=this._document.data.field(Vga("DocumentSnapshot.get",hha));if(null!==jha)return this._userDataWriter.convertValue(jha,iha.serverTimestamps)}}}class kha extends $ga{data(lha={}){return super.data(lha)}}class mha{constructor(nha,oha,pha,qha){this._firestore=nha,this._userDataWriter=oha,this._snapshot=qha,this.metadata=new Wga(qha.hasPendingWrites,qha.fromCache),this.query=pha}get docs(){const rha=[];return this.forEach(a=>rha.push(a)),rha}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(sha,tha){this._snapshot.docs.forEach(a=>{sha.call(tha,new kha(this._firestore,this._userDataWriter,a.key,a,new Wga(this._snapshot.mutatedKeys.has(a.key),this._snapshot.fromCache),this.query.converter))})}docChanges(uha={}){const vha=!!uha.includeMetadataChanges;if(vha&&this._snapshot.excludesMetadataChanges)throw new YA(XA.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===vha||(this._cachedChanges=(function(a,b){if(a._snapshot.oldDocs.isEmpty()){let c=0;return a._snapshot.docChanges.map(b=>({type:"added",doc:new kha(a._firestore,a._userDataWriter,b.doc.key,b.doc,new Wga(a._snapshot.mutatedKeys.has(b.doc.key),a._snapshot.fromCache),a.query.converter),oldIndex:-1,newIndex:c++}))}{let d=a._snapshot.oldDocs;return a._snapshot.docChanges.filter(a=>b||3!==a.type).map(b=>{const c=new kha(a._firestore,a._userDataWriter,b.doc.key,b.doc,new Wga(a._snapshot.mutatedKeys.has(b.doc.key),a._snapshot.fromCache),a.query.converter);let e=-1,f=-1;return 0!==b.type&&(e=d.indexOf(b.doc.key),d=d.delete(b.doc.key)),1!==b.type&&(f=(d=d.add(b.doc)).indexOf(b.doc.key)),{type:wha(b.type),doc:c,oldIndex:e,newIndex:f}})}})(this,vha),this._cachedChangesIncludeMetadataChanges=vha),this._cachedChanges}}function wha(a){switch(a){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return UA()}}function xha(a,b){return a instanceof $ga&&b instanceof $ga?a._firestore===b._firestore&&a._key.isEqual(b._key)&&(null===a._document?null===b._document:a._document.isEqual(b._document))&&a._converter===b._converter:a instanceof mha&&b instanceof mha&&a._firestore===b._firestore&&aea(a.query,b.query)&&a.metadata.isEqual(b.metadata)&&a._snapshot.isEqual(b._snapshot)}function yha(a){if(uG(a)&&0===a.explicitOrderBy.length)throw new YA(XA.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class zha{}function Aha(a,...b){for(const c of b)a=c._apply(a);return a}class Bha extends zha{constructor(Cha,Dha,Eha){super(),this.zc=Cha,this.Hc=Dha,this.Jc=Eha,this.type="where"}_apply(Fha){const Gha=Wfa(Fha.firestore),Hha=function(a,b,c,d,e,f,g){let h;if(e.isKeyField()){if("array-contains"===f||"array-contains-any"===f)throw new YA(XA.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if("in"===f||"not-in"===f){iia(g,f);const i=[];for(const j of g)i.push(hia(d,a,j));h={arrayValue:{values:i}}}else h=hia(d,a,g)}else"in"!==f&&"not-in"!==f&&"array-contains-any"!==f||iia(g,f),h=Bga(c,b,g,"in"===f||"not-in"===f);const k=dF.create(e,f,h);return(function(a,b){if(b.V()){const c=wG(a);if(null!==c&&!c.isEqual(b.field))throw new YA(XA.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${c.toString()}' and '${b.field.toString()}'`);const d=vG(a);null!==d&&jia(a,b.field,d)}const e=function(a,b){for(const c of a.filters)if(b.indexOf(c.op)>=0)return c.op;return null}(a,function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(b.op));if(null!==e)throw e===b.op?new YA(XA.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${b.op.toString()}' filter.`):new YA(XA.INVALID_ARGUMENT,`Invalid query. You cannot use '${b.op.toString()}' filters with '${e.toString()}' filters.`)})(a,k),k}(Fha._query,"where",Gha,Fha.firestore._databaseId,this.zc,this.Hc,this.Jc);return new Oda(Fha.firestore,Fha.converter,function(a,b){const c=a.filters.concat([b]);return new iG(a.path,a.collectionGroup,a.explicitOrderBy.slice(),c,a.limit,a.limitType,a.startAt,a.endAt)}(Fha._query,Hha))}}class Iha extends zha{constructor(Jha,Kha){super(),this.zc=Jha,this.Yc=Kha,this.type="orderBy"}_apply(Lha){const Mha=function(a,b,c){if(null!==a.startAt)throw new YA(XA.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==a.endAt)throw new YA(XA.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const d=new cG(b,c);return(function(a,b){if(null===vG(a)){const c=wG(a);null!==c&&jia(a,c,b.field)}})(a,d),d}(Lha._query,this.zc,this.Yc);return new Oda(Lha.firestore,Lha.converter,function(a,b){const c=a.explicitOrderBy.concat([b]);return new iG(a.path,a.collectionGroup,c,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)}(Lha._query,Mha))}}class Nha extends zha{constructor(Oha,Pha,Qha){super(),this.type=Oha,this.Xc=Pha,this.Zc=Qha}_apply(Rha){return new Oda(Rha.firestore,Rha.converter,AG(Rha._query,this.Xc,this.Zc))}}class Sha extends zha{constructor(Tha,Uha,Vha){super(),this.type=Tha,this.ta=Uha,this.ea=Vha}_apply(Wha){var Xha,Yha;const Zha=gia(Wha,this.type,this.ta,this.ea);return new Oda(Wha.firestore,Wha.converter,(Xha=Wha._query,Yha=Zha,new iG(Xha.path,Xha.collectionGroup,Xha.explicitOrderBy.slice(),Xha.filters.slice(),Xha.limit,Xha.limitType,Yha,Xha.endAt)))}}class $ha extends zha{constructor(_ha,aia,bia){super(),this.type=_ha,this.ta=aia,this.ea=bia}_apply(cia){var dia,eia;const fia=gia(cia,this.type,this.ta,this.ea);return new Oda(cia.firestore,cia.converter,(dia=cia._query,eia=fia,new iG(dia.path,dia.collectionGroup,dia.explicitOrderBy.slice(),dia.filters.slice(),dia.limit,dia.limitType,dia.startAt,eia)))}}function gia(a,b,c,d){if(c[0]=xa(c[0]),c[0]instanceof Lga)return(function(a,b,c,d,e){if(!d)throw new YA(XA.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${c}().`);const f=[];for(const g of yG(a))if(g.field.isKeyField())f.push(XD(b,d.key));else{const h=d.data.field(g.field);if(AD(h))throw new YA(XA.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field \""+g.field+"\" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)");if(null===h){const i=g.field.canonicalString();throw new YA(XA.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${i}' (used as the orderBy) does not exist.`)}f.push(h)}return new $F(f,e)})(a._query,a.firestore._databaseId,b,c[0]._document,d);{const e=Wfa(a.firestore);return(function(a,b,c,d,e,f){const g=a.explicitOrderBy;if(e.length>g.length)throw new YA(XA.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const h=[];for(let i=0;i<e.length;i++){const j=e[i];if(g[i].field.isKeyField()){if("string"!=typeof j)throw new YA(XA.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof j}`);if(!xG(a)&& -1!==j.indexOf("/"))throw new YA(XA.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${j}' contains a slash.`);const k=a.path.child(PC.fromString(j));if(!GD.isDocumentKey(k))throw new YA(XA.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${k}' is not because it contains an odd number of segments.`);const l=new GD(k);h.push(XD(b,l))}else{const m=Bga(c,d,j);h.push(m)}}return new $F(h,f)})(a._query,a.firestore._databaseId,e,b,c,d)}}function hia(a,b,c){if("string"==typeof(c=xa(c))){if(""===c)throw new YA(XA.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!xG(b)&& -1!==c.indexOf("/"))throw new YA(XA.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${c}' contains a '/' character.`);const d=b.path.child(PC.fromString(c));if(!GD.isDocumentKey(d))throw new YA(XA.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${d}' is not because it has an odd number of segments (${d.length}).`);return XD(a,new GD(d))}if(c instanceof Jda)return XD(a,c._key);throw new YA(XA.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${xda(c)}.`)}function iia(a,b){if(!Array.isArray(a)||0===a.length)throw new YA(XA.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${b.toString()}' filters.`);if(a.length>10)throw new YA(XA.INVALID_ARGUMENT,`Invalid Query. '${b.toString()}' filters support a maximum of 10 elements in the value array.`)}function jia(a,b,c){if(!c.isEqual(b))throw new YA(XA.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${b.toString()}' and so you must also use '${b.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${c.toString()}' instead.`)}class kia{convertValue(lia,mia="none"){switch(QD(lia)){case 0:return null;case 1:return lia.booleanValue;case 2:return yD(lia.integerValue||lia.doubleValue);case 3:return this.convertTimestamp(lia.timestampValue);case 4:return this.convertServerTimestamp(lia,mia);case 5:return lia.stringValue;case 6:return this.convertBytes(zD(lia.bytesValue));case 7:return this.convertReference(lia.referenceValue);case 8:return this.convertGeoPoint(lia.geoPointValue);case 9:return this.convertArray(lia.arrayValue,mia);case 10:return this.convertObject(lia.mapValue,mia);default:throw UA()}}convertObject(nia,oia){const pia={};return rC(nia.fields,(a,b)=>{pia[a]=this.convertValue(b,oia)}),pia}convertGeoPoint(qia){return new afa(yD(qia.latitude),yD(qia.longitude))}convertArray(ria,sia){return(ria.values||[]).map(a=>this.convertValue(a,sia))}convertServerTimestamp(tia,uia){switch(uia){case"previous":const via=BD(tia);return null==via?null:this.convertValue(via,uia);case"estimate":return this.convertTimestamp(CD(tia));default:return null}}convertTimestamp(wia){const xia=xD(wia);return new cC(xia.seconds,xia.nanos)}convertDocumentKey(yia,zia){const Aia=PC.fromString(yia);VA(YL(Aia));const Bia=new oda(Aia.get(1),Aia.get(3)),Cia=new GD(Aia.popFirst(5));return Bia.isEqual(zia)||RA(`Document ${Cia} contains a document reference within a different database (${Bia.projectId}/${Bia.database}) which is not supported. It will be treated as a reference in the current database (${zia.projectId}/${zia.database}) instead.`),Cia}}function Dia(a,b,c){return a?c&&(c.merge||c.mergeFields)?a.toFirestore(b,c):a.toFirestore(b):b}class Eia extends kia{constructor(Fia){super(),this.firestore=Fia}convertBytes(Gia){return new Uea(Gia)}convertReference(Hia){const Iia=this.convertDocumentKey(Hia,this.firestore._databaseId);return new Jda(this.firestore,null,Iia)}}class Jia{constructor(Kia,Lia){this._firestore=Kia,this._commitHandler=Lia,this._mutations=[],this._committed=!1,this._dataReader=Wfa(Kia)}set(Mia,Nia,Oia){this._verifyNotCommitted();const Pia=$ia(Mia,this._firestore),Qia=Dia(Pia.converter,Nia,Oia),Ria=Xfa(this._dataReader,"WriteBatch.set",Pia._key,Qia,null!==Pia.converter,Oia);return this._mutations.push(Ria.toMutation(Pia._key,eH.none())),this}update(Sia,Tia,Uia,...Via){this._verifyNotCommitted();const Wia=$ia(Sia,this._firestore);let Xia;return Xia="string"==typeof(Tia=xa(Tia))||Tia instanceof Qea?Aga(this._dataReader,"WriteBatch.update",Wia._key,Tia,Uia,Via):zga(this._dataReader,"WriteBatch.update",Wia._key,Tia),this._mutations.push(Xia.toMutation(Wia._key,eH.exists(!0))),this}delete(Yia){this._verifyNotCommitted();const Zia=$ia(Yia,this._firestore);return this._mutations=this._mutations.concat(new FH(Zia._key,eH.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new YA(XA.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function $ia(a,b){if((a=xa(a)).firestore!==b)throw new YA(XA.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return a}class _ia extends kia{constructor(aja){super(),this.firestore=aja}convertBytes(bja){return new Uea(bja)}convertReference(cja){const dja=this.convertDocumentKey(cja,this.firestore._databaseId);return new Jda(this.firestore,null,dja)}}function eja(a,b,c){a=yda(a,Jda);const d=yda(a.firestore,mea),e=Dia(a.converter,b,c);return hja(d,[Xfa(Wfa(d),"setDoc",a._key,e,null!==a.converter,c).toMutation(a._key,eH.none())])}function fja(a,b,c,...d){a=yda(a,Jda);const e=yda(a.firestore,mea),f=Wfa(e);return hja(e,[("string"==typeof(b=xa(b))||b instanceof Qea?Aga(f,"updateDoc",a._key,b,c,d):zga(f,"updateDoc",a._key,b)).toMutation(a._key,eH.exists(!0))])}function gja(a,...b){var c,d,e;a=xa(a);let f={includeMetadataChanges:!1},g=0;"object"!=typeof b[g]||bea(b[g])||(f=b[g],g++);const h={includeMetadataChanges:f.includeMetadataChanges};if(bea(b[g])){const i=b[g];b[g]=null===(c=i.next)|| void 0===c?void 0:c.bind(i),b[g+1]=null===(d=i.error)|| void 0===d?void 0:d.bind(i),b[g+2]=null===(e=i.complete)|| void 0===e?void 0:e.bind(i)}let j,k,l;if(a instanceof Jda)k=yda(a.firestore,mea),l=sG(a._key.path),j={next:c=>{b[g]&&b[g](ija(k,a,c))},error:b[g+1],complete:b[g+2]};else{const m=yda(a,Oda);k=yda(m.firestore,mea),l=m._query;const n=new _ia(k);j={next:a=>{b[g]&&b[g](new mha(k,n,m,a))},error:b[g+1],complete:b[g+2]},yha(a._query)}return(function(a,b,c,d){const e=new Tba(d),f=new O8(b,e,c);return a.asyncQueue.enqueueAndForget(async()=>J8(await cda(a),f)),()=>{e.nc(),a.asyncQueue.enqueueAndForget(async()=>K8(await cda(a),f))}})(Mea(k),l,h,j)}function hja(a,b){return(function(a,b){const c=new _A;return a.asyncQueue.enqueueAndForget(async()=>yaa(await bda(a),b,c)),c.promise})(Mea(a),b)}function ija(a,b,c){const d=c.docs.get(b._key),e=new _ia(a);return new $ga(a,e,b._key,d,new Wga(c.hasPendingWrites,c.fromCache),b.converter)}class jja extends class{constructor(pja,qja){this._firestore=pja,this._transaction=qja,this._dataReader=Wfa(pja)}get(rja){const sja=$ia(rja,this._firestore),tja=new Eia(this._firestore);return this._transaction.lookup([sja._key]).then(a=>{if(!a||1!==a.length)return UA();const b=a[0];if(b.isFoundDocument())return new Lga(this._firestore,tja,b.key,b,sja.converter);if(b.isNoDocument())return new Lga(this._firestore,tja,sja._key,null,sja.converter);throw UA()})}set(uja,vja,wja){const xja=$ia(uja,this._firestore),yja=Dia(xja.converter,vja,wja),zja=Xfa(this._dataReader,"Transaction.set",xja._key,yja,null!==xja.converter,wja);return this._transaction.set(xja._key,zja),this}update(Aja,Bja,Cja,...Dja){const Eja=$ia(Aja,this._firestore);let Fja;return Fja="string"==typeof(Bja=xa(Bja))||Bja instanceof Qea?Aga(this._dataReader,"Transaction.update",Eja._key,Bja,Cja,Dja):zga(this._dataReader,"Transaction.update",Eja._key,Bja),this._transaction.update(Eja._key,Fja),this}delete(Gja){const Hja=$ia(Gja,this._firestore);return this._transaction.delete(Hja._key),this}}{constructor(kja,lja){super(kja,lja),this._firestore=kja}get(mja){const nja=$ia(mja,this._firestore),oja=new _ia(this._firestore);return super.get(mja).then(a=>new $ga(this._firestore,oja,nja._key,a._document,new Wga(!1,!1),nja.converter))}}function Ija(a,b){if(void 0===b)return{merge:!1};if(void 0!==b.mergeFields&& void 0!==b.merge)throw new YA("invalid-argument",`Invalid options passed to function ${a}(): You cannot specify both "merge" and "mergeFields".`);return b}function Jja(){if("undefined"==typeof Uint8Array)throw new YA("unimplemented","Uint8Arrays are not available in this environment.")}function Kja(){if(!("undefined"!=typeof atob))throw new YA("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(a,b=!0){NA=vc,kc(new ya("firestore",(a,{options:c})=>{const d=a.getProvider("app").getImmediate(),e=new mea(d,new kB(a.getProvider("auth-internal")),new JB(a.getProvider("app-check-internal")));return c=Object.assign({useFetchStreams:b},c),e._setSettings(c),e},"PUBLIC")),Ac(JA,"3.4.3",void 0),Ac(JA,"3.4.3","esm2017")}();class Lja{constructor(Mja){this._delegate=Mja}static fromBase64String(Nja){return Kja(),new Lja(Uea.fromBase64String(Nja))}static fromUint8Array(Oja){return Jja(),new Lja(Uea.fromUint8Array(Oja))}toBase64(){return Kja(),this._delegate.toBase64()}toUint8Array(){return Jja(),this._delegate.toUint8Array()}isEqual(Pja){return this._delegate.isEqual(Pja._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function Qja(a){return Rja(a,["next","error","complete"])}function Rja(a,b){if("object"!=typeof a||null===a)return!1;const c=a;for(const d of b)if(d in c&&"function"==typeof c[d])return!0;return!1}class Sja{enableIndexedDbPersistence(Tja,Uja){return(function(a,b){Pea(a=yda(a,mea));const c=Mea(a),d=a._freezeSettings(),e=new yba;return Oea(c,e,new eba(e,d.cacheSizeBytes,null==b?void 0:b.forceOwnership))})(Tja._delegate,{forceOwnership:Uja})}enableMultiTabIndexedDbPersistence(Vja){return(function(a){Pea(a=yda(a,mea));const b=Mea(a),c=a._freezeSettings(),d=new yba;return Oea(b,d,new qba(d,c.cacheSizeBytes))})(Vja._delegate)}clearIndexedDbPersistence(Wja){return(function(a){if(a._initialized&&!a._terminated)throw new YA(XA.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const b=new _A;return a._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(a){if(!bO.Pt())return Promise.resolve();const b=a+"main";await bO.delete(b)}(fY(a._databaseId,a._persistenceKey)),b.resolve()}catch(c){b.reject(c)}}),b.promise})(Wja._delegate)}}class Xja{constructor(Yja,Zja,$ja){this._delegate=Zja,this._persistenceProvider=$ja,this.INTERNAL={delete:()=>this.terminate()},Yja instanceof oda||(this._appCompat=Yja)}get _databaseId(){return this._delegate._databaseId}settings(_ja){const aka=this._delegate._getSettings();_ja.merge||aka.host===_ja.host||SA("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),_ja.merge&&delete(_ja=Object.assign(Object.assign({},aka),_ja)).merge,this._delegate._setSettings(_ja)}useEmulator(bka,cka,dka={}){!function(a,b,c,d={}){var e;const f=(a=yda(a,Eda))._getSettings();if("firestore.googleapis.com"!==f.host&&f.host!==b&&SA("Host has been set in both settings() and useEmulator(), emulator host will be used"),a._setSettings(Object.assign(Object.assign({},f),{host:`${b}:${c}`,ssl:!1})),d.mockUserToken){let g,h;if("string"==typeof d.mockUserToken)g=d.mockUserToken,h=KA.MOCK_USER;else{g=A(d.mockUserToken,null===(e=a._app)|| void 0===e?void 0:e.options.projectId);const i=d.mockUserToken.sub||d.mockUserToken.user_id;if(!i)throw new YA(XA.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new KA(i)}a._authCredentials=new gB(new aB(g,h))}}(this._delegate,bka,cka,dka)}enableNetwork(){var eka;return(eka=Mea(yda(this._delegate,mea))).asyncQueue.enqueue(async()=>{const a=await $ca(eka),b=await ada(eka);return a.setNetworkEnabled(!0),(function(a){const b=WA(a);return b.Gr.delete(0),a7(b)})(b)})}disableNetwork(){var fka;return(fka=Mea(yda(this._delegate,mea))).asyncQueue.enqueue(async()=>{const a=await $ca(fka),b=await ada(fka);return a.setNetworkEnabled(!1),(async function(a){const b=WA(a);b.Gr.add(0),await b7(b),b.Jr.set("Offline")})(b)})}enablePersistence(gka){let hka=!1,ika=!1;return gka&&(hka=!!gka.synchronizeTabs,ika=!!gka.experimentalForceOwningTab,uda("synchronizeTabs",hka,"experimentalForceOwningTab",ika)),hka?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,ika)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return(function(a){const b=new _A;return a.asyncQueue.enqueueAndForget(async()=>Eaa(await bda(a),b)),b.promise})(Mea(yda(this._delegate,mea)))}onSnapshotsInSync(jka){var kka,lka;return kka=this._delegate,lka=jka,(function(a,b){const c=new Tba(b);return a.asyncQueue.enqueueAndForget(async()=>{var b,d;return b=await cda(a),d=c,void(WA(b).io.add(d),d.next())}),()=>{c.nc(),a.asyncQueue.enqueueAndForget(async()=>(function(a,b){WA(a).io.delete(b)})(await cda(a),c))}})(Mea(kka=yda(kka,mea)),bea(lka)?lka:{next:lka})}get app(){if(!this._appCompat)throw new YA("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(mka){try{return new Rma(this,Zda(this._delegate,mka))}catch(nka){throw Sla(nka,"collection()","Firestore.collection()")}}doc(oka){try{return new tla(this,$da(this._delegate,oka))}catch(pka){throw Sla(pka,"doc()","Firestore.doc()")}}collectionGroup(qka){try{return new dma(this,function(a,b){var c;if(a=yda(a,Eda),tda("collectionGroup","collection id",b),b.indexOf("/")>=0)throw new YA(XA.INVALID_ARGUMENT,`Invalid collection ID '${b}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Oda(a,null,(c=b,new iG(PC.emptyPath(),c)))}(this._delegate,qka))}catch(rka){throw Sla(rka,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(ska){return(function(a,b){return(function(a,b){const c=new _A;return a.asyncQueue.enqueueAndForget(async()=>{const d=await Zca(a).then(a=>a.datastore);new Eca(a.asyncQueue,d,b,c).run()}),c.promise})(Mea(a=yda(a,mea)),c=>b(new jja(a,c)))})(this._delegate,a=>ska(new Eka(this,a)))}batch(){return Mea(this._delegate),new Uka(new Jia(this._delegate,a=>hja(this._delegate,a)))}loadBundle(tka){return(function(a,b){const c=Mea(a=yda(a,mea)),d=new cea;return(function(a,b,c,d){var e,f,g,h;const i=(e=c,f=u5(b),g=function(a,b){if(a instanceof Uint8Array)return Sba(a,b);if(a instanceof ArrayBuffer)return Sba(new Uint8Array(a),b);if(a instanceof ReadableStream)return a.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof e?(new TextEncoder).encode(e):e),h=f,new Zba(g,h));a.asyncQueue.enqueueAndForget(async()=>{!function(a,b,c){const d=WA(a);(async function(a,b,c){try{var d;const e=await b.getMetadata();if(await function(a,b){const c=WA(a),d=yL(b.createTime);return c.persistence.runTransaction("hasNewerBundle","readonly",a=>c.Ye.getBundleMetadata(a,b.id)).then(a=>!!a&&a.createTime.compareTo(d)>=0)}(a.localStore,e))return await b.close(),void c._completeWith((d=e,{taskState:"Success",documentsLoaded:d.totalDocuments,bytesLoaded:d.totalBytes,totalDocuments:d.totalDocuments,totalBytes:d.totalBytes}));c._updateProgress(B9(e));const f=new l9(e,a.localStore,b.k);let g=await b.Ho();for(;g;){const h=await f.yo(g);h&&c._updateProgress(h),g=await b.Ho()}const i=await f.complete();await Maa(a,i.In,void 0),await function(a,b){const c=WA(a);return c.persistence.runTransaction("Save bundle","readwrite",a=>c.Ye.saveBundleMetadata(a,b))}(a.localStore,e),c._completeWith(i.progress)}catch(j){SA("SyncEngine",`Loading bundle failed with ${j}`),c._failWith(j)}})(d,b,c).then(()=>{d.sharedClientState.notifyBundleLoaded()})}(await bda(a),i,d)})})(c,a._databaseId,b,d),d})(this._delegate,tka)}namedQuery(uka){var vka,wka,xka,yka;return(vka=this._delegate,wka=uka,(xka=Mea(vka=yda(vka,mea)),yka=wka,xka.asyncQueue.enqueue(async()=>(function(a,b){const c=WA(a);return c.persistence.runTransaction("Get named query","readonly",a=>c.Ye.getNamedQuery(a,b))})(await _ca(xka),yka))).then(a=>a?new Oda(vka,null,a.query):null)).then(a=>a?new dma(this,a):null)}}class zka extends kia{constructor(Aka){super(),this.firestore=Aka}convertBytes(Bka){return new Lja(new Uea(Bka))}convertReference(Cka){const Dka=this.convertDocumentKey(Cka,this.firestore._databaseId);return tla.forKey(Dka,this.firestore,null)}}class Eka{constructor(Fka,Gka){this._firestore=Fka,this._delegate=Gka,this._userDataWriter=new zka(Fka)}get(Hka){const Ika=$ma(Hka);return this._delegate.get(Ika).then(a=>new Vla(this._firestore,new $ga(this._firestore._delegate,this._userDataWriter,a._key,a._document,a.metadata,Ika.converter)))}set(Jka,Kka,Lka){const Mka=$ma(Jka);return Lka?(Ija("Transaction.set",Lka),this._delegate.set(Mka,Kka,Lka)):this._delegate.set(Mka,Kka),this}update(Nka,Oka,Pka,...Qka){const Rka=$ma(Nka);return 2===arguments.length?this._delegate.update(Rka,Oka):this._delegate.update(Rka,Oka,Pka,...Qka),this}delete(Ska){const Tka=$ma(Ska);return this._delegate.delete(Tka),this}}class Uka{constructor(Vka){this._delegate=Vka}set(Wka,Xka,Yka){const Zka=$ma(Wka);return Yka?(Ija("WriteBatch.set",Yka),this._delegate.set(Zka,Xka,Yka)):this._delegate.set(Zka,Xka),this}update($ka,_ka,ala,...bla){const cla=$ma($ka);return 2===arguments.length?this._delegate.update(cla,_ka):this._delegate.update(cla,_ka,ala,...bla),this}delete(dla){const ela=$ma(dla);return this._delegate.delete(ela),this}commit(){return this._delegate.commit()}}class fla{constructor(gla,hla,ila){this._firestore=gla,this._userDataWriter=hla,this._delegate=ila}fromFirestore(jla,kla){const lla=new kha(this._firestore._delegate,this._userDataWriter,jla._key,jla._document,jla.metadata,null);return this._delegate.fromFirestore(new ama(this._firestore,lla),null!=kla?kla:{})}toFirestore(mla,nla){return nla?this._delegate.toFirestore(mla,nla):this._delegate.toFirestore(mla)}static getInstance(ola,pla){const qla=fla.INSTANCES;let rla=qla.get(ola);rla||(rla=new WeakMap(),qla.set(ola,rla));let sla=rla.get(pla);return sla||(sla=new fla(ola,new zka(ola),pla),rla.set(pla,sla)),sla}}fla.INSTANCES=new WeakMap();class tla{constructor(ula,vla){this.firestore=ula,this._delegate=vla,this._userDataWriter=new zka(ula)}static forPath(wla,xla,yla){if(wla.length%2!=0)throw new YA("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${wla.canonicalString()} has ${wla.length}`);return new tla(xla,new Jda(xla._delegate,yla,new GD(wla)))}static forKey(zla,Ala,Bla){return new tla(Ala,new Jda(Ala._delegate,Bla,zla))}get id(){return this._delegate.id}get parent(){return new Rma(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(Cla){try{return new Rma(this.firestore,Zda(this._delegate,Cla))}catch(Dla){throw Sla(Dla,"collection()","DocumentReference.collection()")}}isEqual(Ela){return(Ela=xa(Ela))instanceof Jda&&_da(this._delegate,Ela)}set(Fla,Gla){Gla=Ija("DocumentReference.set",Gla);try{if(Gla)return eja(this._delegate,Fla,Gla);return eja(this._delegate,Fla)}catch(Hla){throw Sla(Hla,"setDoc()","DocumentReference.set()")}}update(Ila,Jla,...Kla){try{if(1===arguments.length)return fja(this._delegate,Ila);return fja(this._delegate,Ila,Jla,...Kla)}catch(Lla){throw Sla(Lla,"updateDoc()","DocumentReference.update()")}}delete(){var Mla;return hja(yda((Mla=this._delegate).firestore,mea),[new FH(Mla._key,eH.none())])}onSnapshot(...Nla){const Ola=Tla(Nla),Pla=Ula(Nla,a=>new Vla(this.firestore,new $ga(this.firestore._delegate,this._userDataWriter,a._key,a._document,a.metadata,this._delegate.converter)));return gja(this._delegate,Ola,Pla)}get(Qla){return((null==Qla?void 0:Qla.source)==="cache"?(function(a){a=yda(a,Jda);const b=yda(a.firestore,mea),c=Mea(b),d=new _ia(b);return(function(a,b){const c=new _A;return a.asyncQueue.enqueueAndForget(async()=>(async function(a,b,c){try{const d=await function(a,b){const c=WA(a);return c.persistence.runTransaction("read document","readonly",a=>c.Wn.Rn(a,b))}(a,b);d.isFoundDocument()?c.resolve(d):d.isNoDocument()?c.resolve(null):c.reject(new YA(XA.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(e){const f=Q7(e,`Failed to get document '${b} from cache`);c.reject(f)}})(await _ca(a),b,c)),c.promise})(c,a._key).then(c=>new $ga(b,d,a._key,c,new Wga(null!==c&&c.hasLocalMutations,!0),a.converter))})(this._delegate):(null==Qla?void 0:Qla.source)==="server"?(function(a){a=yda(a,Jda);const b=yda(a.firestore,mea);return dda(Mea(b),a._key,{source:"server"}).then(c=>ija(b,a,c))})(this._delegate):(function(a){a=yda(a,Jda);const b=yda(a.firestore,mea);return dda(Mea(b),a._key).then(c=>ija(b,a,c))})(this._delegate)).then(a=>new Vla(this.firestore,new $ga(this.firestore._delegate,this._userDataWriter,a._key,a._document,a.metadata,this._delegate.converter)))}withConverter(Rla){return new tla(this.firestore,Rla?this._delegate.withConverter(fla.getInstance(this.firestore,Rla)):this._delegate.withConverter(null))}}function Sla(a,b,c){return a.message=a.message.replace(b,c),a}function Tla(a){for(const b of a)if("object"==typeof b&&!Qja(b))return b;return{}}function Ula(a,b){var c,d;let e;return{next:a=>{e.next&&e.next(b(a))},error:null===(c=(e=Qja(a[0])?a[0]:Qja(a[1])?a[1]:"function"==typeof a[0]?{next:a[0],error:a[1],complete:a[2]}:{next:a[1],error:a[2],complete:a[3]}).error)|| void 0===c?void 0:c.bind(e),complete:null===(d=e.complete)|| void 0===d?void 0:d.bind(e)}}class Vla{constructor(Wla,Xla){this._firestore=Wla,this._delegate=Xla}get ref(){return new tla(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(Yla){return this._delegate.data(Yla)}get(Zla,$la){return this._delegate.get(Zla,$la)}isEqual(_la){return xha(this._delegate,_la._delegate)}}class ama extends Vla{data(bma){const cma=this._delegate.data(bma);return void 0!==cma||UA(),cma}}class dma{constructor(ema,fma){this.firestore=ema,this._delegate=fma,this._userDataWriter=new zka(ema)}where(gma,hma,ima){try{return new dma(this.firestore,Aha(this._delegate,function(a,b,c){const d=Vga("where",a);return new Bha(d,b,c)}(gma,hma,ima)))}catch(jma){throw Sla(jma,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(kma,lma){try{return new dma(this.firestore,Aha(this._delegate,function(a,b="asc"){const c=Vga("orderBy",a);return new Iha(c,b)}(kma,lma)))}catch(mma){throw Sla(mma,/(orderBy|where)\(\)/,"Query.$1()")}}limit(nma){try{var oma;return new dma(this.firestore,Aha(this._delegate,(oma=nma,zda("limit",oma),new Nha("limit",oma,"F"))))}catch(pma){throw Sla(pma,"limit()","Query.limit()")}}limitToLast(qma){try{var rma;return new dma(this.firestore,Aha(this._delegate,(rma=qma,zda("limitToLast",rma),new Nha("limitToLast",rma,"L"))))}catch(sma){throw Sla(sma,"limitToLast()","Query.limitToLast()")}}startAt(...tma){try{return new dma(this.firestore,Aha(this._delegate,function(...a){return new Sha("startAt",a,!0)}(...tma)))}catch(uma){throw Sla(uma,"startAt()","Query.startAt()")}}startAfter(...vma){try{return new dma(this.firestore,Aha(this._delegate,function(...a){return new Sha("startAfter",a,!1)}(...vma)))}catch(wma){throw Sla(wma,"startAfter()","Query.startAfter()")}}endBefore(...xma){try{return new dma(this.firestore,Aha(this._delegate,function(...a){return new $ha("endBefore",a,!0)}(...xma)))}catch(yma){throw Sla(yma,"endBefore()","Query.endBefore()")}}endAt(...zma){try{return new dma(this.firestore,Aha(this._delegate,function(...a){return new $ha("endAt",a,!1)}(...zma)))}catch(Ama){throw Sla(Ama,"endAt()","Query.endAt()")}}isEqual(Bma){return aea(this._delegate,Bma._delegate)}get(Cma){return((null==Cma?void 0:Cma.source)==="cache"?(function(a){a=yda(a,Oda);const b=yda(a.firestore,mea),c=Mea(b),d=new _ia(b);return(function(a,b){const c=new _A;return a.asyncQueue.enqueueAndForget(async()=>(async function(a,b,c){try{const d=await HZ(a,b,!0),e=new G9(b,d.zn),f=e.Po(d.documents),g=e.applyChanges(f,!1);c.resolve(g.snapshot)}catch(h){const i=Q7(h,`Failed to execute query '${b} against cache`);c.reject(i)}})(await _ca(a),b,c)),c.promise})(c,a._query).then(c=>new mha(b,d,a,c))})(this._delegate):(null==Cma?void 0:Cma.source)==="server"?(function(a){a=yda(a,Oda);const b=yda(a.firestore,mea),c=Mea(b),d=new _ia(b);return eda(c,a._query,{source:"server"}).then(c=>new mha(b,d,a,c))})(this._delegate):(function(a){a=yda(a,Oda);const b=yda(a.firestore,mea),c=Mea(b),d=new _ia(b);return yha(a._query),eda(c,a._query).then(c=>new mha(b,d,a,c))})(this._delegate)).then(a=>new Kma(this.firestore,new mha(this.firestore._delegate,this._userDataWriter,this._delegate,a._snapshot)))}onSnapshot(...Dma){const Ema=Tla(Dma),Fma=Ula(Dma,a=>new Kma(this.firestore,new mha(this.firestore._delegate,this._userDataWriter,this._delegate,a._snapshot)));return gja(this._delegate,Ema,Fma)}withConverter(Gma){return new dma(this.firestore,Gma?this._delegate.withConverter(fla.getInstance(this.firestore,Gma)):this._delegate.withConverter(null))}}class Hma{constructor(Ima,Jma){this._firestore=Ima,this._delegate=Jma}get type(){return this._delegate.type}get doc(){return new ama(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Kma{constructor(Lma,Mma){this._firestore=Lma,this._delegate=Mma}get query(){return new dma(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(a=>new ama(this._firestore,a))}docChanges(Nma){return this._delegate.docChanges(Nma).map(a=>new Hma(this._firestore,a))}forEach(Oma,Pma){this._delegate.forEach(a=>{Oma.call(Pma,new ama(this._firestore,a))})}isEqual(Qma){return xha(this._delegate,Qma._delegate)}}class Rma extends dma{constructor(Sma,Tma){super(Sma,Tma),this.firestore=Sma,this._delegate=Tma}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const Uma=this._delegate.parent;return Uma?new tla(this.firestore,Uma):null}doc(Vma){try{if(void 0===Vma)return new tla(this.firestore,$da(this._delegate));return new tla(this.firestore,$da(this._delegate,Vma))}catch(Wma){throw Sla(Wma,"doc()","CollectionReference.doc()")}}add(Xma){return(function(a,b){const c=yda(a.firestore,mea),d=$da(a),e=Dia(a.converter,b);return hja(c,[Xfa(Wfa(a.firestore),"addDoc",d._key,e,null!==a.converter,{}).toMutation(d._key,eH.exists(!1))]).then(()=>d)})(this._delegate,Xma).then(a=>new tla(this.firestore,a))}isEqual(Yma){return _da(this._delegate,Yma._delegate)}withConverter(Zma){return new Rma(this.firestore,Zma?this._delegate.withConverter(fla.getInstance(this.firestore,Zma)):this._delegate.withConverter(null))}}function $ma(a){return yda(a,Jda)}class _ma{constructor(...ana){this._delegate=new Qea(...ana)}static documentId(){return new _ma(XC.keyField().canonicalString())}isEqual(bna){return(bna=xa(bna))instanceof Qea&&this._delegate._internalPath.isEqual(bna._internalPath)}}class cna{constructor(dna){this._delegate=dna}static serverTimestamp(){const ena=new aga("serverTimestamp");return ena._methodName="FieldValue.serverTimestamp",new cna(ena)}static delete(){const fna=new Yfa("deleteField");return fna._methodName="FieldValue.delete",new cna(fna)}static arrayUnion(...gna){const hna=function(...a){return new dga("arrayUnion",a)}(...gna);return hna._methodName="FieldValue.arrayUnion",new cna(hna)}static arrayRemove(...ina){const jna=function(...a){return new lga("arrayRemove",a)}(...ina);return jna._methodName="FieldValue.arrayRemove",new cna(jna)}static increment(kna){var lna;const mna=(lna=kna,new tga("increment",lna));return mna._methodName="FieldValue.increment",new cna(mna)}isEqual(nna){return this._delegate.isEqual(nna._delegate)}}const ona={Firestore:Xja,GeoPoint:afa,Timestamp:cC,Blob:Lja,Transaction:Eka,WriteBatch:Uka,DocumentReference:tla,DocumentSnapshot:Vla,Query:dma,QueryDocumentSnapshot:ama,QuerySnapshot:Kma,CollectionReference:Rma,FieldPath:_ma,FieldValue:cna,setLogLevel:function(a){var b;b=a,OA.setLogLevel(b)},CACHE_SIZE_UNLIMITED:-1};(function(a,b){a.INTERNAL.registerComponent(new ya("firestore-compat",a=>{const c=a.getProvider("app-compat").getImmediate(),d=a.getProvider("firestore").getImmediate();return b(c,d)},"PUBLIC").setServiceProps(Object.assign({},ona)))})(e=Uc,(a,b)=>new Xja(a,b,new Sja())),e.registerVersion("@firebase/firestore-compat","0.1.12");const pna="firebasestorage.googleapis.com",qna="storageBucket";class rna extends I{constructor(sna,tna){super(wna(sna),`Firebase Storage: ${tna} (${wna(sna)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,rna.prototype)}_codeEquals(una){return wna(una)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(vna){this.customData.serverResponse=vna,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}function wna(a){return"storage/"+a}function xna(){return new rna("unknown","An unknown error occurred, please check the error payload for server response.")}function yna(){return new rna("canceled","User canceled the upload/download.")}function zna(){return new rna("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function Ana(a){return new rna("invalid-argument",a)}function Bna(){return new rna("app-deleted","The Firebase app was deleted.")}function Cna(a){return new rna("invalid-root-operation","The operation '"+a+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Dna(a,b){return new rna("invalid-format","String does not match format '"+a+"': "+b)}function Ena(a){throw new rna("internal-error","Internal error: "+a)}class Fna{constructor(Gna,Hna){this.bucket=Gna,this.path_=Hna}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const Ina=encodeURIComponent;return"/b/"+Ina(this.bucket)+"/o/"+Ina(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(Jna,Kna){var Lna;let Mna;try{Mna=Fna.makeFromUrl(Jna,Kna)}catch(Nna){return new Fna(Jna,"")}if(""===Mna.path)return Mna;throw Lna=Jna,new rna("invalid-default-bucket","Invalid default bucket '"+Lna+"'.")}static makeFromUrl(Ona,Pna){let Qna=null;const Rna="([A-Za-z0-9.\\-_]+)",Sna=new RegExp("^gs://"+Rna+"(/(.*))?$","i");function Tna(a){a.path_=decodeURIComponent(a.path)}const Una=Pna.replace(/[.]/g,"\\."),Vna=new RegExp(`^https?://${Una}/v[A-Za-z0-9_]+/b/${Rna}/o(/([^?#]*).*)?$`,"i"),Wna=new RegExp(`^https?://${Pna===pna?"(?:storage.googleapis.com|storage.cloud.google.com)":Pna}/${Rna}/([^?#]*)`,"i"),Xna=[{regex:Sna,indices:{bucket:1,path:3},postModify:function(a){"/"===a.path.charAt(a.path.length-1)&&(a.path_=a.path_.slice(0,-1))}},{regex:Vna,indices:{bucket:1,path:3},postModify:Tna},{regex:Wna,indices:{bucket:1,path:2},postModify:Tna}];for(let Yna=0;Yna<Xna.length;Yna++){const Zna=Xna[Yna],$na=Zna.regex.exec(Ona);if($na){const _na=$na[Zna.indices.bucket];let aoa=$na[Zna.indices.path];aoa||(aoa=""),Qna=new Fna(_na,aoa),Zna.postModify(Qna);break}}if(null==Qna){var boa;throw boa=Ona,new rna("invalid-url","Invalid URL '"+boa+"'.")}return Qna}}class coa{constructor(doa){this.promise_=Promise.reject(doa)}getPromise(){return this.promise_}cancel(eoa=!1){}}function foa(a){return"string"==typeof a||a instanceof String}function goa(a){return hoa()&&a instanceof Blob}function hoa(){return"undefined"!=typeof Blob}function ioa(a,b,c,d){if(d<b)throw Ana(`Invalid value for '${a}'. Expected ${b} or greater.`);if(d>c)throw Ana(`Invalid value for '${a}'. Expected ${c} or less.`)}function joa(a,b,c){let d=b;return null==c&&(d=`https://${b}`),`${c}://${d}/v0${a}`}function koa(a){const b=encodeURIComponent;let c="?";for(const d in a)if(a.hasOwnProperty(d)){const e=b(d)+"="+b(a[d]);c=c+e+"&"}return c=c.slice(0,-1)}(f=m||(m={}))[f.NO_ERROR=0]="NO_ERROR",f[f.NETWORK_ERROR=1]="NETWORK_ERROR",f[f.ABORT=2]="ABORT";class loa{constructor(moa,noa,ooa,poa,qoa,roa,soa,toa,uoa,voa,woa){this.url_=moa,this.method_=noa,this.headers_=ooa,this.body_=poa,this.successCodes_=qoa,this.additionalRetryCodes_=roa,this.callback_=soa,this.errorCallback_=toa,this.timeout_=uoa,this.progressCallback_=voa,this.connectionFactory_=woa,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((a,b)=>{this.resolve_=a,this.reject_=b,this.start_()})}start_(){const xoa=(a,b)=>{const c=this.resolve_,d=this.reject_,e=b.connection;if(b.wasSuccessCode)try{var f;const g=this.callback_(e,e.getResponse());(f=g,void 0!==f)?c(g):c()}catch(h){d(h)}else if(null!==e){const i=xna();i.serverResponse=e.getErrorText(),d(this.errorCallback_?this.errorCallback_(e,i):i)}else if(b.canceled){const j=this.appDelete_?Bna():yna();d(j)}else{const k=new rna("retry-limit-exceeded","Max retry time for operation exceeded, please try again.");d(k)}};this.canceled_?xoa(!1,new Coa(!1,null,!0)):this.backoffId_=(function(a,b,c){let d=1,e=null,f=null,g=!1,h=0;function i(){return 2===h}let j=!1;function k(...a){j||(j=!0,b.apply(null,a))}function l(b){e=setTimeout(()=>{e=null,a(n,i())},b)}function m(){f&&clearTimeout(f)}function n(a,...b){if(j){m();return}if(a){m(),k.call(null,a,...b);return}const c=i()||g;if(c){m(),k.call(null,a,...b);return}d<64&&(d*=2);let e;1===h?(h=2,e=0):e=(d+Math.random())*1000,l(e)}let o=!1;function p(a){o||(o=!0,m(),!j&&(null!==e?(a||(h=2),clearTimeout(e),l(0)):a||(h=1)))}return l(0),f=setTimeout(()=>{g=!0,p(!0)},c),p})((a,b)=>{if(b){a(!1,new Coa(!1,null,!0));return}const c=this.connectionFactory_();this.pendingConnection_=c;const d=a=>{const b=a.loaded,c=a.lengthComputable?a.total:-1;null!==this.progressCallback_&&this.progressCallback_(b,c)};null!==this.progressCallback_&&c.addUploadProgressListener(d),c.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&c.removeUploadProgressListener(d),this.pendingConnection_=null;const b=c.getErrorCode()===m.NO_ERROR,e=c.getStatus();if(!b||this.isRetryStatusCode_(e)){const f=c.getErrorCode()===m.ABORT;a(!1,new Coa(!1,null,f));return}const g=-1!==this.successCodes_.indexOf(e);a(!0,new Coa(g,c))})},xoa,this.timeout_)}getPromise(){return this.promise_}cancel(yoa){this.canceled_=!0,this.appDelete_=yoa||!1,null!==this.backoffId_&&(function(a){a(!1)})(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}isRetryStatusCode_(zoa){const Aoa=-1!==[408,429].indexOf(zoa),Boa=-1!==this.additionalRetryCodes_.indexOf(zoa);return zoa>=500&&zoa<600||Aoa||Boa}}class Coa{constructor(Doa,Eoa,Foa){this.wasSuccessCode=Doa,this.connection=Eoa,this.canceled=!!Foa}}function Goa(...a){const b="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0;if(void 0!==b){const c=new b();for(let d=0;d<a.length;d++)c.append(a[d]);return c.getBlob()}if(hoa())return new Blob(a);throw new rna("unsupported-environment","This browser doesn't seem to support creating Blobs")}const Hoa={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Ioa{constructor(Joa,Koa){this.data=Joa,this.contentType=Koa||null}}function Loa(a,b){switch(a){case Hoa.RAW:return new Ioa(Moa(b));case Hoa.BASE64:case Hoa.BASE64URL:return new Ioa(Noa(a,b));case Hoa.DATA_URL:return new Ioa(Soa(b),Toa(b))}throw xna()}function Moa(a){const b=[];for(let c=0;c<a.length;c++){let d=a.charCodeAt(c);if(d<=127)b.push(d);else if(d<=2047)b.push(192|d>>6,128|63&d);else if((64512&d)==55296){const e=c<a.length-1&&(64512&a.charCodeAt(c+1))==56320;if(e){const f=d,g=a.charCodeAt(++c);d=65536|(1023&f)<<10|1023&g,b.push(240|d>>18,128|d>>12&63,128|d>>6&63,128|63&d)}else b.push(239,191,189)}else(64512&d)==56320?b.push(239,191,189):b.push(224|d>>12,128|d>>6&63,128|63&d)}return new Uint8Array(b)}function Noa(a,b){switch(a){case Hoa.BASE64:{const c=-1!==b.indexOf("-"),d=-1!==b.indexOf("_");if(c||d){const e=c?"-":"_";throw Dna(a,"Invalid character '"+e+"' found: is it base64url encoded?")}break}case Hoa.BASE64URL:{const f=-1!==b.indexOf("+"),g=-1!==b.indexOf("/");if(f||g){const h=f?"+":"/";throw Dna(a,"Invalid character '"+h+"' found: is it base64 encoded?")}b=b.replace(/-/g,"+").replace(/_/g,"/");break}}let i;try{var j;i=(j=b,atob(j))}catch(k){throw Dna(a,"Invalid character found")}const l=new Uint8Array(i.length);for(let m=0;m<i.length;m++)l[m]=i.charCodeAt(m);return l}class Ooa{constructor(Poa){this.base64=!1,this.contentType=null;const Qoa=Poa.match(/^data:([^,]+)?,/);if(null===Qoa)throw Dna(Hoa.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const Roa=Qoa[1]||null;null!=Roa&&(this.base64=(function(a,b){const c=a.length>=b.length;return!!c&&a.substring(a.length-b.length)===b})(Roa,";base64"),this.contentType=this.base64?Roa.substring(0,Roa.length-7):Roa),this.rest=Poa.substring(Poa.indexOf(",")+1)}}function Soa(a){const b=new Ooa(a);return b.base64?Noa(Hoa.BASE64,b.rest):(function(a){let b;try{b=decodeURIComponent(a)}catch(c){throw Dna(Hoa.DATA_URL,"Malformed data URL.")}return Moa(b)})(b.rest)}function Toa(a){const b=new Ooa(a);return b.contentType}class Uoa{constructor(Voa,Woa){let Xoa=0,Yoa="";goa(Voa)?(this.data_=Voa,Xoa=Voa.size,Yoa=Voa.type):Voa instanceof ArrayBuffer?(Woa?this.data_=new Uint8Array(Voa):(this.data_=new Uint8Array(Voa.byteLength),this.data_.set(new Uint8Array(Voa))),Xoa=this.data_.length):Voa instanceof Uint8Array&&(Woa?this.data_=Voa:(this.data_=new Uint8Array(Voa.length),this.data_.set(Voa)),Xoa=Voa.length),this.size_=Xoa,this.type_=Yoa}size(){return this.size_}type(){return this.type_}slice(Zoa,$oa){if(goa(this.data_)){var _oa,apa,bpa;const cpa=this.data_,dpa=(_oa=cpa,apa=Zoa,bpa=$oa,_oa.webkitSlice?_oa.webkitSlice(apa,bpa):_oa.mozSlice?_oa.mozSlice(apa,bpa):_oa.slice?_oa.slice(apa,bpa):null);return null===dpa?null:new Uoa(dpa)}{const epa=new Uint8Array(this.data_.buffer,Zoa,$oa-Zoa);return new Uoa(epa,!0)}}static getBlob(...fpa){if(hoa()){const gpa=fpa.map(a=>a instanceof Uoa?a.data_:a);return new Uoa(Goa.apply(null,gpa))}{const hpa=fpa.map(a=>foa(a)?Loa(Hoa.RAW,a).data:a.data_);let ipa=0;hpa.forEach(a=>{ipa+=a.byteLength});const jpa=new Uint8Array(ipa);let kpa=0;return hpa.forEach(a=>{for(let b=0;b<a.length;b++)jpa[kpa++]=a[b]}),new Uoa(jpa,!0)}}uploadData(){return this.data_}}function lpa(a){var b;let c;try{c=JSON.parse(a)}catch(d){return null}return"object"!=typeof(b=c)||Array.isArray(b)?null:c}function mpa(a){const b=a.lastIndexOf("/",a.length-2);return -1===b?a:a.slice(b+1)}class npa{constructor(opa,ppa,qpa,rpa){this.server=opa,this.local=ppa||opa,this.writable=!!qpa,this.xform=rpa||function(a,b){return b}}}let spa=null;function tpa(){if(spa)return spa;const a=[];a.push(new npa("bucket")),a.push(new npa("generation")),a.push(new npa("metageneration")),a.push(new npa("name","fullPath",!0));const b=new npa("name");b.xform=function(a,b){var c;return!foa(c=b)||c.length<2?c:mpa(c)},a.push(b);const c=new npa("size");return c.xform=function(a,b){return void 0!==b?Number(b):b},a.push(c),a.push(new npa("timeCreated")),a.push(new npa("updated")),a.push(new npa("md5Hash",null,!0)),a.push(new npa("cacheControl",null,!0)),a.push(new npa("contentDisposition",null,!0)),a.push(new npa("contentEncoding",null,!0)),a.push(new npa("contentLanguage",null,!0)),a.push(new npa("contentType",null,!0)),a.push(new npa("metadata","customMetadata",!0)),spa=a}function upa(a,b,c){const d=lpa(b);return null===d?null:(function(a,b,c){var d,e;const f={};f.type="file";const g=c.length;for(let h=0;h<g;h++){const i=c[h];f[i.local]=i.xform(f,b[i.server])}return d=f,e=a,Object.defineProperty(d,"ref",{get:function(){const a=d.bucket,b=d.fullPath,c=new Fna(a,b);return e._makeStorageReference(c)}}),f})(a,d,c)}function vpa(a,b){const c={},d=b.length;for(let e=0;e<d;e++){const f=b[e];f.writable&&(c[f.server]=a[f.local])}return JSON.stringify(c)}const wpa="prefixes",xpa="items";class ypa{constructor(zpa,Apa,Bpa,Cpa){this.url=zpa,this.method=Apa,this.handler=Bpa,this.timeout=Cpa,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Dpa(a){if(!a)throw xna()}function Epa(a,b){return function(c,d){const e=upa(a,d,b);return Dpa(null!==e),e}}function Fpa(a){return function(b,c){var d,e;let f;return(f=401===b.getStatus()?b.getErrorText().includes("Firebase App Check token is invalid")?new rna("unauthorized-app","This app does not have permission to access Firebase Storage on this project."):new rna("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again."):402===b.getStatus()?(d=a.bucket,new rna("quota-exceeded","Quota for bucket '"+d+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===b.getStatus()?(e=a.path,new rna("unauthorized","User does not have permission to access '"+e+"'.")):c).serverResponse=c.serverResponse,f}}function Gpa(a){const b=Fpa(a);return function(c,d){let e=b(c,d);if(404===c.getStatus()){var f;e=(f=a.path,new rna("object-not-found","Object '"+f+"' does not exist."))}return e.serverResponse=d.serverResponse,e}}function Hpa(a,b,c){const d=b.fullServerUrl(),e=joa(d,a.host,a._protocol),f=a.maxOperationRetryTime,g=new ypa(e,"GET",Epa(a,c),f);return g.errorHandler=Gpa(b),g}function Ipa(a,b,c){const d=Object.assign({},c);if(d.fullPath=a.path,d.size=b.size(),!d.contentType){var e,f;d.contentType=(e=null,f=b,e&&e.contentType||f&&f.type()||"application/octet-stream")}return d}class Jpa{constructor(Kpa,Lpa,Mpa,Npa){this.current=Kpa,this.total=Lpa,this.finalized=!!Mpa,this.metadata=Npa||null}}function Opa(a,b){let c=null;try{c=a.getResponseHeader("X-Goog-Upload-Status")}catch(d){Dpa(!1)}return Dpa(!!c&& -1!==(b||["active"]).indexOf(c)),c}const Ppa={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Qpa(a){switch(a){case"running":case"pausing":case"canceling":return Ppa.RUNNING;case"paused":return Ppa.PAUSED;case"success":return Ppa.SUCCESS;case"canceled":return Ppa.CANCELED;case"error":return Ppa.ERROR;default:return Ppa.ERROR}}class Rpa{constructor(Spa,Tpa,Upa){if("function"==typeof Spa||null!=Tpa||null!=Upa)this.next=Spa,this.error=null!=Tpa?Tpa:void 0,this.complete=null!=Upa?Upa:void 0;else{const Vpa=Spa;this.next=Vpa.next,this.error=Vpa.error,this.complete=Vpa.complete}}}function Wpa(a){return(...b)=>{Promise.resolve().then(()=>a(...b))}}class Xpa{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest(),this.initXhr(),this.errorCode_=m.NO_ERROR,this.sendPromise_=new Promise(a=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=m.ABORT,a()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=m.NETWORK_ERROR,a()}),this.xhr_.addEventListener("load",()=>{a()})})}send(Ypa,Zpa,$pa,_pa){if(this.sent_)throw Ena("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(Zpa,Ypa,!0),void 0!==_pa)for(const aqa in _pa)_pa.hasOwnProperty(aqa)&&this.xhr_.setRequestHeader(aqa,_pa[aqa].toString());return void 0!==$pa?this.xhr_.send($pa):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Ena("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Ena("cannot .getStatus() before sending");try{return this.xhr_.status}catch(bqa){return -1}}getResponse(){if(!this.sent_)throw Ena("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Ena("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(cqa){return this.xhr_.getResponseHeader(cqa)}addUploadProgressListener(dqa){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",dqa)}removeUploadProgressListener(eqa){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",eqa)}}class fqa extends Xpa{initXhr(){this.xhr_.responseType="text"}}function gqa(){return new fqa()}class hqa{constructor(iqa,jqa,kqa=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=iqa,this._blob=jqa,this._metadata=kqa,this._mappings=tpa(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=a=>{this._request=void 0,this._chunkMultiplier=1,a._codeEquals("canceled")?(this._needToFetchStatus=!0,this.completeTransitions_()):(this._error=a,this._transition("error"))},this._metadataErrorHandler=a=>{this._request=void 0,a._codeEquals("canceled")?this.completeTransitions_():(this._error=a,this._transition("error"))},this._promise=new Promise((a,b)=>{this._resolve=a,this._reject=b,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const lqa=this._transferred;return a=>this._updateProgress(lqa+a)}_shouldDoResumable(mqa){return mqa.size()>262144}_start(){"running"===this._state&& void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())}_resolveToken(nqa){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([a,b])=>{switch(this._state){case"running":nqa(a,b);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((a,b)=>{const c=function(a,b,c,d,e){const f=b.bucketOnlyServerUrl(),g=Ipa(b,d,e),h={name:g.fullPath},i=joa(f,a.host,a._protocol),j={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${d.size()}`,"X-Goog-Upload-Header-Content-Type":g.contentType,"Content-Type":"application/json; charset=utf-8"},k=vpa(g,c),l=a.maxUploadRetryTime,m=new ypa(i,"POST",function(a){Opa(a);let b;try{b=a.getResponseHeader("X-Goog-Upload-URL")}catch(c){Dpa(!1)}return Dpa(foa(b)),b},l);return m.urlParams=h,m.headers=j,m.body=k,m.errorHandler=Fpa(b),m}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),d=this._ref.storage._makeRequest(c,gqa,a,b);this._request=d,d.getPromise().then(a=>{this._request=void 0,this._uploadUrl=a,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const oqa=this._uploadUrl;this._resolveToken((a,b)=>{const c=function(a,b,c,d){const e=a.maxUploadRetryTime,f=new ypa(c,"POST",function(a){const b=Opa(a,["active","final"]);let c=null;try{c=a.getResponseHeader("X-Goog-Upload-Size-Received")}catch(e){Dpa(!1)}c||Dpa(!1);const f=Number(c);return Dpa(!isNaN(f)),new Jpa(f,d.size(),"final"===b)},e);return f.headers={"X-Goog-Upload-Command":"query"},f.errorHandler=Fpa(b),f}(this._ref.storage,this._ref._location,oqa,this._blob),d=this._ref.storage._makeRequest(c,gqa,a,b);this._request=d,d.getPromise().then(a=>{a=a,this._request=void 0,this._updateProgress(a.current),this._needToFetchStatus=!1,a.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const pqa=262144*this._chunkMultiplier,qqa=new Jpa(this._transferred,this._blob.size()),rqa=this._uploadUrl;this._resolveToken((a,b)=>{let c;try{c=(function(a,b,c,d,e,f,g,h){const i=new Jpa(0,0);if(g?(i.current=g.current,i.total=g.total):(i.current=0,i.total=d.size()),d.size()!==i.total)throw new rna("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.");const j=i.total-i.current;let k=j;e>0&&(k=Math.min(k,e));const l=i.current,m={"X-Goog-Upload-Command":k===j?"upload, finalize":"upload","X-Goog-Upload-Offset":`${i.current}`},n=d.slice(l,l+k);if(null===n)throw zna();const o=b.maxUploadRetryTime,p=new ypa(c,"POST",function(a,c){const e=Opa(a,["active","final"]),g=i.current+k,h=d.size();let j;return j="final"===e?Epa(b,f)(a,c):null,new Jpa(g,h,"final"===e,j)},o);return p.headers=m,p.body=n.uploadData(),p.progressCallback=h||null,p.errorHandler=Fpa(a),p})(this._ref._location,this._ref.storage,rqa,this._blob,pqa,this._mappings,qqa,this._makeProgressCallback())}catch(d){this._error=d,this._transition("error");return}const e=this._ref.storage._makeRequest(c,gqa,a,b);this._request=e,e.getPromise().then(a=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(a.current),a.finalized?(this._metadata=a.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){const sqa=262144*this._chunkMultiplier;sqa<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((a,b)=>{const c=Hpa(this._ref.storage,this._ref._location,this._mappings),d=this._ref.storage._makeRequest(c,gqa,a,b);this._request=d,d.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((a,b)=>{const c=function(a,b,c,d,e){const f=b.bucketOnlyServerUrl(),g={"X-Goog-Upload-Protocol":"multipart"},h=function(){let a="";for(let b=0;b<2;b++)a+=Math.random().toString().slice(2);return a}();g["Content-Type"]="multipart/related; boundary="+h;const i=Ipa(b,d,e),j=vpa(i,c),k="--"+h+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+j+"\r\n--"+h+"\r\nContent-Type: "+i.contentType+"\r\n\r\n",l=Uoa.getBlob(k,d,"\r\n--"+h+"--");if(null===l)throw zna();const m={name:i.fullPath},n=joa(f,a.host,a._protocol),o=a.maxUploadRetryTime,p=new ypa(n,"POST",Epa(a,c),o);return p.urlParams=m,p.headers=g,p.body=l.uploadData(),p.errorHandler=Fpa(b),p}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),d=this._ref.storage._makeRequest(c,gqa,a,b);this._request=d,d.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(tqa){const uqa=this._transferred;this._transferred=tqa,this._transferred!==uqa&&this._notifyObservers()}_transition(vqa){if(this._state!==vqa)switch(vqa){case"canceling":this._state=vqa,void 0!==this._request&&this._request.cancel();break;case"pausing":this._state=vqa,void 0!==this._request&&this._request.cancel();break;case"running":const wqa="paused"===this._state;this._state=vqa,wqa&&(this._notifyObservers(),this._start());break;case"paused":this._state=vqa,this._notifyObservers();break;case"canceled":this._error=yna(),this._state=vqa,this._notifyObservers();break;case"error":this._state=vqa,this._notifyObservers();break;case"success":this._state=vqa,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const xqa=Qpa(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:xqa,metadata:this._metadata,task:this,ref:this._ref}}on(yqa,zqa,Aqa,Bqa){const Cqa=new Rpa(zqa||void 0,Aqa||void 0,Bqa||void 0);return this._addObserver(Cqa),()=>{this._removeObserver(Cqa)}}then(Dqa,Eqa){return this._promise.then(Dqa,Eqa)}catch(Fqa){return this.then(null,Fqa)}_addObserver(Gqa){this._observers.push(Gqa),this._notifyObserver(Gqa)}_removeObserver(Hqa){const Iqa=this._observers.indexOf(Hqa);-1!==Iqa&&this._observers.splice(Iqa,1)}_notifyObservers(){this._finishPromise();const Jqa=this._observers.slice();Jqa.forEach(a=>{this._notifyObserver(a)})}_finishPromise(){if(void 0!==this._resolve){let Kqa=!0;switch(Qpa(this._state)){case Ppa.SUCCESS:Wpa(this._resolve.bind(null,this.snapshot))();break;case Ppa.CANCELED:case Ppa.ERROR:const Lqa=this._reject;Wpa(Lqa.bind(null,this._error))();break;default:Kqa=!1;break}Kqa&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(Mqa){const Nqa=Qpa(this._state);switch(Nqa){case Ppa.RUNNING:case Ppa.PAUSED:Mqa.next&&Wpa(Mqa.next.bind(Mqa,this.snapshot))();break;case Ppa.SUCCESS:Mqa.complete&&Wpa(Mqa.complete.bind(Mqa))();break;case Ppa.CANCELED:case Ppa.ERROR:Mqa.error&&Wpa(Mqa.error.bind(Mqa,this._error))();break;default:Mqa.error&&Wpa(Mqa.error.bind(Mqa,this._error))()}}resume(){const Oqa="paused"===this._state||"pausing"===this._state;return Oqa&&this._transition("running"),Oqa}pause(){const Pqa="running"===this._state;return Pqa&&this._transition("pausing"),Pqa}cancel(){const Qqa="running"===this._state||"pausing"===this._state;return Qqa&&this._transition("canceling"),Qqa}}class Rqa{constructor(Sqa,Tqa){this._service=Sqa,Tqa instanceof Fna?this._location=Tqa:this._location=Fna.makeFromUrl(Tqa,Sqa.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(Uqa,Vqa){return new Rqa(Uqa,Vqa)}get root(){const Wqa=new Fna(this._location.bucket,"");return this._newRef(this._service,Wqa)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return mpa(this._location.path)}get storage(){return this._service}get parent(){const Xqa=function(a){if(0===a.length)return null;const b=a.lastIndexOf("/");if(-1===b)return"";const c=a.slice(0,b);return c}(this._location.path);if(null===Xqa)return null;const Yqa=new Fna(this._location.bucket,Xqa);return new Rqa(this._service,Yqa)}_throwIfRoot(Zqa){if(""===this._location.path)throw Cna(Zqa)}}async function $qa(a,b,c){const d=await _qa(a,{pageToken:c});b.prefixes.push(...d.prefixes),b.items.push(...d.items),null!=d.nextPageToken&&await $qa(a,b,d.nextPageToken)}function _qa(a,b){null!=b&&"number"==typeof b.maxResults&&ioa("options.maxResults",1,1000,b.maxResults);const c=b||{},d=function(a,b,c,d,e){var f,g;const h={};b.isRoot?h.prefix="":h.prefix=b.path+"/",c&&c.length>0&&(h.delimiter=c),d&&(h.pageToken=d),e&&(h.maxResults=e);const i=b.bucketOnlyServerUrl(),j=joa(i,a.host,a._protocol),k=a.maxOperationRetryTime,l=new ypa(j,"GET",(f=a,g=b.bucket,function(a,b){const c=function(a,b,c){const d=lpa(c);return null===d?null:(function(a,b,c){const d={prefixes:[],items:[],nextPageToken:c.nextPageToken};if(c[wpa])for(const e of c[wpa]){const f=e.replace(/\/$/,""),g=a._makeStorageReference(new Fna(b,f));d.prefixes.push(g)}if(c[xpa])for(const h of c[xpa]){const i=a._makeStorageReference(new Fna(b,h.name));d.items.push(i)}return d})(a,b,d)}(f,g,b);return Dpa(null!==c),c}),k);return l.urlParams=h,l.errorHandler=Fpa(b),l}(a.storage,a._location,"/",c.pageToken,c.maxResults);return a.storage.makeRequestWithTokens(d,gqa)}function ara(a,b){const c=function(a,b){const c=b.split("/").filter(a=>a.length>0).join("/");return 0===a.length?c:a+"/"+c}(a._location.path,b),d=new Fna(a._location.bucket,c);return new Rqa(a.storage,d)}function bra(a,b){if(a instanceof dra){const c=a;if(null==c._bucket)throw new rna("no-default-bucket","No default bucket found. Did you set the '"+qna+"' property when initializing the app?");const d=new Rqa(c,c._bucket);return null!=b?bra(d,b):d}return void 0!==b?ara(a,b):a}function cra(a,b){const c=null==b?void 0:b[qna];return null==c?null:Fna.makeFromBucketSpec(c,a)}class dra{constructor(era,fra,gra,hra,ira){this.app=era,this._authProvider=fra,this._appCheckProvider=gra,this._url=hra,this._firebaseVersion=ira,this._bucket=null,this._host=pna,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=120e3,this._maxUploadRetryTime=60e4,this._requests=new Set(),null!=hra?this._bucket=Fna.makeFromBucketSpec(hra,this._host):this._bucket=cra(this._host,this.app.options)}get host(){return this._host}set host(jra){this._host=jra,null!=this._url?this._bucket=Fna.makeFromBucketSpec(this._url,jra):this._bucket=cra(jra,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(kra){ioa("time",0,Number.POSITIVE_INFINITY,kra),this._maxUploadRetryTime=kra}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(lra){ioa("time",0,Number.POSITIVE_INFINITY,lra),this._maxOperationRetryTime=lra}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const mra=this._authProvider.getImmediate({optional:!0});if(mra){const nra=await mra.getToken();if(null!==nra)return nra.accessToken}return null}async _getAppCheckToken(){const ora=this._appCheckProvider.getImmediate({optional:!0});if(ora){const pra=await ora.getToken();return pra.token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(a=>a.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(qra){return new Rqa(this,qra)}_makeRequest(rra,sra,tra,ura){if(this._deleted)return new coa(Bna());{const vra=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n;const o=koa(a.urlParams),p=a.url+o,q=Object.assign({},a.headers);return g=q,(h=b)&&(g["X-Firebase-GMPID"]=h),i=q,null!==(j=c)&&j.length>0&&(i.Authorization="Firebase "+j),k=q,l=f,k["X-Firebase-Storage-Version"]="webjs/"+(null!=l?l:"AppManager"),m=q,null!==(n=d)&&(m["X-Firebase-AppCheck"]=n),new loa(p,a.method,q,a.body,a.successCodes,a.additionalRetryCodes,a.handler,a.errorHandler,a.timeout,a.progressCallback,e)}(rra,this._appId,tra,ura,sra,this._firebaseVersion);return this._requests.add(vra),vra.getPromise().then(()=>this._requests.delete(vra),()=>this._requests.delete(vra)),vra}}async makeRequestWithTokens(wra,xra){const[yra,zra]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(wra,xra,yra,zra).getPromise()}}const Ara="@firebase/storage",Bra="0.9.1";function Cra(a,b){return(function(a,b){var c,d,e;if(!(b&&(c=b,/^[A-Za-z]+:\/\//.test(c))))return bra(a,b);if(a instanceof dra)return d=a,e=b,new Rqa(d,e);throw Ana("To use ref(service, url), the first argument must be a Storage instance.")})(a=xa(a),b)}kc(new ya("storage",function(a,{instanceIdentifier:b}){const c=a.getProvider("app").getImmediate(),d=a.getProvider("auth-internal"),e=a.getProvider("app-check-internal");return new dra(c,d,e,b,vc)},"PUBLIC").setMultipleInstances(!0)),Ac(Ara,Bra,""),Ac(Ara,Bra,"esm2017");class Dra{constructor(Era,Fra,Gra){this._delegate=Era,this.task=Fra,this.ref=Gra}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class Hra{constructor(Ira,Jra){this._delegate=Ira,this._ref=Jra,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new Dra(this._delegate.snapshot,this,this._ref)}then(Kra,Lra){return this._delegate.then(a=>{if(Kra)return Kra(new Dra(a,this,this._ref))},Lra)}on(Mra,Nra,Ora,Pra){let Qra;return Nra&&(Qra="function"==typeof Nra?a=>Nra(new Dra(a,this,this._ref)):{next:Nra.next?a=>Nra.next(new Dra(a,this,this._ref)):void 0,complete:Nra.complete||void 0,error:Nra.error||void 0}),this._delegate.on(Mra,Qra,Ora||void 0,Pra||void 0)}}class Rra{constructor(Sra,Tra){this._delegate=Sra,this._service=Tra}get prefixes(){return this._delegate.prefixes.map(a=>new Ura(a,this._service))}get items(){return this._delegate.items.map(a=>new Ura(a,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class Ura{constructor(Vra,Wra){this._delegate=Vra,this.storage=Wra}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(Xra){const Yra=ara(this._delegate,Xra);return new Ura(Yra,this.storage)}get root(){return new Ura(this._delegate.root,this.storage)}get parent(){const Zra=this._delegate.parent;return null==Zra?null:new Ura(Zra,this.storage)}put($ra,_ra){var asa,bsa,csa,dsa,esa,fsa;return this._throwIfRoot("put"),new Hra((asa=this._delegate,bsa=$ra,csa=_ra,dsa=asa=xa(asa),esa=bsa,fsa=csa,dsa._throwIfRoot("uploadBytesResumable"),new hqa(dsa,new Uoa(esa),fsa)),this)}putString(gsa,hsa=Hoa.RAW,isa){this._throwIfRoot("putString");const jsa=Loa(hsa,gsa),ksa=Object.assign({},isa);return null==ksa.contentType&&null!=jsa.contentType&&(ksa.contentType=jsa.contentType),new Hra(new hqa(this._delegate,new Uoa(jsa.data,!0),ksa),this)}listAll(){return(function(a){const b={prefixes:[],items:[]};return $qa(a,b).then(()=>b)})(xa(this._delegate)).then(a=>new Rra(a,this.storage))}list(lsa){var msa,nsa;return(msa=this._delegate,nsa=lsa||void 0,_qa(msa=xa(msa),nsa)).then(a=>new Rra(a,this.storage))}getMetadata(){return(function(a){a._throwIfRoot("getMetadata");const b=Hpa(a.storage,a._location,tpa());return a.storage.makeRequestWithTokens(b,gqa)})(xa(this._delegate))}updateMetadata(osa){var psa,qsa;return psa=this._delegate,qsa=osa,(function(a,b){a._throwIfRoot("updateMetadata");const c=function(a,b,c,d){const e=b.fullServerUrl(),f=joa(e,a.host,a._protocol),g=vpa(c,d),h=a.maxOperationRetryTime,i=new ypa(f,"PATCH",Epa(a,d),h);return i.headers={"Content-Type":"application/json; charset=utf-8"},i.body=g,i.errorHandler=Gpa(b),i}(a.storage,a._location,b,tpa());return a.storage.makeRequestWithTokens(c,gqa)})(psa=xa(psa),qsa)}getDownloadURL(){return(function(a){a._throwIfRoot("getDownloadURL");const b=function(a,b,c){var d,e;const f=b.fullServerUrl(),g=joa(f,a.host,a._protocol),h=a.maxOperationRetryTime,i=new ypa(g,"GET",(d=a,e=c,function(a,b){const c=upa(d,b,e);return Dpa(null!==c),(function(a,b,c,d){const e=lpa(b);if(null===e)return null;if(!foa(e.downloadTokens))return null;const f=e.downloadTokens;if(0===f.length)return null;const g=encodeURIComponent,h=f.split(","),i=h.map(b=>{const e=a.bucket,f=a.fullPath,h="/b/"+g(e)+"/o/"+g(f),i=joa(h,c,d),j=koa({alt:"media",token:b});return i+j});return i[0]})(c,b,d.host,d._protocol)}),h);return i.errorHandler=Gpa(b),i}(a.storage,a._location,tpa());return a.storage.makeRequestWithTokens(b,gqa).then(a=>{if(null===a)throw new rna("no-download-url","The given file does not have any download URLs.");return a})})(xa(this._delegate))}delete(){return this._throwIfRoot("delete"),(function(a){a._throwIfRoot("deleteObject");const b=function(a,b){const c=b.fullServerUrl(),d=joa(c,a.host,a._protocol),e=a.maxOperationRetryTime,f=new ypa(d,"DELETE",function(a,b){},e);return f.successCodes=[200,204],f.errorHandler=Gpa(b),f}(a.storage,a._location);return a.storage.makeRequestWithTokens(b,gqa)})(xa(this._delegate))}_throwIfRoot(rsa){if(""===this._delegate._location.path)throw Cna(rsa)}}class ssa{constructor(tsa,usa){this.app=tsa,this._delegate=usa}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(vsa){if(Dsa(vsa))throw Ana("ref() expected a child path but got a URL, use refFromURL instead.");return new Ura(Cra(this._delegate,vsa),this)}refFromURL(wsa){if(!Dsa(wsa))throw Ana("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Fna.makeFromUrl(wsa,this._delegate.host)}catch(xsa){throw Ana("refFromUrl() expected a valid full URL but got an invalid one.")}return new Ura(Cra(this._delegate,wsa),this)}setMaxUploadRetryTime(ysa){this._delegate.maxUploadRetryTime=ysa}setMaxOperationRetryTime(zsa){this._delegate.maxOperationRetryTime=zsa}useEmulator(Asa,Bsa,Csa={}){!function(a,b,c,d={}){!function(a,b,c,d={}){a.host=`${b}:${c}`,a._protocol="http";const{mockUserToken:e}=d;e&&(a._overrideAuthToken="string"==typeof e?e:A(e,a.app.options.projectId))}(a,b,c,d)}(this._delegate,Asa,Bsa,Csa)}}function Dsa(a){return/^[A-Za-z]+:\/\//.test(a)}(Esa=Uc).INTERNAL.registerComponent(new ya("storage-compat",function(a,{instanceIdentifier:b}){const c=a.getProvider("app-compat").getImmediate(),d=a.getProvider("storage").getImmediate({identifier:b}),e=new ssa(c,d);return e},"PUBLIC").setServiceProps({TaskState:Ppa,TaskEvent:{STATE_CHANGED:"state_changed"},StringFormat:Hoa,Storage:ssa,Reference:Ura}).setMultipleInstances(!0)),Esa.registerVersion("@firebase/storage-compat","0.1.9");var Esa,Fsa=Uc.initializeApp({apiKey:"AIzaSyCPGqmziPBIQahzwiDg9w95w0qzKDlpH3k",authDomain:"npotw-production.firebaseapp.com",databaseURL:"https://npotw-production-default-rtdb.europe-west1.firebasedatabase.app",projectId:"npotw-production",storageBucket:"npotw-production.appspot.com",messagingSenderId:"938102620349",appId:"1:938102620349:web:63c556beb2e8f3486cb7d4",measurementId:"G-NS4D0MNEQV"}).auth(),Gsa=p.createContext();function Hsa(){return(0,p.useContext)(Gsa)}function Isa(a){var b=a.children,c=(0,p.useState)(),d=c[0],e=c[1],f=(0,p.useState)(!0),g=f[0],h=f[1];return(0,p.useEffect)(function(){return Fsa.onAuthStateChanged(function(a){e(a),h(!1)})},[]),(0,o.jsx)(Gsa.Provider,{value:{currentUser:d,login:function(a,b){return Fsa.signInWithEmailAndPassword(a,b)},signup:function(a,b){return Fsa.createUserWithEmailAndPassword(a,b)},logout:function(){return Fsa.signOut()},resetPassword:function(a){return Fsa.sendPasswordResetEmail(a)}},children:!g&&b})}},8510:function(a,b,c){"use strict";c.r(b);var d=c(5893),e=c(906);c.n(e);var f=c(5819);function g(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}b.default=function(a){var b=a.Component,c=a.pageProps;return(0,d.jsx)(f.Z,{children:(0,d.jsx)(b,function(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{},d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){g(a,b,c[b])})}return a}({},c))})}},906:function(){},7663:function(a){!function(){var b={162:function(a){var b,c,d,e=a.exports={};function f(){throw new Error("setTimeout has not been defined")}function g(){throw new Error("clearTimeout has not been defined")}function h(a){if(b===setTimeout)return setTimeout(a,0);if((b===f||!b)&&setTimeout)return b=setTimeout,setTimeout(a,0);try{return b(a,0)}catch(c){try{return b.call(null,a,0)}catch(d){return b.call(this,a,0)}}}!function(){try{b="function"==typeof setTimeout?setTimeout:f}catch(a){b=f}try{c="function"==typeof clearTimeout?clearTimeout:g}catch(d){c=g}}();var i=[],j=!1,k=-1;function l(){j&&d&&(j=!1,d.length?i=d.concat(i):k=-1,i.length&&m())}function m(){if(!j){var a=h(l);j=!0;for(var b=i.length;b;){for(d=i,i=[];++k<b;)d&&d[k].run();k=-1,b=i.length}d=null,j=!1,(function(a){if(c===clearTimeout)return clearTimeout(a);if((c===g||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(a);try{c(a)}catch(b){try{return c.call(null,a)}catch(d){return c.call(this,a)}}})(a)}}function n(a,b){this.fun=a,this.array=b}function o(){}e.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];i.push(new n(a,b)),1!==i.length||j||h(m)},n.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=o,e.addListener=o,e.once=o,e.off=o,e.removeListener=o,e.removeAllListeners=o,e.emit=o,e.prependListener=o,e.prependOnceListener=o,e.listeners=function(a){return[]},e.binding=function(a){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(a){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}}},c={};function d(a){var e=c[a];if(void 0!==e)return e.exports;var f=c[a]={exports:{}},g=!0;try{b[a](f,f.exports,d),g=!1}finally{g&&delete c[a]}return f.exports}d.ab="//";var e=d(162);a.exports=e}()}},function(a){var b=function(b){return a(a.s=b)};a.O(0,[774,179],function(){return b(1780),b(387)}),_N_E=a.O()}])